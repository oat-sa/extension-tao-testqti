define("taoQtiTest/controller/routes",[],function(){"use strict";return{Creator:{css:"creator",actions:{index:"controller/creator/creator"}}}}),define("tpl!taoQtiTest/controller/creator/templates/testpart",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div id="',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="testpart clearfix">\n\n   <h1><span data-bind="identifier">',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n        <div class="actions"> \n            <div class="tlb">\n                <div class="tlb-top">\n                    <span class="tlb-box">\n                        <span class="tlb-bar">\n                            <span class="tlb-start"></span>\n                            <span class="tlb-group">\n                                <a href="#" class="tlb-button-off property-toggler" title="Test Part Properties"><span class="icon-settings"></span></a>\n                                <span class="tlb-separator"></span>\n                                <a href="#" class="tlb-button-off move-up" title="Move Up"><span class="icon-up"></span></a>\n                                <a href="#" class="tlb-button-off move-down" title="Move Down"><span class="icon-down"></span></a>\n                                <span class="tlb-separator"></span> \n                                <a href="#" class="tlb-button-off" title="Remove Test Part" data-delete="#',
(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"><span class="icon-bin"></span></a>\n                            </span>\n                            <span class="tlb-end"></span>\n                        </span>  \n                        <!--<span class="tlb-bar">-->\n                            <!--<span class="tlb-start"></span>-->\n                            <!--<span class="tlb-text-button-box">-->\n                                <!--<a class="tlb-text-button-off section-adder">-->\n                                    <!--<span class="icon-add"></span>-->\n                                    <!--<span class="tlb-text">New Section</span>-->\n                                <!--</a>-->\n                            <!--</span>-->\n                            <!--<span class="tlb-end"></span>-->\n                        <!--</span>-->\n                    </span>   \n                </div>\n            </div>\n        </div>\n        <a href="#" class="toggler opened" data-toggle="#testpart-content-',
(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"></a>\n    </h1>\n    <div id="testpart-content-',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="testpart-content">\n        \n       <!-- assessmentTest/testPart/assessmentSections -->\n       <div class="sections" data-bind-each="assessmentSections" data-bind-tmpl="section" data-bind-filter="isSection"></div>\n\n        <button class="btn-info small section-adder">\n            <span class="icon-add"></span>New section\n        </button>\n    </div>\n</div>\n';
})}),define("tpl!taoQtiTest/controller/creator/templates/section",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div id="',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="section">\n\n<!-- assessmentTest/testPart/assessmentSection/title -->\n    <h2><span data-bind="title">',
(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n        <div class="actions">\n            <div class="tlb">\n                <div class="tlb-top">\n                    <span class="tlb-box">\n                        <span class="tlb-bar">\n                            <span class="tlb-start"></span>\n                            <span class="tlb-group">\n                                <a href="#" class="tlb-button-off rub-toggler" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Manage Rubric Blocks",options):helperMissing.call(depth0,"__","Manage Rubric Blocks",options)))+'" data-toggle="#rublocks-',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" ><span class="icon-rubric"></span></a>\n                                <span class="tlb-separator"></span>\n                                <a href="#" class="tlb-button-off property-toggler" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={
hash:{},data:data},helper?helper.call(depth0,"Section Properties",options):helperMissing.call(depth0,"__","Section Properties",options)))+'"><span class="icon-settings"></span></a>\n                                <span class="tlb-separator"></span>\n                                <a href="#" class="tlb-button-off move-up disabled" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Move Up",options):helperMissing.call(depth0,"__","Move Up",options)))+'"><span class="icon-up"></span></a>\n                                <a href="#" class="tlb-button-off move-down disabled" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Move Down",options):helperMissing.call(depth0,"__","Move Down",options)))+'"><span class="icon-down"></span></a>\n                                <span class="tlb-separator"></span>\n                                <a href="#" class="tlb-button-off disabled" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Remove Section",options):helperMissing.call(depth0,"__","Remove Section",options)))+'" data-delete=":parent .section"><span class="icon-bin"></span></a>\n                            </span>\n                            <span class="tlb-end"></span>\n                        </span>\n                    </span>\n                </div>\n            </div>\n        </div>\n    </h2>\n\n    <div id="rublocks-',
(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="rublocks clearfix toggled">\n        <h3>\n            <span class="title">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Rubric Blocks",options):helperMissing.call(depth0,"__","Rubric Blocks",options)))+'</span>\n        </h3>\n        <ol class="rubricblocks decimal" data-bind-each="rubricBlocks" data-bind-tmpl="rubricblock"></ol>\n        <button class="btn-info small rublock-adder">\n            <span class="icon-add"></span>'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"New Rubric Block",options):helperMissing.call(depth0,"__","New Rubric Block",options)))+'\n        </button>\n    </div>\n    <div class="itemrefs-wrapper">\n        <h3>\n            <span class="title">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Items",options):helperMissing.call(depth0,"__","Items",options)))+'</span>\n        </h3>\n        <ol class="itemrefs decimal clearfix" data-bind-each="sectionParts" data-bind-tmpl="itemref" data-bind-filter="isItemRef" data-msg="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={
hash:{},data:data},helper?helper.call(depth0,"Add selected item(s) here.",options):helperMissing.call(depth0,"__","Add selected item(s) here.",options)))+'"></ol>\n        <div class="itemref-placeholder">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Add selected item(s) here.",options):helperMissing.call(depth0,"__","Add selected item(s) here.",options)))+"\n        </div>\n    </div>\n</div>\n"})}),define("tpl!taoQtiTest/controller/creator/templates/rubricblock",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],
helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var helper,options,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression;return buffer+='<li class="rubricblock">\n    <div class="actions">\n       <div class="tlb">\n            <div class="tlb-top">\n                <span class="tlb-box">\n                    <span class="tlb-bar">\n                        <span class="tlb-start"></span>\n                        <span class="tlb-group">\n                            <!--<a href="#" class="tlb-button-off property-toggler" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Rubric Block Properties",options):helperMissing.call(depth0,"__","Rubric Block Properties",options)))+'"><span class="icon-settings"></span></a>-->\n                            <!--<span class="tlb-separator"></span> -->\n                            <a href="#" class="tlb-button-off" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Remove Rubric Block",options):helperMissing.call(depth0,"__","Remove Rubric Block",options)))+'" data-delete=":parent .rubricblock"><span class="icon-bin"></span></a>\n                        </span>\n                        <span class="tlb-end"></span>\n                    </span>\n                </span>\n            </div>\n        </div>\n    </div>\n    <div class="rubricblock-content" contenteditable></div>\n    <div class="rubricblock-binding" data-bind="content" data-bind-html="true" data-bind-encoder="dom2qti"></div>\n</li>\n'})}),define("tpl!taoQtiTest/controller/creator/templates/itemref",["handlebars"],function(hb){
return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+="<li id='",(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"' data-uri='",(helper=helpers.href)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.href,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"' class='itemref'>\n    <span class='title truncate'>",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n    <div class="actions"> \n        <div class="tlb">\n            <div class="tlb-top">\n                <span class="tlb-box">\n                    <span class="tlb-bar">\n                        <span class="tlb-start"></span>\n                        <span class="tlb-group">\n                            <a href="#" class="tlb-button-off property-toggler" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Item Reference Properties",options):helperMissing.call(depth0,"__","Item Reference Properties",options)))+'"><span class="icon-settings"></span></a>\n                            <span class="tlb-separator"></span>\n                            <a href="#" class="tlb-button-off move-up" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Move Up",options):helperMissing.call(depth0,"__","Move Up",options)))+'"><span class="icon-up"></span></a>\n                            <a href="#" class="tlb-button-off move-down" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Move Down",options):helperMissing.call(depth0,"__","Move Down",options)))+'"><span class="icon-down"></span></a>\n                            <span class="tlb-separator"></span> \n                            <a href="#" class="tlb-button-off" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Remove Item Reference",options):helperMissing.call(depth0,"__","Remove Item Reference",options)))+'" data-delete=":parent .itemref"><span class="icon-bin"></span></a>\n                        </span>\n                        <span class="tlb-end"></span>\n                    </span>  \n                </span>   \n            </div>\n        </div>\n    </div>\n</li>\n';
})}),define("tpl!taoQtiTest/controller/creator/templates/item",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+="\n     <li data-uri='",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"' class='truncate'>\n        ",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data
}):helper),buffer+=escapeExpression(stack1)+" \n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.parent,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n     </li>\n"}function program2(depth0,data){var stack1,helper,buffer="";return buffer+="<span class='flag truncate' title=\"",(helper=helpers.parent)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.parent,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',(helper=helpers.parent)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.parent,
stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers.each.call(depth0,depth0,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})}),define("tpl!taoQtiTest/controller/creator/templates/test-props",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],
helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="test-props props clearfix">\n\n    <!-- test properties -->\n    <h3 data-bind="title"></h3>\n\n<!-- assessmentTest/identifier -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="test-identifier">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Identifier",options):helperMissing.call(depth0,"__","Identifier",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="test-identifier" data-bind="identifier" data-validate="$notEmpty; $testIdFormat; $testIdAvailable(original=',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+');" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The principle identifier of the test.",options):helperMissing.call(depth0,"__","The principle identifier of the test.",options)))+'\n            </div>\n        </div>\n    </div>\n\n<!-- assessmentTest/title -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="test-title">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Title",options):helperMissing.call(depth0,"__","Title",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="test-title" data-bind="title" data-validate="$notEmpty" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The test title.",options):helperMissing.call(depth0,"__","The test title.",options)))+'\n            </div>\n        </div>\n    </div>\n\n    <h4 class="toggler closed" data-toggle="~ .test-time-limits">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Time Limits",options):helperMissing.call(depth0,"__","Time Limits",options)))+'</h4>\n\n<!-- assessmentTest/timeLimits -->\n    <div class="test-time-limits toggled">\n\n\n\n<!-- assessmentTest/timeLimits/maxTime -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="test-max-time">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Maximum Duration",options):helperMissing.call(depth0,"__","Maximum Duration",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <input type="text" name="max-time" value="00:00:00" data-duration="HH:mm:ss" data-bind="timeLimits.maxTime" data-bind-encoder="time" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data
},helper?helper.call(depth0,"Maximum duration for the all test.",options):helperMissing.call(depth0,"__","Maximum duration for the all test.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/timeLimits/allowLateSubmission -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Late submission allowed",options):helperMissing.call(depth0,"__","Late submission allowed",options)))+'\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="test-allow-late-submission" value="true" data-bind="timeLimits.allowLateSubmission" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Whether a candidate's response that is beyond the maximum duration should still be accepted.",options):helperMissing.call(depth0,"__","Whether a candidate's response that is beyond the maximum duration should still be accepted.",options)))+"\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>\n"})}),define("tpl!taoQtiTest/controller/creator/templates/testpart-props",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;
return buffer+='<div id="testpart-props-',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="testpart-props props clearfix">\n    <h3>',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</h3>\n\n    <form autocomplete="off">\n\n<!-- assessmentTest/testPart/identifier -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="testpart-identifier">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Identifier",options):helperMissing.call(depth0,"__","Identifier",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n            </div>\n            <div class="col-6">\n                <input type="text" name="testpart-identifier" data-bind="identifier" data-validate="$notEmpty; $idFormat; $testIdAvailable(original=',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,
stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+');" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"The test part identifier.",options):helperMissing.call(depth0,"__","The test part identifier.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/navigationMode -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n               '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Navigation",options):helperMissing.call(depth0,"__","Navigation",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="radio" name="testpart-navigation-mode" value="0" checked="checked" data-bind="navigationMode" data-bind-encoder="number" />\n                    <span class="icon-radio"></span>\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Linear",options):helperMissing.call(depth0,"__","Linear",options)))+'\n                </label>\n                <label>\n                    <input type="radio" name="testpart-navigation-mode" value="1"  />\n                    <span class="icon-radio"></span>\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Non Linear",options):helperMissing.call(depth0,"__","Non Linear",options)))+'\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The navigation mode determines the general paths that the candidate may take. A linear mode restricts the candidate to attempt each item in turn. Non Linear removes this restriction.",options):helperMissing.call(depth0,"__","The navigation mode determines the general paths that the candidate may take. A linear mode restricts the candidate to attempt each item in turn. Non Linear removes this restriction.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/submissionMode -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Submission",options):helperMissing.call(depth0,"__","Submission",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="radio" name="testpart-submission-mode" value="0" checked="checked" data-bind="submissionMode" data-bind-encoder="number" />\n                    <span class="icon-radio"></span>\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Individual",options):helperMissing.call(depth0,"__","Individual",options)))+'\n                </label>\n                <label>\n                    <input type="radio" name="testpart-submission-mode" value="1"  />\n                    <span class="icon-radio"></span>\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Simultaneous",options):helperMissing.call(depth0,"__","Simultaneous",options)))+'\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The submission mode determines when the candidate's responses are submitted for response processing. A testPart in individual mode requires the candidate to submit their responses on an item-by-item basis. In simultaneous mode the candidate's responses are all submitted together at the end of the testPart.",options):helperMissing.call(depth0,"__","The submission mode determines when the candidate's responses are submitted for response processing. A testPart in individual mode requires the candidate to submit their responses on an item-by-item basis. In simultaneous mode the candidate's responses are all submitted together at the end of the testPart.",options)))+'\n                </div>\n            </div>\n        </div>\n\n        <h4 class="toggler closed" data-toggle="~ .testpart-item-session-control">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Item Session Control",options):helperMissing.call(depth0,"__","Item Session Control",options)))+'</h4>\n\n\n<!-- assessmentTest/testPart/itemSessionControl -->\n        <div class="testpart-item-session-control toggled">\n\n<!-- assessmentTest/testPart/itemSessionControl/maxAttempts -->\n            <div class="grid-row">\n                <div class="col-5">\n                    <label for="testpart-max-attempts">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Max Attempts",options):helperMissing.call(depth0,"__","Max Attempts",options)))+'</label>\n                </div>\n                <div class="col-6">\n                    <input name="testpart-max-attempts" type="text" data-increment="1" data-min="0" value="1" data-bind="itemSessionControl.maxAttempts" data-bind-encoder="number" />\n                </div>\n                <div class="col-1 help">\n                    <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                    <div class="tooltip-content">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Controls the maximum number of attempts allowed. 0 means unlimited.",options):helperMissing.call(depth0,"__","Controls the maximum number of attempts allowed. 0 means unlimited.",options)))+'\n                    </div>\n                </div>\n            </div>\n\n<!-- assessmentTest/testPart/itemSessionControl/showFeedback -->\n            <div class="grid-row pseudo-label-box">\n                <div class="col-5">\n                    <label for="testpart-show-feedback">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Show Feedback",options):helperMissing.call(depth0,"__","Show Feedback",options)))+'</label>\n                </div>\n                <div class="col-6">\n                    <label>\n                        <input type="checkbox" name="testpart-show-feedback" value="true" data-bind="itemSessionControl.showFeedback" data-bind-encoder="boolean" />\n                        <span class="icon-checkbox" />\n                    </label>\n                </div>\n                <div class="col-1 help">\n                    <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                    <div class="tooltip-content">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This constraint affects the visibility of feedback after the end of the last attempt.",options):helperMissing.call(depth0,"__","This constraint affects the visibility of feedback after the end of the last attempt.",options)))+'\n                    </div>\n                </div>\n            </div>\n\n\n\n\n\n<!-- assessmentTest/testPart/itemSessionControl/allowComment -->\n            <div class="grid-row pseudo-label-box">\n                <div class="col-5">\n                    <label for="testpart-allow-comment">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Allow Comment",options):helperMissing.call(depth0,"__","Allow Comment",options)))+'</label>\n                </div>\n                <div class="col-6">\n                    <label>\n                        <input type="checkbox" name="testpart-allow-comment" value="true" data-bind="itemSessionControl.allowComment" data-bind-encoder="boolean" />\n                        <span class="icon-checkbox" />\n                    </label>\n                </div>\n                <div class="col-1 help">\n                    <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                    <div class="tooltip-content">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.",options):helperMissing.call(depth0,"__","This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.",options)))+'\n                    </div>\n                </div>\n            </div>\n\n<!-- assessmentTest/testPart/itemSessionControl/allowSkipping -->\n            <div class="grid-row pseudo-label-box">\n                <div class="col-5">\n                    <label for="testpart-allow-skipping">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Allow Skipping",options):helperMissing.call(depth0,"__","Allow Skipping",options)))+'</label>\n                </div>\n                <div class="col-6">\n                    <label>\n                        <input type="checkbox" name="testpart-allow-skipping" value="true" checked="checked"  data-bind="itemSessionControl.allowSkipping" data-bind-encoder="boolean"   />\n                        <span class="icon-checkbox" />\n                    </label>\n                </div>\n                <div class="col-1 help">\n                    <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                    <div class="tooltip-content">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"If the candidate can skip the item, without submitting a response.",options):helperMissing.call(depth0,"__","If the candidate can skip the item, without submitting a response.",options)))+'\n                    </div>\n                </div>\n            </div>\n\n\n        </div>\n\n        <h4 class="toggler closed" data-toggle="~ .testpart-time-limits">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Time Limits",options):helperMissing.call(depth0,"__","Time Limits",options)))+'</h4>\n\n<!-- assessmentTest/testPart/timeLimits/minTime -->\n        <div class="testpart-time-limits toggled">\n\n\n\n<!-- assessmentTest/testPart/timeLimits/maxTime -->\n            <div class="grid-row">\n                <div class="col-5">\n                    <label for="testpart-max-time">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Maximum Duration",options):helperMissing.call(depth0,"__","Maximum Duration",options)))+'</label>\n                </div>\n                <div class="col-6">\n                    <input type="text" name="max-time" value="00:00:00" data-duration="HH:mm:ss" data-bind="timeLimits.maxTime" data-bind-encoder="time" />\n                </div>\n                <div class="col-1 help">\n                    <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                    <div class="tooltip-content">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Maximum duration for this test part.",options):helperMissing.call(depth0,"__","Maximum duration for this test part.",options)))+'\n                    </div>\n                </div>\n            </div>\n\n<!-- assessmentTest/testPart/timeLimits/allowLateSubmission -->\n            <div class="grid-row pseudo-label-box">\n                <div class="col-5">\n                    <label for="testpart-allow-late-submission">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Late submission allowed",options):helperMissing.call(depth0,"__","Late submission allowed",options)))+'</label>\n                </div>\n                <div class="col-6">\n                    <label>\n                        <input type="checkbox" name="section-allow-late-submission" value="true" data-bind="timeLimits.allowLateSubmission" data-bind-encoder="boolean" />\n                        <span class="icon-checkbox" />\n                    </label>\n                </div>\n                <div class="col-1 help">\n                    <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                    <div class="tooltip-content">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Whether a candidate's response that is beyond the maximum duration of the test part should still be accepted.",options):helperMissing.call(depth0,"__","Whether a candidate's response that is beyond the maximum duration of the test part should still be accepted.",options)))+"\n                    </div>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>\n"})}),define("tpl!taoQtiTest/controller/creator/templates/section-props",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),
data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div id="section-props-',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="section-props props clearfix">\n    <h3>',(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</h3>\n\n<!-- assessmentTest/testPart/assessmentSection/identifier -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="section-identifier">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Identifier",options):helperMissing.call(depth0,"__","Identifier",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="section-identifier" data-bind="identifier" data-validate="$notEmpty; $idFormat; $testIdAvailable(original=',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+');" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"The identifier of the section.",options):helperMissing.call(depth0,"__","The identifier of the section.",options)))+'\n            </div>\n        </div>\n    </div>\n\n<!-- assessmentTest/testPart/assessmentSection/title -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="section-title">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Title",options):helperMissing.call(depth0,"__","Title",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="section-title" data-bind="title" data-validate="$notEmpty" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The section title.",options):helperMissing.call(depth0,"__","The section title.",options)))+'\n            </div>\n        </div>\n    </div>\n\n\n\n\n\n<!-- assessmentTest/testPart/assessmentSection/visible -->\n    <div class="grid-row pseudo-label-box">\n        <div class="col-5">\n            <label for="section-visible">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Visible",options):helperMissing.call(depth0,"__","Visible",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <label>\n                <input type="checkbox" name="section-visible" value="true" checked="checked"  data-bind="visible" data-bind-encoder="boolean" />\n                <span class="icon-checkbox"></span>\n            </label>\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"A visible section is one that is identifiable by the candidate.",options):helperMissing.call(depth0,"__","A visible section is one that is identifiable by the candidate.",options)))+'\n            </div>\n        </div>\n    </div>\n\n<!-- assessmentTest/testPart/assessmentSection/keepTogether -->\n    <div class="grid-row pseudo-label-box">\n        <div class="col-5">\n            <label for="section-keep-together">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Keep Together",options):helperMissing.call(depth0,"__","Keep Together",options)))+'</label>\n        </div>\n\n        <div class="col-6">\n            <label>\n                <input type="checkbox" name="section-keep-together" value="true" checked="checked"  data-bind="keepTogether" data-bind-encoder="boolean" />\n                <span class="icon-checkbox"></span>\n            </label>\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"An invisible section with a parent that is subject to shuffling can specify whether or not its children, which will appear to the candidate as if they were part of the parent, are shuffled as a block or mixed up with the other children of the parent section.",options):helperMissing.call(depth0,"__","An invisible section with a parent that is subject to shuffling can specify whether or not its children, which will appear to the candidate as if they were part of the parent, are shuffled as a block or mixed up with the other children of the parent section.",options)))+'\n            </div>\n        </div>\n    </div>\n\n    <!-- assessmentTest/testPart/assessmentSection/sectionPart/category -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="section-category">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Categories",options):helperMissing.call(depth0,"__","Categories",options)))+'</label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="section-category" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Section level category enables configuring the categories of its composing items all at once. A category in gray means that all items have that category. A category in white means that only a few items have that category.",options):helperMissing.call(depth0,"__","Section level category enables configuring the categories of its composing items all at once. A category in gray means that all items have that category. A category in white means that only a few items have that category.",options)))+'\n            </div>\n        </div>\n    </div>\n\n    <h4 class="toggler closed" data-toggle="~ .section-selection">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Selection",options):helperMissing.call(depth0,"__","Selection",options)))+'</h4>\n\n<!-- assessmentTest/testPart/assessmentSection/selection -->\n    <div class="section-selection toggled">\n\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-enable-selection">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Enable selection",options):helperMissing.call(depth0,"__","Enable selection",options)))+'</label>\n            </div>\n\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-enable-selection"  />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/selection/select -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="section-select">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Select",options):helperMissing.call(depth0,"__","Select",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n            </div>\n            <div class="col-6">\n                <input name="section-select" type="text" data-increment="1" data-min="0" value="0" data-bind="selection.select"  data-bind-encoder="number" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The number of child elements to be selected.",options):helperMissing.call(depth0,"__","The number of child elements to be selected.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/selection/withReplacement -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-with-replacement">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"With Replacement",options):helperMissing.call(depth0,"__","With Replacement",options)))+'</label>\n            </div>\n\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-with-replacement" value="true" data-bind="selection.withReplacement"  data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"When selecting child elements each element is normally eligible for selection once only.",options):helperMissing.call(depth0,"__","When selecting child elements each element is normally eligible for selection once only.",options)))+'\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="toggler closed" data-toggle="~ .section-ordering">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Ordering",options):helperMissing.call(depth0,"__","Ordering",options)))+'</h4>\n\n<!-- assessmentTest/testPart/assessmentSection/ordering -->\n    <div class="section-ordering toggled">\n<!-- assessmentTest/testPart/assessmentSection/ordering/shuffle -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-shuffle">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Shuffle",options):helperMissing.call(depth0,"__","Shuffle",options)))+'</label>\n            </div>\n\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-shuffle" value="true" data-bind="ordering.shuffle"  data-bind-encoder="boolean"  />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"If set, it causes the order of the child elements to be randomized, otherwise it uses the order in which the child elements are defined.",options):helperMissing.call(depth0,"__","If set, it causes the order of the child elements to be randomized, otherwise it uses the order in which the child elements are defined.",options)))+'\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <h4 class="toggler closed" data-toggle="~ .section-item-session-control">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Item Session Control",options):helperMissing.call(depth0,"__","Item Session Control",options)))+'</h4>\n\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl -->\n    <div class="section-item-session-control toggled">\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/maxAttempts -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="section-max-attempts">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Max Attempts",options):helperMissing.call(depth0,"__","Max Attempts",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <input name="section-max-attempts" type="text" data-increment="1" data-min="0" value="1" data-bind="itemSessionControl.maxAttempts" data-bind-encoder="number" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={
hash:{},data:data},helper?helper.call(depth0,"Controls the maximum number of attempts allowed. 0 means unlimited.",options):helperMissing.call(depth0,"__","Controls the maximum number of attempts allowed. 0 means unlimited.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/showFeedback -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-show-feedback">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Show Feedback",options):helperMissing.call(depth0,"__","Show Feedback",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-show-feedback" value="true" data-bind="itemSessionControl.showFeedback" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This constraint affects the visibility of feedback after the end of the last attempt.",options):helperMissing.call(depth0,"__","This constraint affects the visibility of feedback after the end of the last attempt.",options)))+'\n                </div>\n            </div>\n        </div>\n\n\n\n\n\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/allowComment -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-allow-comment">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Allow Comment",options):helperMissing.call(depth0,"__","Allow Comment",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-allow-comment" value="true"  data-bind="itemSessionControl.allowComment" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.",options):helperMissing.call(depth0,"__","This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/allowSkipping -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-allow-skipping">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Allow Skipping",options):helperMissing.call(depth0,"__","Allow Skipping",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-allow-skipping" value="true" checked="checked" data-bind="itemSessionControl.allowSkipping" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"If the candidate can skip the item, without submitting a response.",options):helperMissing.call(depth0,"__","If the candidate can skip the item, without submitting a response.",options)))+'\n                </div>\n            </div>\n        </div>\n\n\n    </div>\n\n    <h4 class="toggler closed" data-toggle="~ .section-time-limits">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Time Limits",options):helperMissing.call(depth0,"__","Time Limits",options)))+'</h4>\n\n<!-- assessmentTest/timeLimits -->\n    <div class="section-time-limits toggled">\n\n\n\n\n<!-- assessmentTest/testPart/assessmentSection/timeLimits/maxTime -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="section-max-time">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Maximum Duration",options):helperMissing.call(depth0,"__","Maximum Duration",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <input type="text" name="max-time" value="00:00:00" data-duration="HH:mm:ss" data-bind="timeLimits.maxTime" data-bind-encoder="time" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data
},helper?helper.call(depth0,"Maximum duration for this section.",options):helperMissing.call(depth0,"__","Maximum duration for this section.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/timeLimits/allowLateSubmission -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="section-allow-late-submission">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Late submission allowed",options):helperMissing.call(depth0,"__","Late submission allowed",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="section-allow-late-submission" value="true" data-bind="timeLimits.allowLateSubmission" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span>\n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Whether a candidate's response that is beyond the maximum duration of the section should still be accepted.",options):helperMissing.call(depth0,"__","Whether a candidate's response that is beyond the maximum duration of the section should still be accepted.",options)))+"\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"})}),define("tpl!taoQtiTest/controller/creator/templates/itemref-props",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};
var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div id="itemref-props-',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="itemref-props props clearfix">\n\n    <h3>',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</h3>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/identifier -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="itemref-identifier">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Identifier",options):helperMissing.call(depth0,"__","Identifier",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="itemref-identifier" data-bind="identifier" data-validate="$notEmpty; $testIdFormat; $testIdAvailable(original=',(helper=helpers.identifier)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.identifier,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+');" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"The identifier of the item reference.",options):helperMissing.call(depth0,"__","The identifier of the item reference.",options)))+'\n            </div>\n        </div>\n    </div>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/href -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="itemref-href">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Reference",options):helperMissing.call(depth0,"__","Reference",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="itemref-href" data-bind="href" readonly="readonly" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"The reference.",options):helperMissing.call(depth0,"__","The reference.",options)))+'\n            </div>\n        </div>\n    </div>\n    \n<!-- assessmentTest/testPart/assessmentSection/sectionPart/category -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="itemref-category">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Categories",options):helperMissing.call(depth0,"__","Categories",options)))+'</label>\n        </div>\n        <div class="col-6">\n            <input type="text" name="itemref-category" data-bind="categories" data-bind-encoder="str2array" />\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Items can optionally be assigned to one or more categories.",options):helperMissing.call(depth0,"__","Items can optionally be assigned to one or more categories.",options)))+'\n            </div>\n        </div>\n    </div>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/required -->\n    <div class="grid-row pseudo-label-box">\n        <div class="col-5">\n            <label for="itemref-required">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required",options):helperMissing.call(depth0,"__","Required",options)))+'</label>\n        </div>\n        <div class="col-6">\n            <label>\n                <input type="checkbox" name="itemref-required" value="true" data-bind="required" data-bind-encoder="boolean" />\n                <span class="icon-checkbox"></span>\n            </label>\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"If required it must appear (at least once) in the selection.",options):helperMissing.call(depth0,"__","If required it must appear (at least once) in the selection.",options)))+'\n            </div>\n        </div>\n    </div>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/fixed -->\n    <div class="grid-row pseudo-label-box">\n        <div class="col-5">\n            <label for="itemref-fixed">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Fixed",options):helperMissing.call(depth0,"__","Fixed",options)))+'</label>\n        </div>\n        <div class="col-6">\n            <label>\n                <input type="checkbox" name="itemref-fixed" value="true" data-bind="fixed" data-bind-encoder="boolean" />\n                <span class="icon-checkbox"></span>\n            </label>\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Not shuffled, the position remains fixed.",options):helperMissing.call(depth0,"__","Not shuffled, the position remains fixed.",options)))+'\n            </div>\n        </div>\n    </div>\n\n\n    <h4 class="toggler closed" data-toggle="~ .itemref-item-session-control">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Item Session Control",options):helperMissing.call(depth0,"__","Item Session Control",options)))+'</h4>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl -->\n    <div class="itemref-item-session-control toggled">\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/maxAttempts -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="itemref-max-attempts">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Max Attempts",options):helperMissing.call(depth0,"__","Max Attempts",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <input name="itemref-max-attempts" type="text" data-increment="1" data-min="0" value="1" data-bind="itemSessionControl.maxAttempts" data-bind-encoder="number" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={
hash:{},data:data},helper?helper.call(depth0,"Controls the maximum number of attempts allowed. 0 means unlimited.",options):helperMissing.call(depth0,"__","Controls the maximum number of attempts allowed. 0 means unlimited.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/showFeedback -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="itemref-show-feedback">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Show Feedback",options):helperMissing.call(depth0,"__","Show Feedback",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="itemref-show-feedback" value="true" data-bind="itemSessionControl.showFeedback" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This constraint affects the visibility of feedback after the end of the last attempt.",options):helperMissing.call(depth0,"__","This constraint affects the visibility of feedback after the end of the last attempt.",options)))+'\n                </div>\n            </div>\n        </div>\n\n\n\n\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/allowComment -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="itemref-allow-comment">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},
helper?helper.call(depth0,"Allow Comment",options):helperMissing.call(depth0,"__","Allow Comment",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="itemref-allow-comment" value="true"  data-bind="itemSessionControl.allowComment" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.",options):helperMissing.call(depth0,"__","This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/allowSkipping -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="itemref-allow-skipping">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Allow Skipping",options):helperMissing.call(depth0,"__","Allow Skipping",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="itemref-allow-skipping" value="true" checked="checked" data-bind="itemSessionControl.allowSkipping" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"If the candidate can skip the item, without submitting a response.",options):helperMissing.call(depth0,"__","If the candidate can skip the item, without submitting a response.",options)))+'\n                </div>\n            </div>\n        </div>\n\n\n    </div>\n\n    <h4 class="toggler closed" data-toggle="~ .itemref-time-limits">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Time Limits",options):helperMissing.call(depth0,"__","Time Limits",options)))+'</h4>\n\n<!-- assessmentTest/timeLimits -->\n    <div class="itemref-time-limits toggled">\n\n\n\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/timeLimits/maxTime -->\n        <div class="grid-row">\n            <div class="col-5">\n                <label for="itemref-max-time">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Maximum Duration",options):helperMissing.call(depth0,"__","Maximum Duration",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <input type="text" name="max-time" value="00:00:00" data-duration="HH:mm:ss" data-bind="timeLimits.maxTime" data-bind-encoder="time" />\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data
},helper?helper.call(depth0,"Maximum duration for this item.",options):helperMissing.call(depth0,"__","Maximum duration for this item.",options)))+'\n                </div>\n            </div>\n        </div>\n\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/timeLimits/allowLateSubmission -->\n        <div class="grid-row pseudo-label-box">\n            <div class="col-5">\n                <label for="itemref-allow-late-submission">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Late submission allowed",options):helperMissing.call(depth0,"__","Late submission allowed",options)))+'</label>\n            </div>\n            <div class="col-6">\n                <label>\n                    <input type="checkbox" name="itemref-allow-late-submission" value="true" data-bind="timeLimits.allowLateSubmission" data-bind-encoder="boolean" />\n                    <span class="icon-checkbox"></span>\n                </label>\n            </div>\n            <div class="col-1 help">\n                <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n                <div class="tooltip-content">\n                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Whether a candidate's response that is beyond the maximum duration of the item should still be accepted.",options):helperMissing.call(depth0,"__","Whether a candidate's response that is beyond the maximum duration of the item should still be accepted.",options)))+"\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"})}),define("tpl!taoQtiTest/controller/creator/templates/rubricblock-props",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};
var stack1,helper,options,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="rubricblock-props props clearfix">\n\n    <h3>'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Rubric Block",options):helperMissing.call(depth0,"__","Rubric Block",options)))+": ",(helper=helpers.index)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.index,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</h3>\n\n <!--assessmentTest/testPart/assessmentSection/sectionPart/rubrickBlocK/views -->\n    <div class="grid-row">\n        <div class="col-5">\n            <label for="itemref-identifier">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Views",options):helperMissing.call(depth0,"__","Views",options)))+' <abbr title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Required field",options):helperMissing.call(depth0,"__","Required field",options)))+'">*</abbr></label>\n        </div>\n        <div class="col-6">\n            <select name="view" multiple="multiple" data-bind="views">\n                <option value="author">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Author",options):helperMissing.call(depth0,"__","Author",options)))+'</option>\n                <option value="candidate">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Candidate",options):helperMissing.call(depth0,"__","Candidate",options)))+'</option>\n                <option value="proctor">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Proctor",options):helperMissing.call(depth0,"__","Proctor",options)))+'</option>\n                <option value="scorer">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Scorer",options):helperMissing.call(depth0,"__","Scorer",options)))+'</option>\n                <option value="testConstructor">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Test constructor",options):helperMissing.call(depth0,"__","Test constructor",options)))+'</option>\n                <option value="tutor">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Tutor",options):helperMissing.call(depth0,"__","Tutor",options)))+'</option>\n            </select>\n        </div>\n        <div class="col-1 help">\n            <span class="icon-help" data-tooltip="~ .tooltip-content" data-tooltip-theme="info"></span> \n            <div class="tooltip-content">\n            '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Who can view the rubric block during the delivery.",options):helperMissing.call(depth0,"__","Who can view the rubric block during the delivery.",options)))+"\n            </div>\n        </div>\n    </div>\n\n</div>\n"})}),define("taoQtiTest/controller/creator/templates/index",["tpl!taoQtiTest/controller/creator/templates/testpart","tpl!taoQtiTest/controller/creator/templates/section","tpl!taoQtiTest/controller/creator/templates/rubricblock","tpl!taoQtiTest/controller/creator/templates/itemref","tpl!taoQtiTest/controller/creator/templates/item","tpl!taoQtiTest/controller/creator/templates/test-props","tpl!taoQtiTest/controller/creator/templates/testpart-props","tpl!taoQtiTest/controller/creator/templates/section-props","tpl!taoQtiTest/controller/creator/templates/itemref-props","tpl!taoQtiTest/controller/creator/templates/rubricblock-props"],function(testPart,section,rubricBlock,itemRef,item,testProps,testPartProps,sectionProps,itemRefProps,rubricBlockProps){
"use strict";return{testpart:testPart,section:section,itemref:itemRef,item:item,rubricblock:rubricBlock,properties:{test:testProps,testpart:testPartProps,section:sectionProps,itemref:itemRefProps,rubricblock:rubricBlockProps}}}),define("taoQtiTest/controller/creator/views/item",["jquery","taoQtiTest/controller/creator/templates/index"],function($,templates){"use strict";var itemTemplate=templates.item,itemView=function(loadItems){function setUpLiveSearch(){var timeout,liveSearch=function(){var pattern=$search.val();(pattern.length>1||0===pattern.length)&&(clearTimeout(timeout),timeout=setTimeout(function(){loadItems(pattern,function(items){update(items)})},300));
};$search.keyup(liveSearch).siblings(".ctrl").click(liveSearch)}function update(items){disableSelection(),$itemBox.empty().append(itemTemplate(items)),enableSelection()}function disableSelection(){$panel.data("selectable")&&$panel.selectable("disable")}function enableSelection(){$panel.data("selectable")?$panel.selectable("enable"):$panel.selectable({filter:"li",selected:function(event,ui){$(ui.selected).addClass("selected")},unselected:function(event,ui){$(ui.unselected).removeClass("selected")},stop:function(){$(this).trigger("itemselect.creator",$(".selected"))}})}var $panel=$(".test-creator-items .item-selection"),$search=$("#item-filter"),$itemBox=$(".item-box",$panel);
"function"==typeof loadItems&&loadItems(void 0,function(items){update(items),setUpLiveSearch()})};return itemView}),define("taoQtiTest/controller/creator/views/property",["jquery","ui","core/databinder","taoQtiTest/controller/creator/templates/index"],function($,ui,DataBinder,templates){"use strict";var propView=function(tmplName,model){function propValidation(){$view.on("validated.group",function(e,isValid){if("group"===e.namespace){var $togglers=$("#test-creator .property-toggler, #saver");isValid===!0?$togglers.removeClass("disabled"):$togglers.addClass("disabled")}}),$view.groupValidator()}var $view,$container=$(".test-creator-props"),template=templates.properties[tmplName],open=function(){
var databinder;$container.children(".props").hide().trigger("propclose.propview"),$view=$(template(model)).appendTo($container).filter(".props"),ui.startDomComponent($view),databinder=new DataBinder($view,model),databinder.bind(),propValidation(),$view.trigger("propopen.propview")},getView=function(){return $view},isOpen=function(){return"none"!==$view.css("display")},onOpen=function(cb){$view.on("propopen.propview",function(e){e.stopPropagation(),cb()})},onClose=function(cb){$view.on("propclose.propview",function(e){e.stopPropagation(),cb()})},destroy=function(){$view.remove()},toggle=function(){$container.children(".props").not($view).hide().trigger("propclose.propview"),
isOpen()?$view.hide().trigger("propclose.propview"):$view.show().trigger("propopen.propview")};return{open:open,getView:getView,isOpen:isOpen,onOpen:onOpen,onClose:onClose,destroy:destroy,toggle:toggle}};return propView}),define("taoQtiTest/controller/creator/views/actions",["jquery","taoQtiTest/controller/creator/views/property"],function($,propertyView){"use strict";function properties($container,template,model,cb){var propView=null;$container.find(".property-toggler").on("click",function(e){e.preventDefault();var $elt=$(this);$(this).hasClass(disabledClass)||($elt.blur(),null===propView?($container.addClass(activeClass),$elt.addClass(btnOnClass),propView=propertyView(template,model),
propView.open(),propView.onOpen(function(){$container.addClass(activeClass),$elt.addClass(btnOnClass)}),propView.onClose(function(){$container.removeClass(activeClass),$elt.removeClass(btnOnClass)}),"function"==typeof cb&&cb(propView)):propView.toggle())})}function move($actionContainer,containerClass,elementClass){var $element=$actionContainer.parents("."+elementClass),$container=$element.parents("."+containerClass);$(".move-up",$actionContainer).click(function(e){var $elements,index;return e.preventDefault(),$element.is(":animated")?!1:($elements=$("."+elementClass,$container),index=$elements.index($element),void(index>0&&$element.fadeOut(200,function(){$element.insertBefore($("."+elementClass+" :eq("+(index-1)+")",$container)).fadeIn(400,function(){
$container.trigger("change")})})))}),$(".move-down",$actionContainer).click(function(e){var $elements,index;return e.preventDefault(),$element.is(":animated")?!1:($elements=$("."+elementClass,$container),index=$elements.index($element),void(index<$elements.length-1&&$elements.length>1&&$element.fadeOut(200,function(){$element.insertAfter($("."+elementClass+" :eq("+(index+1)+")",$container)).fadeIn(400,function(){$container.trigger("change")})})))})}function movable($container,elementClass,actionContainerElt){$container.each(function(){var $elt=$(this),$actionContainer=$(actionContainerElt,$elt),index=$container.index($elt),$moveUp=$(".move-up",$actionContainer),$moveDown=$(".move-down",$actionContainer);
1===$container.length?($moveUp.addClass(disabledClass),$moveDown.addClass(disabledClass)):0===index?($moveUp.addClass(disabledClass),$moveDown.removeClass(disabledClass)):index>=$container.length-1?($moveDown.addClass(disabledClass),$moveUp.removeClass(disabledClass)):($moveUp.removeClass(disabledClass),$moveDown.removeClass(disabledClass))})}function removable($container,actionContainerElt){$container.each(function(){var $elt=$(this),$actionContainer=$(actionContainerElt,$elt),$delete=$("[data-delete]",$actionContainer);$container.length<=1?$delete.addClass(disabledClass):$delete.removeClass(disabledClass)})}function disable($container,actionContainerElt){$container.find(actionContainerElt).find("[data-delete],.move-up,.move-down").addClass(disabledClass);
}function enable($container,actionContainerElt){$container.find(actionContainerElt).find("[data-delete],.move-up,.move-down").removeClass(disabledClass)}var disabledClass="disabled",activeClass="active",btnOnClass="tlb-button-on";return{properties:properties,move:move,removable:removable,movable:movable,disable:disable,enable:enable}}),define("taoQtiTest/controller/creator/views/itemref",["jquery","lodash","i18n","taoQtiTest/controller/creator/views/actions"],function($,_,__,actions){"use strict";var setUp=function($itemRef,model){function propHandler(propView){function removePropHandler(e){null!==propView&&propView.destroy()}categoriesProperty(propView.getView()),
$itemRef.parents(".testpart").on("delete",removePropHandler),$itemRef.parents(".section").on("delete",removePropHandler),$itemRef.on("delete",removePropHandler)}function categoriesProperty($view){function initCategories(){$select.select2("val",model.categories)}var $select=$view.find("[name=itemref-category]");$select.select2({width:"100%",tags:[],multiple:!0,tokenSeparators:[","," ",";"],formatNoMatches:function(){return __("Enter a category")},maximumInputLength:32}),initCategories(),$view.on("propopen.propview",function(){initCategories()})}var $actionContainer=$(".actions",$itemRef);actions.properties($actionContainer,"itemref",model,propHandler),actions.move($actionContainer,"itemrefs","itemref"),
resize()},listenActionState=function(){$(".itemrefs").each(function(){actions.movable($(".itemref",$(this)),"itemref",".actions")}),$(document).on("delete",function(e){var $parent,$target=$(e.target);$target.hasClass("itemref")&&($parent=$target.parents(".itemrefs"),actions.disable($parent.find(".itemref"),".actions"))}).on("add change undo.deleter deleted.deleter",".itemrefs",function(e){var $parent,$target=$(e.target);($target.hasClass("itemref")||$target.hasClass("itemrefs"))&&($parent=$(".itemref",$target.hasClass("itemrefs")?$target:$target.parents(".itemrefs")),actions.enable($parent,".actions"),actions.movable($parent,"itemref",".actions"))})},resize=_.throttle(function(){
var $refs=$(".itemrefs").first(),$actions=$(".itemref .actions").first(),width=$refs.innerWidth()-$actions.outerWidth();$(".itemref > .title").width(width)},100);return{setUp:setUp,listenActionState:listenActionState,resize:resize}}),define("taoQtiTest/controller/creator/helpers/ckConfigurator",["ui/ckeditor/ckConfigurator","mathJax"],function(ckConfigurator,mathJax){"use strict";var getConfig=function(editor,toolbarType,options){return options=options||{},options.underline=!0,ckConfigurator.getConfig(editor,toolbarType,options)};return{getConfig:getConfig}}),define("taoQtiTest/controller/creator/views/rubricblock",["jquery","lodash","taoQtiTest/controller/creator/views/actions","helpers","ckeditor","taoQtiTest/controller/creator/helpers/ckConfigurator"],function($,_,actions,helpers,ckeditor,ckConfigurator){
"use strict";var ckConfig=ckConfigurator.getConfig(ckeditor,"qtiBlock"),filterPlugin=function(plugin){return _.contains(["taoqtiimage","taoqtimedia","taoqtimaths","taoqtiinclude"],plugin)};ckConfig.plugins=_.reject(ckConfig.plugins.split(","),filterPlugin).join(","),ckConfig.extraPlugins=_.reject(ckConfig.extraPlugins.split(","),filterPlugin).join(",");var setUp=function($rubricBlock,model,data){function propHandler(propView){function removePropHandler(e){null!==propView&&propView.destroy()}rbViews(propView.getView()),$rubricBlock.parents(".testpart").on("delete",removePropHandler),$rubricBlock.parents(".section").on("delete",removePropHandler),$rubricBlock.on("delete",removePropHandler);
}function rbViews($propContainer){var $select=$("select",$propContainer);$select.select2({width:"100%"}).on("select2-removed",function(e){0===$select.select2("val").length&&$select.select2("val",[1])}),0===$select.select2("val").length&&$select.select2("val",[1])}function setUpEditor(){var editor,$rubricBlockBinding=$(".rubricblock-binding",$rubricBlock),$rubricBlockContent=$(".rubricblock-content",$rubricBlock),syncRubricBlockContent=_.throttle(function(){$rubricBlockBinding.html($rubricBlockContent.html()).trigger("change")},100);$rubricBlockContent.empty().html($rubricBlockBinding.html()),editor=ckeditor.inline($rubricBlockContent[0],ckConfig),editor.on("change",function(e){
syncRubricBlockContent()})}actions.properties($rubricBlock,"rubricblock",model,propHandler),setUpEditor()};return{setUp:setUp}}),define("taoQtiTest/controller/creator/helpers/qtiTest",["lodash","i18n"],function(_,__){"use strict";var qtiTestHelper={extractIdentifiers:function(obj){var self=this,identifiers=[];return _.has(obj,"identifier")&&(identifiers=identifiers.concat(obj.identifier.toLowerCase())),_.flatten(_.forEach(obj,function(value){identifiers=identifiers.concat("object"==typeof value?self.extractIdentifiers(value):[])}),!0),identifiers},getIdentifier:function(qtiType,lockedIdentifiers){var suggestion,index=1,glue="-";do suggestion=qtiType+glue+index++;while(_.contains(lockedIdentifiers,suggestion.toLowerCase()));
return lockedIdentifiers.push(suggestion.toLowerCase()),suggestion},idFormatValidator:function(){var qtiIdPattern=/^[_a-zA-Z]{1}[a-zA-Z0-9\-._]{0,31}$/i;return{name:"idFormat",message:__("is not a valid identifier (alphanum, underscore, dash and dots)"),validate:function(value,callback){"function"==typeof callback&&callback(qtiIdPattern.test(value))}}},testidFormatValidator:function(){var qtiTestIdPattern=/^\S+$/;return{name:"testIdFormat",message:__("is not a valid identifier (everything except spaces)"),validate:function(value,callback){"function"==typeof callback&&callback(qtiTestIdPattern.test(value))}}},idAvailableValidator:function(lockedIdentifiers){return{
name:"testIdAvailable",message:__("is already used in the test."),validate:function(value,callback,options){"function"==typeof callback&&callback(!_.contains(_.values(lockedIdentifiers),value.toLowerCase())||options.original&&value===options.original)}}},filterQtiType:function(value,type){return value["qti-type"]&&value["qti-type"]===type},addMissingQtiType:function(collection,parentType){var self=this;_.forEach(collection,function(value,key){!_.isObject(value)||_.isArray(value)||_.has(value,"qti-type")||(_.isNumber(key)?parentType&&(value["qti-type"]=parentType):value["qti-type"]=key),_.isArray(value)?self.addMissingQtiType(value,key.replace(/s$/,"")):_.isObject(value)&&self.addMissingQtiType(value);
})},consolidateModel:function(model){if(model&&model.testParts&&_.isArray(model.testParts)&&model.testParts[0]){var testPart=model.testParts[0];testPart.assessmentSections&&_.isArray(testPart.assessmentSections)&&_.forEach(testPart.assessmentSections,function(assessmentSection,key){assessmentSection.ordering&&void 0!==assessmentSection.ordering.shuffle&&assessmentSection.ordering.shuffle===!1&&delete assessmentSection.ordering,assessmentSection.rubricBlocks&&_.isArray(assessmentSection.rubricBlocks)&&(0===assessmentSection.rubricBlocks.length||1===assessmentSection.rubricBlocks.length&&0===assessmentSection.rubricBlocks[0].content.length?delete assessmentSection.rubricBlocks:assessmentSection.rubricBlocks.length>0&&_.forEach(assessmentSection.rubricBlocks,function(rubricBlock){
rubricBlock.views=["candidate"]}))})}return model}};return qtiTestHelper}),define("taoQtiTest/controller/creator/helpers/sectionCategory",["lodash","core/errorHandler"],function(_,errorHandler){"use strict";function isValidSectionModel(model){return _.isObject(model)&&"assessmentSection"===model["qti-type"]&&_.isArray(model.sectionParts)}function setCategories(model,categories){var oldCategories=getCategories(model),removed=_.difference(oldCategories.all,categories),propagated=_.difference(categories,oldCategories.all);addCategories(model,propagated),removeCategories(model,removed)}function getCategories(model){if(isValidSectionModel(model)){var categories=_.map(model.sectionParts,function(itemRef){
return"assessmentItemRef"===itemRef["qti-type"]&&_.isArray(itemRef.categories)?_.compact(itemRef.categories):void 0}),arrays=_.values(categories),union=_.union.apply(null,arrays),propagated=_.intersection.apply(null,arrays),partial=_.difference(union,propagated);return{all:union.sort(),propagated:propagated.sort(),partial:partial.sort()}}errorHandler["throw"](_ns,"invalid tool config format")}function addCategories(model,categories){isValidSectionModel(model)?_.each(model.sectionParts,function(itemRef){"assessmentItemRef"===itemRef["qti-type"]&&(_.isArray(itemRef.categories)||(itemRef.categories=[]),itemRef.categories=_.union(itemRef.categories,categories))}):errorHandler["throw"](_ns,"invalid tool config format");
}function removeCategories(model,categories){isValidSectionModel(model)?_.each(model.sectionParts,function(itemRef){"assessmentItemRef"===itemRef["qti-type"]&&_.isArray(itemRef.categories)&&(itemRef.categories=_.difference(itemRef.categories,categories))}):errorHandler["throw"](_ns,"invalid tool config format")}var _ns=".sectionCategory";return{isValidSectionModel:isValidSectionModel,setCategories:setCategories,getCategories:getCategories,addCategories:addCategories,removeCategories:removeCategories}}),define("taoQtiTest/controller/creator/views/section",["jquery","lodash","uri","i18n","taoQtiTest/controller/creator/views/actions","taoQtiTest/controller/creator/views/itemref","taoQtiTest/controller/creator/views/rubricblock","taoQtiTest/controller/creator/templates/index","taoQtiTest/controller/creator/helpers/qtiTest","taoQtiTest/controller/creator/helpers/sectionCategory"],function($,_,uri,__,actions,itemRefView,rubricBlockView,templates,qtiTestHelper,sectionCategory){
"use strict";var setUp=function($section,model,data){function propHandler(propView){function removePropHandler(){null!==propView&&propView.destroy()}var $view=propView.getView(),$selectionSwitcher=$("[name=section-enable-selection]",$view),$selectionSelect=$("[name=section-select]",$view),$selectionWithRep=$("[name=section-with-replacement]",$view),switchSelection=function(){$selectionSwitcher.prop("checked")===!0?($selectionSelect.incrementer("enable"),$selectionWithRep.removeClass("disabled")):($selectionSelect.incrementer("disable"),$selectionWithRep.addClass("disabled"))};$selectionSwitcher.on("change",switchSelection),$selectionSwitcher.on("change",function(){
$selectionSwitcher.prop("checked")||($selectionSelect.val(0),$selectionWithRep.prop("checked",!1),delete model.selection)}),$selectionSwitcher.prop("checked",!!model.selection).trigger("change");var $title=$("[data-bind=title]",$section);$view.on("change.binder",function(e,model){"binder"===e.namespace&&"assessmentSection"===model["qti-type"]&&$title.text(model.title)}),$section.parents(".testpart").on("deleted.deleter",removePropHandler),$section.on("deleted.deleter",removePropHandler),categoriesProperty($view)}function itemRefs(){model.sectionParts||(model.sectionParts=[]),$(".itemref",$section).each(function(){var $itemRef=$(this),index=$itemRef.data("bind-index");
model.sectionParts[index]||(model.sectionParts[index]={}),itemRefView.setUp($itemRef,model.sectionParts[index]),$itemRef.find(".title").text(data.labels[uri.encode($itemRef.data("uri"))])})}function acceptItemRefs(){var $selected,$items=$(".test-creator-items");$items.on("itemselect.creator",function(e){var selection=Array.prototype.slice.call(arguments,1),$placeholder=$(".itemref-placeholder",$section),$placeholders=$(".itemref-placeholder");selection.length>0?$placeholder.show().off("click").on("click",function(e){var categories,defaultItemData={};model.itemSessionControl&&!_.isUndefined(model.itemSessionControl.maxAttempts)&&(defaultItemData.itemSessionControl=_.clone(model.itemSessionControl)),
categories=sectionCategory.getCategories(model),defaultItemData.categories=categories.propagated,_.forEach(selection,function(item){var $item=$(item);addItemRef($(".itemrefs",$section),void 0,_.defaults({href:uri.decode($item.data("uri")),label:$.trim($item.clone().children().remove().end().text()),"qti-type":"assessmentItemRef"},defaultItemData))}),$(".ui-selected",$items).removeClass("ui-selected").removeClass("selected"),$placeholders.hide().off("click")}):$placeholders.hide().off("click")}),$(document).off("add.binder","#"+$section.attr("id")+" .itemrefs").on("add.binder","#"+$section.attr("id")+" .itemrefs",function(e,$itemRef){if("binder"===e.namespace&&$itemRef.hasClass("itemref")){
var index=$itemRef.data("bind-index");itemRefView.setUp($itemRef,model.sectionParts[index])}}),$selected=$(".selected",$items),$selected.length>0&&$items.trigger("itemselect.creator",$selected)}function addItemRef($refList,index,itemData){var $itemRef,$items=$refList.children("li");index=index||$items.length,itemData.identifier=qtiTestHelper.getIdentifier("item",data.identifiers),itemData.index=index+1,$itemRef=$(templates.itemref(itemData)),index>0?$itemRef.insertAfter($items.eq(index-1)):$itemRef.appendTo($refList),$refList.trigger("add",[$itemRef,itemData])}function rubricBlocks(){model.rubricBlocks||(model.rubricBlocks=[]),$(".rubricblock",$section).each(function(){
var $rubricBlock=$(this),index=$rubricBlock.data("bind-index");model.rubricBlocks[index]||(model.rubricBlocks[index]={}),rubricBlockView.setUp($rubricBlock,model.rubricBlocks[index],data)}),model.rubricBlocks.length>0&&$(".rub-toggler",$section).trigger("click")}function addRubricBlock(){$(".rublock-adder",$section).adder({target:$(".rubricblocks",$section),content:templates.rubricblock,templateData:function(cb){cb({"qti-type":"rubricBlock",index:$(".rubricblock",$section).length,content:[],views:[1]})}}),$(document).on("add.binder","#"+$section.attr("id")+" .rubricblocks",function(e,$rubricBlock){if("binder"===e.namespace&&$rubricBlock.hasClass("rubricblock")){
var index=$rubricBlock.data("bind-index");$(".rubricblock-binding",$rubricBlock).html("<p>&nbsp;</p>"),rubricBlockView.setUp($rubricBlock,model.rubricBlocks[index],data)}})}function categoriesProperty($view){function initCategories(){var categories=sectionCategory.getCategories(model);$select.select2("val",categories.all),$select.siblings(".select2-container").find(".select2-search-choice").each(function(){var $li=$(this),content=$li.find("div").text();_.indexOf(categories.partial,content)>=0&&$li.addClass("partial")})}function setCategories(categories){sectionCategory.setCategories(model,categories)}var $select=$("[name=section-category]",$view);$select.select2({
width:"100%",tags:[],multiple:!0,tokenSeparators:[","," ",";"],formatNoMatches:function(){return __("Enter a category")},maximumInputLength:32}).on("change",function(e){setCategories(e.val)}),initCategories(),$view.on("propopen.propview",function(){initCategories()})}var $actionContainer=$("h2",$section);actions.properties($actionContainer,"section",model,propHandler),actions.move($actionContainer,"sections","section"),itemRefs(),acceptItemRefs(),rubricBlocks(),addRubricBlock()},listenActionState=function(){var $sections;$(".sections").each(function(){$sections=$(".section",$(this)),actions.removable($sections,"h2"),actions.movable($sections,"section","h2")}),
$(document).on("delete",function(e){var $parent,$target=$(e.target);$target.hasClass("section")&&($parent=$target.parents(".sections"),actions.disable($parent.find(".section"),"h2"))}).on("add change undo.deleter deleted.deleter",function(e){var $target=$(e.target);($target.hasClass("section")||$target.hasClass("sections"))&&($sections=$(".section",$target.hasClass("sections")?$target:$target.parents(".sections")),actions.removable($sections,"h2"),actions.movable($sections,"section","h2"))}).on("open.toggler",".rub-toggler",function(e){"toggler"===e.namespace&&$(this).parents("h2").addClass("active")}).on("close.toggler",".rub-toggler",function(e){"toggler"===e.namespace&&$(this).parents("h2").removeClass("active");
})};return{setUp:setUp,listenActionState:listenActionState}}),define("taoQtiTest/controller/creator/views/testpart",["jquery","lodash","taoQtiTest/controller/creator/views/actions","taoQtiTest/controller/creator/views/section","taoQtiTest/controller/creator/templates/index","taoQtiTest/controller/creator/helpers/qtiTest"],function($,_,actions,sectionView,templates,qtiTestHelper){"use strict";var setUp=function($testPart,model,data){function propHandler(propView){var $view=propView.getView(),$identifier=$("[data-bind=identifier]",$testPart);$view.on("change.binder",function(e,model){"binder"===e.namespace&&"testPart"===model["qti-type"]&&$identifier.text(model.identifier);
}),$testPart.on("delete",function(e){null!==propView&&propView.destroy()})}function sections(){model.assessmentSections||(model.assessmentSections=[]),$(".section",$testPart).each(function(){var $section=$(this),index=$section.data("bind-index");model.assessmentSections[index]||(model.assessmentSections[index]={}),sectionView.setUp($section,model.assessmentSections[index],data)})}function addSection(){$(".section-adder",$testPart).adder({target:$(".sections",$testPart),content:templates.section,templateData:function(cb){var sectionIndex=$(".section",$testPart).length;cb({"qti-type":"assessmentSection",identifier:qtiTestHelper.getIdentifier("assessmentSection",data.identifiers),
title:"Section "+(sectionIndex+1),index:0,sectionParts:[]})}}),$(document).off("add.binder","#"+$testPart.attr("id")+" .sections").on("add.binder","#"+$testPart.attr("id")+" .sections",function(e,$section){if("binder"===e.namespace&&$section.hasClass("section")){var index=$section.data("bind-index");sectionView.setUp($section,model.assessmentSections[index],data)}})}var $actionContainer=$("h1",$testPart);actions.properties($actionContainer,"testpart",model,propHandler),actions.move($actionContainer,"testparts","testpart"),sections(),addSection()},listenActionState=function(){var $testParts=$(".testpart");actions.removable($testParts,"h1"),actions.movable($testParts,"testpart","h1"),
$(".testparts").on("delete",function(e){var $target=$(e.target);$target.hasClass("testpart")&&actions.disable($(".testpart"),"h1")}).on("add change undo.deleter deleted.deleter",function(e){var $target=$(e.target);($target.hasClass("testpart")||$target.hasClass("testparts"))&&($testParts=$(".testpart"),actions.removable($testParts,"h1"),actions.movable($testParts,"testpart","h1"))})};return{setUp:setUp,listenActionState:listenActionState}}),define("taoQtiTest/controller/creator/views/test",["jquery","lodash","taoQtiTest/controller/creator/views/actions","taoQtiTest/controller/creator/views/testpart","taoQtiTest/controller/creator/templates/index","taoQtiTest/controller/creator/helpers/qtiTest"],function($,_,actions,testPartView,templates,qtiTestHelper){
"use strict";var testView=function(model,data){function testParts(){model.testParts||(model.testParts=[]),$(".testpart").each(function(){var $testPart=$(this),index=$testPart.data("bind-index");model.testParts[index]||(model.testParts[index]={}),testPartView.setUp($testPart,model.testParts[index],data)})}function propHandler(propView){var $view=propView.getView(),$title=$(".test-creator-test > h1 [data-bind=title]");$view.on("change.binder",function(e,model){"binder"===e.namespace&&"assessmentTest"===model["qti-type"]&&$title.text(model.title)})}function addTestPart(){$(".testpart-adder").adder({target:$(".testparts"),content:templates.testpart,templateData:function(cb){
var testPartIndex=$(".testpart").length;cb({"qti-type":"testPart",identifier:qtiTestHelper.getIdentifier("testPart",data.identifiers),index:testPartIndex,navigationMode:0,submissionMode:0,assessmentSections:[{"qti-type":"assessmentSection",identifier:qtiTestHelper.getIdentifier("assessmentSection",data.identifiers),title:"Section 1",index:0,sectionParts:[]}]})}}),$(document).off("add.binder",".testparts").on("add.binder",".testparts",function(e,$testPart,added){"binder"===e.namespace&&$testPart.hasClass("testpart")&&testPartView.setUp($testPart,model.testParts[added.index],data)})}actions.properties($(".test-creator-test > h1"),"test",model,propHandler),testParts(),
addTestPart()};return testView}),define("taoQtiTest/controller/creator/encoders/dom2qti",["jquery","lodash"],function($,_){"use strict";var getAttributes=function(object){return _.omit(object,["qti-type","content","xmlBase","lang","label"])},attrToStr=function(attributes){return _.reduce(attributes,function(acc,value,key){return _.isNumber(value)||_.isString(value)&&!_.isEmpty(value)?acc+" "+key+'="'+value+'" ':acc},"")},Dom2QtiEncoder={encode:function(modelValue){var self=this;if(_.isArray(modelValue))return _.reduce(modelValue,function(result,value){return result+self.encode(value)},"");if(_.isObject(modelValue)&&modelValue["qti-type"]){if("textRun"===modelValue["qti-type"])return modelValue.content;
var startTag="<"+modelValue["qti-type"]+attrToStr(getAttributes(modelValue));return modelValue.content?startTag+">"+self.encode(modelValue.content)+"</"+modelValue["qti-type"]+">":startTag+"/>"}return modelValue},decode:function(nodeValue){var self=this,$nodeValue=nodeValue instanceof $?nodeValue:$(nodeValue),result=[];return _.forEach($nodeValue,function(elt){var object;3===elt.nodeType?_.isEmpty($.trim(elt.nodeValue))||result.push({"qti-type":"textRun",content:elt.nodeValue,xmlBase:""}):1===elt.nodeType&&(object=_.merge({"qti-type":elt.nodeName.toLowerCase(),id:"","class":"",xmlBase:"",lang:"",label:""},_.transform(elt.attributes,function(acc,value){value.nodeName&&(acc[value.nodeName]=value.nodeValue);
})),elt.childNodes.length>0&&(object.content=self.decode(elt.childNodes)),result.push(object))}),result}};return Dom2QtiEncoder}),define("taoQtiTest/controller/creator/creator",["module","jquery","lodash","helpers","i18n","history","ui/feedback","core/databindcontroller","taoQtiTest/controller/creator/views/item","taoQtiTest/controller/creator/views/test","taoQtiTest/controller/creator/views/testpart","taoQtiTest/controller/creator/views/section","taoQtiTest/controller/creator/views/itemref","taoQtiTest/controller/creator/encoders/dom2qti","taoQtiTest/controller/creator/templates/index","taoQtiTest/controller/creator/helpers/qtiTest","core/validator/validators"],function(module,$,_,helpers,__,history,feedback,DataBindController,itemView,testView,testPartView,sectionView,itemrefView,Dom2QtiEncoder,templates,qtiTestHelper,validators){
"use strict";function loadItems(url,search,cb){$.getJSON(url,{pattern:search,notempty:"true"},function(data){data&&"function"==typeof cb&&cb(data)})}var Controller={routes:{},identifiers:[],start:function(options){var self=this,$container=$("#test-creator"),$saver=$("#saver");self.identifiers=[],options=_.merge(module.config(),options||{}),options.routes=options.routes||{},options.labels=options.labels||{},$("#authoringBack").on("click",function(e){e.preventDefault(),history&&history.back()}),itemView(_.partial(loadItems,options.routes.items));var binderOptions=_.merge(options.routes,{filters:{isItemRef:function(value){return qtiTestHelper.filterQtiType(value,"assessmentItemRef");
},isSection:function(value){return qtiTestHelper.filterQtiType(value,"assessmentSection")}},encoders:{dom2qti:Dom2QtiEncoder},templates:templates,beforeSave:function(model){return qtiTestHelper.addMissingQtiType(model),qtiTestHelper.consolidateModel(model),!0}}),binder=DataBindController.takeControl($container,binderOptions).get(function(model){self.identifiers=qtiTestHelper.extractIdentifiers(model),validators.register("idFormat",qtiTestHelper.idFormatValidator()),validators.register("testIdFormat",qtiTestHelper.testidFormatValidator()),validators.register("testIdAvailable",qtiTestHelper.idAvailableValidator(self.identifiers),!0),testView(model,{uri:options.uri,
identifiers:self.identifiers,labels:options.labels}),testPartView.listenActionState(),sectionView.listenActionState(),itemrefView.listenActionState(),itemrefView.resize(),$(window).off("resize.qti-test-creator").on("resize.qti-test-creator",function(){itemrefView.resize()})});$saver.on("click",function(event){event.preventDefault(),$saver.hasClass("disabled")||($saver.attr("disabled",!0).addClass("disabled"),binder.save(function(){$saver.attr("disabled",!1).removeClass("disabled"),feedback().success(__("Test Saved"))},function(){$saver.attr("disabled",!1).removeClass("disabled")}))})}};return Controller}),define("taoTests/runner/providerRegistry",["lodash"],function(_){
"use strict";function providerRegistry(target,validator){function registerProvider(name,provider){var valid=!0;if(!_.isString(name)||name.length<=0)throw new TypeError("It is required to give a name to your provider.");if(!_.isPlainObject(provider)||!_.isFunction(provider.init))throw new TypeError("A provider is an object that contains at least an init function.");valid=validator&&_.isFunction(validator)?validator(provider):valid,valid&&(_providers[name]=provider)}function getProvider(providerName){var provider;if(!_providers||0===_.size(_providers))throw new Error("No provider regitered");if(_.isString(providerName)&&providerName.length>0?provider=_providers[providerName]:1===_.size(_providers)&&(providerName=_.keys(_providers)[0],
provider=_providers[providerName]),!provider)throw new Error("No candidate found for the provider");return provider}function clearProviders(){_providers={}}var _providers={};return target=target||{},target.registerProvider=registerProvider,target.getProvider=getProvider,target.clearProviders=clearProviders,target}return providerRegistry}),define("taoTests/runner/runner",["jquery","lodash","i18n","core/eventifier","core/promise","core/logger","taoTests/runner/providerRegistry"],function($,_,__,eventifier,Promise,logger,providerRegistry){"use strict";function testRunnerFactory(providerName,pluginFactories,config){function providerRun(method){var args=[].slice.call(arguments,1);
return new Promise(function(resolve){return _.isFunction(provider[method])?resolve(provider[method].apply(runner,args)):resolve()})}function pluginRun(method){var execStack=[];return _.forEach(runner.getPlugins(),function(plugin){_.isFunction(plugin[method])&&execStack.push(plugin[method]())}),Promise.all(execStack)}function reportError(err){runner.trigger("error",err)}var runner,areaBroker,proxy,testData={},testContext={},plugins={},states={init:!1,ready:!1,render:!1,finish:!1,destroy:!1},provider=testRunnerFactory.getProvider(providerName);return config=config||{},runner=eventifier({init:function(){var self=this;return _.forEach(pluginFactories,function(pluginFactory,pluginName){
plugins[pluginName]=pluginFactory(runner,self.getAreaBroker())}),providerRun("init").then(function(){pluginRun("init").then(function(){self.setState("init",!0).trigger("init").render()})["catch"](reportError)})["catch"](reportError),this},render:function(){var self=this;return providerRun("render").then(function(){pluginRun("render").then(function(){self.setState("ready",!0).trigger("render").trigger("ready")})["catch"](reportError)})["catch"](reportError),this},loadItem:function(itemRef){var self=this;return providerRun("loadItem",itemRef).then(function(itemData){self.trigger("loaditem",itemRef).renderItem(itemData)})["catch"](reportError),this},renderItem:function(itemData){
var self=this;return providerRun("renderItem",itemData).then(function(){self.trigger("renderitem",itemData)})["catch"](reportError),this},unloadItem:function(itemRef){var self=this;return providerRun("unloadItem",itemRef).then(function(){self.trigger("unloaditem",itemRef)})["catch"](reportError),this},finish:function(){var self=this;return providerRun("finish").then(function(){pluginRun("finish").then(function(){self.setState("finish",!0).trigger("finish")})["catch"](reportError)})["catch"](reportError),this},destroy:function(){var self=this;return providerRun("destroy").then(function(){pluginRun("destroy").then(function(){testContext={},self.setState("destroy",!0).trigger("destroy");
})["catch"](reportError)})["catch"](reportError),this},getPlugins:function(){return plugins},getPlugin:function(name){return plugins[name]},getConfig:function(){return config},getAreaBroker:function(){return areaBroker||(areaBroker=provider.loadAreaBroker.call(this)),areaBroker},getProxy:function(){if(!proxy){if(!_.isFunction(provider.loadProxy))throw new Error("The provider does not have a loadProxy method");proxy=provider.loadProxy.call(this)}return proxy},getState:function(name){return!!states[name]},setState:function(name,active){if(!_.isString(name)||_.isEmpty(name))throw new TypeError("The state must have a name");return states[name]=!!active,this},getTestData:function(){
return testData},setTestData:function(data){return testData=data,this},getTestContext:function(){return testContext},setTestContext:function(context){return _.isPlainObject(context)&&(testContext=context),this},next:function(scope){return this.trigger("move","next",scope),this},previous:function(scope){return this.trigger("move","previous",scope),this},jump:function(position,scope){return this.trigger("move","jump",position,scope),this},skip:function(scope){return this.trigger("skip",scope),this},exit:function(why){return this.trigger("exit",why),this},pause:function(){return this.getState("pause")||this.setState("pause",!0).trigger("pause"),this},resume:function(){
return this.getState("pause")===!0&&this.setState("pause",!1).trigger("resume"),this}}),runner.on("move",function(type){this.trigger.apply(this,[type].concat([].slice.call(arguments,1)))}),runner}return providerRegistry(testRunnerFactory,function(provider){if(!_.isFunction(provider.loadAreaBroker))throw new TypeError("The runner provider MUST have a method that returns an areaBroker");return!0})}),define("taoTests/runner/areaBroker",["jquery","lodash"],function($,_){"use strict";var requireAreas=["content","toolbox","navigation","control","header","panel"];return function($container,mapping){var broker,areas;if(("string"==typeof $container||$container instanceof HTMLElement)&&($container=$($container)),
!$container||!$container.length)throw new TypeError("Please provide the areaBroker a container");return broker={defineAreas:function(mapping){var keys,required;if(!_.isPlainObject(mapping))throw new TypeError("A mapping has the form of a plain object");if(keys=_.keys(mapping),required=_.all(requireAreas,function(val){return _.contains(keys,val)}),!required)throw new TypeError("You have to define a mapping for at least : "+requireAreas.join(", "));areas=mapping},getContainer:function(){return $container},getArea:function(name){if(!areas)throw new Error("Sorry areas have not been defined yet!");return areas[name]}},broker.defineAreas(mapping),_.forEach(requireAreas,function(area){
broker["get"+area[0].toUpperCase()+area.slice(1)+"Area"]=_.bind(_.partial(broker.getArea,area),broker)}),broker}}),define("taoTests/runner/proxyRegistry",["lodash"],function(_){"use strict";function proxyRegistry(target,validator){var _proxies={},_registry={registerProxy:function(name,proxy){var valid;if(!_.isString(name)||!name.length)throw new TypeError("It is required to give a name to your test runner proxy!");if(!_.isPlainObject(proxy))throw new TypeError("A test runner proxy must be an object!");if(valid=_.all(_proxyApi,function(apiName){return _.isFunction(proxy[apiName])}),!valid)throw new TypeError("A test runner proxy must provide all required API!");
if(validator&&_.isFunction(validator)&&!validator(proxy))throw new TypeError("The test runner proxy is not valid!");return _proxies[name]=proxy,this},getProxy:function(name){var proxy;if(!_proxies||!_.size(_proxies))throw new Error("No test runner proxies registered");if(_.isString(name)&&name.length||(name=1===_.size(_proxies)?_.keys(_proxies)[0]:null),proxy=_proxies[name],!proxy)throw new Error("No test runner proxy found with name "+name);return proxy}};return _.assign(target||{},_registry)}var _proxyApi=["init","destroy","getTestData","getTestContext","getTestMap","callTestAction","getItemData","getItemState","submitItemState","storeItemResponse","callItemAction"];
return proxyRegistry}),define("taoTests/runner/proxy",["lodash","core/eventifier","taoTests/runner/proxyRegistry"],function(_,eventifier,proxyRegistry){"use strict";function proxyFactory(proxyName,config){function delegate(fnName,args){var promise;if(!proxyAdapter)throw new Error("There is no proxy adapter!");if(!_.isFunction(proxyAdapter[fnName]))throw new Error("There is no method called "+fnName+" in the proxy adapter!");return args=args?_slice.call(args):[],promise=proxyAdapter[fnName].apply(proxy,args),proxy.trigger.apply(proxy,[fnName,promise].concat(args)),promise}var proxyAdapter=proxyFactory.getProxy(proxyName),initConfig=_.defaults(config||{},_defaults),proxy=eventifier({
init:function(){return delegate("init",[initConfig])},destroy:function(){return delegate("destroy")},getTestData:function(){return delegate("getTestData")},getTestContext:function(){return delegate("getTestContext")},getTestMap:function(){return delegate("getTestMap")},callTestAction:function(action,params){return delegate("callTestAction",[action,params])},getItemData:function(uri){return delegate("getItemData",[uri])},getItemState:function(uri){return delegate("getItemState",[uri])},submitItemState:function(uri,state){return delegate("submitItemState",[uri,state])},storeItemResponse:function(uri,response){return delegate("storeItemResponse",[uri,response])},
callItemAction:function(uri,action,params){return delegate("callItemAction",[uri,action,params])}});return proxy}var _defaults={},_slice=[].slice;return proxyRegistry(proxyFactory)}),define("taoItems/assets/manager",["lodash","util/url"],function(_,urlUtil){"use strict";var assetManagerFactory=function(strategies,data,options){var cache={};strategies=_.isArray(strategies)?strategies:[strategies],data=data||{},options=_.defaults(options||{},{parseUrl:!0});var assetManager={_strategies:[],addStrategy:function(strategy){if(!_.isPlainObject(strategy)||!_.isFunction(strategy.handle)||!_.isString(strategy.name))throw new TypeError("An asset resolution strategy is an object with a handle method and a name");
this._strategies.push(strategy)},setStrategies:function(newStrategies){var self=this;this._strategies=[],_.forEach(newStrategies,function(strategy){_.isPlainObject(strategy)?assetManager.addStrategy(strategy):_.isFunction(strategy)&&self.addStrategy({name:"strategy_"+(self._strategies.length+1),handle:strategy})})},setData:function(key,value){_.isString(key)&&"undefined"!=typeof value?data[key]=value:_.isPlainObject(key)&&(data=key)},getData:function(key){return _.isString(key)?data[key]:data},resolve:function(url){var resolved,inputUrl;return options.cache&&cache.hasOwnProperty(url)?cache[url]:(inputUrl=options.parseUrl?urlUtil.parse(url):url,_.forEach(this._strategies,function(strategy){
var result=strategy.handle(inputUrl,data);return result?(resolved=result,!1):void 0}),resolved=resolved||"",options.cache&&(cache[url]=resolved),resolved)},resolveBy:function(name,url){var inputUrl,resolved="",strategy=_.find(this._strategies,{name:name});return strategy&&(inputUrl=options.parseUrl?urlUtil.parse(url):url,resolved=strategy.handle(inputUrl,data)),resolved},clearCache:function(){options.cache&&(cache={})}};return assetManager.setStrategies(strategies),assetManager};return assetManagerFactory}),define("taoItems/runner/api/itemRunner",["jquery","lodash","taoItems/assets/manager"],function($,_,assetManagerFactory){"use strict";var itemRunnerFactory=function itemRunnerFactory(providerName,data,options){
var ItemRunner,provider,providers,assetManager,events={},flow={init:{done:!1,pending:[]},render:{done:!1,pending:[]}};if(_.isPlainObject(providerName)&&(data=providerName,providerName=void 0),data=data||{},options=options||{},providers=itemRunnerFactory.providers,!providers||0===_.size(providers))throw new Error("No provider regitered");if(_.isString(providerName)&&providerName.length>0?provider=providers[providerName]:1===_.size(providers)&&(providerName=_.keys(providers)[0],provider=providers[providerName]),!provider)throw new Error("No candidate found for the provider");return assetManager=options.assetManager||assetManagerFactory(function(url){return url.toString();
}),ItemRunner={container:null,assetManager:assetManager,options:options,init:function(newData){var self=this,initDone=function(){flow.init.done===!1&&(flow.init.done=!0,_.forEach(flow.init.pending,function(pendingTask){_.isFunction(pendingTask)&&pendingTask.call(self)}),flow.init.pending=[]),self.trigger("init")};return newData&&(data=_.merge(data,newData)),_.isFunction(provider.init)?provider.init.call(this,data,initDone):initDone(),this},assets:function(strategies,data,options){try{this.assetManager=assetManagerFactory(strategies,data,options)}catch(err){this.trigger("error","Something was wrong while configuring the asset manager : "+err)}return this},render:function(elt){
var self=this,renderDone=function(){flow.render.done===!1&&(flow.render.done=!0,_.forEach(flow.render.pending,function(pendingTask){_.isFunction(pendingTask)&&pendingTask.call(self)}),flow.render.pending=[]),self.trigger("render"),self.trigger("ready")};return elt instanceof HTMLElement||elt instanceof $?(flow.init.done===!1?flow.init.pending.push(function(){this.render(elt)}):(elt instanceof $?this.container=elt.get(0):this.container=elt,_.isFunction(provider.render)?provider.render.call(this,this.container,renderDone):renderDone()),this):self.trigger("error","A valid HTMLElement (or a jquery element) at least is required to render the item")},clear:function(){
var self=this,clearDone=function(){self.trigger("clear")};return _.isFunction(provider.clear)?provider.clear.call(this,this.container,clearDone):clearDone(),this},getState:function(){var state=null;return _.isFunction(provider.getState)&&(state=provider.getState.call(this)),state},setState:function(state){return _.isPlainObject(state)?(flow.render.done===!1?flow.render.pending.push(function(){this.setState(state)}):_.isFunction(provider.setState)&&provider.setState.call(this,state),this):this.trigger("error","The item's state must be a JavaScript Plain Object: "+typeof state+" given")},getResponses:function(){var responses={};return _.isFunction(provider.getResponses)&&(responses=provider.getResponses.call(this)),
responses},on:function(name,handler){return _.isString(name)&&_.isFunction(handler)&&(events[name]=events[name]||[],events[name].push(handler)),this},off:function(name){return _.isString(name)&&(events[name]=[]),this},trigger:function(name,data){var self=this;return _.isString(name)&&_.isArray(events[name])&&_.forEach(events[name],function(event){event.call(self,data)}),this}}};return itemRunnerFactory.register=function(name,provider){if(!_.isString(name)||name.length<=0)throw new TypeError("It is required to give a name to your provider.");if(!_.isPlainObject(provider)||!_.isFunction(provider.init)&&!_.isFunction(provider.render))throw new TypeError("A provider is an object that contains at least an init function or a render function.");
this.providers=this.providers||{},this.providers[name]=provider},itemRunnerFactory}),define("taoQtiItem/qtiItem/core/qtiClasses",[],function(){return{_container:"taoQtiItem/qtiItem/core/Container",assessmentItem:"taoQtiItem/qtiItem/core/Item",responseProcessing:"taoQtiItem/qtiItem/core/ResponseProcessing",_simpleFeedbackRule:"taoQtiItem/qtiItem/core/response/SimpleFeedbackRule",stylesheet:"taoQtiItem/qtiItem/core/Stylesheet",math:"taoQtiItem/qtiItem/core/Math",img:"taoQtiItem/qtiItem/core/Img",object:"taoQtiItem/qtiItem/core/Object",outcomeDeclaration:"taoQtiItem/qtiItem/core/variables/OutcomeDeclaration",responseDeclaration:"taoQtiItem/qtiItem/core/variables/ResponseDeclaration",
rubricBlock:"taoQtiItem/qtiItem/core/RubricBlock",associableHotspot:"taoQtiItem/qtiItem/core/choices/AssociableHotspot",gap:"taoQtiItem/qtiItem/core/choices/Gap",gapImg:"taoQtiItem/qtiItem/core/choices/GapImg",gapText:"taoQtiItem/qtiItem/core/choices/GapText",hotspotChoice:"taoQtiItem/qtiItem/core/choices/HotspotChoice",hottext:"taoQtiItem/qtiItem/core/choices/Hottext",inlineChoice:"taoQtiItem/qtiItem/core/choices/InlineChoice",simpleAssociableChoice:"taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice",simpleChoice:"taoQtiItem/qtiItem/core/choices/SimpleChoice",associateInteraction:"taoQtiItem/qtiItem/core/interactions/AssociateInteraction",choiceInteraction:"taoQtiItem/qtiItem/core/interactions/ChoiceInteraction",
endAttemptInteraction:"taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction",extendedTextInteraction:"taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction",gapMatchInteraction:"taoQtiItem/qtiItem/core/interactions/GapMatchInteraction",graphicAssociateInteraction:"taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction",graphicOrderInteraction:"taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction",hotspotInteraction:"taoQtiItem/qtiItem/core/interactions/HotspotInteraction",hottextInteraction:"taoQtiItem/qtiItem/core/interactions/HottextInteraction",
inlineChoiceInteraction:"taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction",matchInteraction:"taoQtiItem/qtiItem/core/interactions/MatchInteraction",mediaInteraction:"taoQtiItem/qtiItem/core/interactions/MediaInteraction",orderInteraction:"taoQtiItem/qtiItem/core/interactions/OrderInteraction",prompt:"taoQtiItem/qtiItem/core/interactions/Prompt",selectPointInteraction:"taoQtiItem/qtiItem/core/interactions/SelectPointInteraction",sliderInteraction:"taoQtiItem/qtiItem/core/interactions/SliderInteraction",textEntryInteraction:"taoQtiItem/qtiItem/core/interactions/TextEntryInteraction",uploadInteraction:"taoQtiItem/qtiItem/core/interactions/UploadInteraction",
feedbackBlock:"taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock",feedbackInline:"taoQtiItem/qtiItem/core/feedbacks/FeedbackInline",modalFeedback:"taoQtiItem/qtiItem/core/feedbacks/ModalFeedback",customInteraction:"taoQtiItem/qtiItem/core/interactions/CustomInteraction",infoControl:"taoQtiItem/qtiItem/core/PortableInfoControl",include:"taoQtiItem/qtiItem/core/Include"}}),define("taoQtiItem/qtiItem/helper/util",["lodash"],function(_){"use strict";var util={buildSerial:function(prefix){for(var id=prefix||"",chars="abcdefghijklmnopqrstuvwxyz0123456789",i=0;22>i;i++)id+=chars.charAt(Math.floor(Math.random()*chars.length));return id},buildId:function(item,prefix){var id,usedIds,i=1,suffix="",exists=!1;
if(!item)throw new TypeError("A item is required to generate a unique identifier");usedIds=item.getUsedIds();do exists=!1,id=prefix+suffix,_.contains(usedIds,id)&&(exists=!0,suffix="_"+i,i++);while(exists);return id},buildIdentifier:function(item,prefix,useSuffix){var id,usedIds,suffix="",i=1,exists=!1;if(!item)throw new TypeError("A item is required to generate a unique identifier");usedIds=item.getUsedIdentifiers(),useSuffix=_.isUndefined(useSuffix)?!0:useSuffix,prefix?(prefix=prefix.replace(/_[0-9]+$/gi,"_").replace(/[^a-zA-Z0-9_]/gi,"_").replace(/(_)+/gi,"_"),useSuffix&&(suffix="_"+i)):(prefix=this.qtiClass,suffix="_"+i);do exists=!1,id=prefix+suffix,usedIds[id]&&(exists=!0,
suffix="_"+i,i++);while(exists);return id},findInCollection:function(element,collectionNames,searchedSerial){var found=null;if(_.isString(collectionNames)&&(collectionNames=[collectionNames]),!_.isArray(collectionNames))throw new Error("invalid argument : collectionNames must be an array or a string");return _.each(collectionNames,function(collectionName){var collection=element;_.each(collectionName.split("."),function(nameToken){collection=collection[nameToken]});var elt=collection[searchedSerial];return elt?(found={parent:element,element:elt},!1):(_.each(collection,function(elt){return _.isFunction(elt.find)&&(found=elt.find(searchedSerial))?!1:void 0}),found?!1:void 0);
}),found},addMarkupNamespace:function(markup,ns){return ns?markup=markup.replace(/<(\/)?([a-z:]+)(\s?)([^><]*)>/g,function($0,$1,$2,$3,$4){return $2.indexOf(":")>0?$0:($1=$1||"",$3=$3||"","<"+$1+ns+":"+$2+$3+$4+">")}):markup},removeMarkupNamespaces:function(markup){return markup.replace(/<(\/)?(\w*):([^>]*)>/g,"<$1$3>")},getMarkupUsedNamespaces:function(markup){var namespaces=[];return markup.replace(/<(\/)?(\w*):([^>]*)>/g,function(original,slash,ns,node){return namespaces.push(ns),"<"+slash+node+">"}),_.uniq(namespaces)}};return util}),define("taoQtiItem/qtiItem/helper/rendererConfig",["lodash","jquery"],function(_,$){var rendererConfigHelper={};return rendererConfigHelper.getOptionsFromArguments=function(args){
var options={data:{},placeholder:null,subclass:"",renderer:null};return _.each(args,function(arg){arg&&(arg.isRenderer?options.renderer=arg:arg instanceof $&&arg.length?options.placeholder=arg:_.isString(arg)?options.subclass=arg:_.isPlainObject(arg)?options.data=arg:console.log("invalid arg",arg,args))}),options},rendererConfigHelper}),define("taoQtiItem/qtiItem/core/Element",["jquery","lodash","class","taoQtiItem/qtiItem/helper/util","taoQtiItem/qtiItem/helper/rendererConfig"],function($,_,Class,util,rendererConfig){"use strict";var _instances={},Element=Class.extend({qtiClass:"",serial:"",relatedItem:null,init:function(serial,attributes){if(this.attributes={},
this.metaData={},"object"==typeof serial&&(attributes=serial,serial=""),serial||(serial=util.buildSerial(this.qtiClass+"_")),serial&&("string"!=typeof serial||!serial.match(/^[a-z_0-9]*$/i)))throw"invalid QTI serial : ("+typeof serial+") "+serial;if(_instances[serial])throw"a QTI Element with the same serial already exists "+serial;_instances[serial]=this,this.serial=serial,this.setAttributes(attributes||{}),"function"==typeof this.initContainer&&this.initContainer(arguments[2]||""),"function"==typeof this.initObject&&this.initObject()},is:function(qtiClass){return qtiClass===this.qtiClass},placeholder:function(){return"{{"+this.serial+"}}"},getSerial:function(){
return this.serial},getUsedIdentifiers:function(){var usedIds={},elts=this.getComposingElements();for(var i in elts){var elt=elts[i],id=elt.attr("identifier");id&&(usedIds[id]=elt)}return usedIds},getUsedIds:function(){var usedIds=[];return _.forEach(this.getComposingElements(),function(elt){var id=elt.attr("id");id&&!_.contains(usedIds,id)&&usedIds.push(id)}),usedIds},attr:function(name,value){if(name)if(void 0!==value)this.attributes[name]=value;else if("object"==typeof name)for(var prop in name)this.attr(prop,name[prop]);else if("string"==typeof name)return void 0===this.attributes[name]?void 0:this.attributes[name];return this},data:function(name,value){if(name)if(void 0!==value)this.metaData[name]=value,
$(document).trigger("metaChange.qti-widget",{element:this,key:name,value:value});else if("object"==typeof name)for(var prop in name)this.data(prop,name[prop]);else if("string"==typeof name)return void 0===this.metaData[name]?void 0:this.metaData[name];return this},removeData:function(name){return delete this.metaData[name],this},removeAttr:function(name){return this.removeAttributes(name)},setAttributes:function(attributes){return this.attributes=attributes,this},getAttributes:function(){return _.clone(this.attributes)},removeAttributes:function(attrNames){"string"==typeof attrNames&&(attrNames=[attrNames]);for(var i in attrNames)delete this.attributes[attrNames[i]];
return this},getComposingElements:function(){function append(element){elts[element.getSerial()]=element,elts=_.extend(elts,element.getComposingElements())}var elts={};return"function"==typeof this.initContainer&&append(this.getBody()),"function"==typeof this.initObject&&append(this.getObject()),_.each(this.metaData,function(v){Element.isA(v,"_container")?append(v):_.isArray(v)&&_.each(v,function(v){Element.isA(v,"_container")&&append(v)})}),elts},getUsedClasses:function(){var ret=[this.qtiClass],composingElts=this.getComposingElements();return _.each(composingElts,function(elt){ret.push(elt.qtiClass)}),_.uniq(ret)},find:function(serial){var found=null;if("function"==typeof this.initObject){
var object=this.getObject();object.serial===serial&&(found={parent:this,element:object,location:"object"})}return found||"function"!=typeof this.initContainer||(found=this.getBody().find(serial,this)),found},parent:function(){var item=this.getRelatedItem();if(item){var found=item.find(this.getSerial());if(found)return found.parent}return null},setRelatedItem:function(item,recursive){if(recursive="undefined"==typeof recursive?!0:recursive,Element.isA(item,"assessmentItem")){this.relatedItem=item;var composingElts=this.getComposingElements();for(var i in composingElts)composingElts[i].setRelatedItem(item,!1)}},getRelatedItem:function(){var ret=null;return Element.isA(this.relatedItem,"assessmentItem")&&(ret=this.relatedItem),
ret},setRenderer:function(renderer){if(!renderer||!renderer.isRenderer)throw"invalid qti rendering engine";this.renderer=renderer;var elts=this.getComposingElements();for(var serial in elts)elts[serial].setRenderer(renderer)},getRenderer:function(){return this.renderer},render:function(){var args=rendererConfig.getOptionsFromArguments(arguments),_renderer=args.renderer||this.getRenderer(),tplData={},defaultData={tag:this.qtiClass,serial:this.serial,attributes:this.getAttributes()};if(!_renderer)throw"render: no renderer found for the element "+this.qtiClass+":"+this.serial;"function"==typeof this.initContainer&&(defaultData.body=this.getBody().render(args.renderer)),
"function"==typeof this.initObject&&(defaultData.object={attributes:this.object.getAttributes()},defaultData.object.attributes.data=_renderer.resolveUrl(this.object.attr("data"))),tplData=_.merge(defaultData,args.data||{}),tplData=_renderer.getData(this,tplData,args.subclass);var rendering=_renderer.renderTpl(this,tplData,args.subclass);return args.placeholder&&args.placeholder.replaceWith(rendering),rendering},postRender:function(data,altClassName,renderer){var postRenderers=[],_renderer=renderer||this.getRenderer();if("function"==typeof this.initContainer&&(postRenderers=this.getBody().postRender({},"",renderer)),!_renderer)throw"postRender: no renderer found for the element "+this.qtiClass+":"+this.serial;
return postRenderers.push(_renderer.postRender(this,data,altClassName)),_.compact(postRenderers)},getContainer:function($scope,subclass){var renderer=this.getRenderer();if(renderer)return renderer.getContainer(this,$scope,subclass);throw"getContainer: no renderer found for the element "+this.qtiClass+":"+this.serial},toArray:function(){var arr={serial:this.serial,type:this.qtiClass,attributes:this.getAttributes()};return"function"==typeof this.initContainer&&(arr.body=this.getBody().toArray()),"function"==typeof this.initObject&&(arr.object=this.object.toArray()),arr},isEmpty:function(){return!1},addClass:function(className){var clazz=this.attr("class")||"";_containClass(clazz,className)||this.attr("class",clazz+(clazz.length?" ":"")+className);
},hasClass:function(className){return _containClass(this.attr("class"),className)},removeClass:function(className){var clazz=this.attr("class")||"";if(clazz){var regex=new RegExp("(?:^|\\s)"+className+"(?:\\s|$)");clazz=clazz.replace(regex," ").trim(),clazz?this.attr("class",clazz):this.removeAttr("class")}},toggleClass:function(className,state){return"boolean"==typeof state?state?this.addClass(className):this.removeClass(className):this.hasClass(className)?this.removeClass(className):this.addClass(className)},isset:function(){return Element.issetElement(this.serial)},unset:function(){return Element.unsetElement(this.serial)}}),_containClass=function(allClassStr,className){
var regex=new RegExp("(?:^|\\s)"+className+"(?:\\s|$)","");return allClassStr&&regex.test(allClassStr)};return Element.isA=function(qtiElement,qtiClass){return qtiElement instanceof Element&&qtiElement.is(qtiClass)},Element.getElementBySerial=function(serial){return _instances[serial]},Element.issetElement=function(serial){return!!_instances[serial]},Element.unsetElement=function(serial){var element=Element.getElementBySerial(serial);if(element){var composingElements=element.getComposingElements();return _.each(composingElements,function(elt){delete _instances[elt.serial]}),delete _instances[element.serial],!0}return!1},Element}),define("taoQtiItem/qtiItem/core/Loader",["lodash","class","taoQtiItem/qtiItem/core/qtiClasses","taoQtiItem/qtiItem/core/Element"],function(_,Class,qtiClasses,Element){
function loadPortableCustomElementData(portableElement,data){portableElement.typeIdentifier=data.typeIdentifier,portableElement.markup=data.markup,portableElement.entryPoint=data.entryPoint,portableElement.properties=data.properties,portableElement.libraries=data.libraries}var Loader=Class.extend({init:function(item,classesLocation){this.qti={},this.classesLocation={},this.item=item||null,this.setClassesLocation(classesLocation||qtiClasses)},setClassesLocation:function(qtiClasses){return _.extend(this.classesLocation,qtiClasses),this},getRequiredClasses:function(data){var ret=[];for(var i in data)"qtiClass"===i&&"_container"!==data[i]&&"relatedItem"!==i?ret.push(data[i]):"object"==typeof data[i]&&"responseRules"!==i&&(ret=_.union(ret,this.getRequiredClasses(data[i])));
return ret},loadRequiredClasses:function(data,callback,reload){var requiredClasses=this.getRequiredClasses(data,reload),required=[];for(var i in requiredClasses){var requiredClass=requiredClasses[i];if(!this.classesLocation[requiredClass])throw new Error("missing qti class location declaration : "+requiredClass);required.push(this.classesLocation[requiredClass])}var _this=this;require(required,function(){_.each(arguments,function(QtiClass){_this.qti[QtiClass.prototype.qtiClass]=QtiClass}),callback.call(_this,_this.qti)})},getLoadedClasses:function(){return _.keys(this.qti)},loadItemData:function(data,callback){var _this=this;_this.loadRequiredClasses(data,function(Qti){
var i;if("object"==typeof data&&"assessmentItem"===data.qtiClass){data.serial&&Element.unsetElement(data.serial),_this.item=new Qti.assessmentItem(data.serial,data.attributes||{}),_this.loadContainer(_this.item.getBody(),data.body);for(i in data.outcomes){var outcome=_this.buildOutcome(data.outcomes[i]);outcome&&_this.item.addOutcomeDeclaration(outcome)}for(i in data.feedbacks){var feedback=_this.buildElement(data.feedbacks[i]);feedback&&_this.item.addModalFeedback(feedback)}for(i in data.stylesheets){var stylesheet=_this.buildElement(data.stylesheets[i]);stylesheet&&_this.item.addStylesheet(stylesheet)}for(i in data.responses){var response=_this.buildResponse(data.responses[i]);
if(response){_this.item.addResponseDeclaration(response);var feedbackRules=data.responses[i].feedbackRules;feedbackRules&&_.forIn(feedbackRules,function(fbData,serial){response.feedbackRules[serial]=_this.buildSimpleFeedbackRule(fbData,response)})}}data.responseProcessing&&_this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing)),_this.item.setNamespaces(data.namespaces)}"function"==typeof callback&&callback.call(_this,_this.item)})},loadAndBuildElement:function(data,callback){var _this=this;_this.loadRequiredClasses(data,function(Qti){var element=_this.buildElement(data);"function"==typeof callback&&callback.call(_this,element);
})},loadElement:function(element,data,callback){var _this=this;this.loadRequiredClasses(data,function(){_this.loadElementData(element,data),"function"==typeof callback&&callback.call(_this,element)})},loadElements:function(data,callback){var _this=this;if(!_this.item)throw"QtiLoader : cannot load elements in empty item";this.loadRequiredClasses(data,function(){var allElements=_this.item.getComposingElements();for(var i in data){var elementData=data[i];elementData&&elementData.qtiClass&&elementData.serial&&allElements[elementData.serial]&&_this.loadElementData(allElements[elementData.serial],elementData)}"function"==typeof callback&&callback.call(_this,_this.item);
})},buildResponse:function(data){var response=this.buildElement(data);return response.template=data.howMatch||null,response.defaultValue=data.defaultValue||null,response.correctResponse=data.correctResponses||null,_.size(data.mapping)?response.mapEntries=data.mapping:_.size(data.areaMapping)?response.mapEntries=data.areaMapping:response.mapEntries={},response.mappingAttributes=data.mappingAttributes||{},response},buildSimpleFeedbackRule:function(data,response){var feedbackRule=this.buildElement(data);data.condition&&(feedbackRule.condition=data.condition),data.comparedValue&&(feedbackRule.comparedValue=data.comparedValue),feedbackRule.comparedOutcome=this.item.responses[data.comparedOutcome]||null,
feedbackRule.feedbackOutcome=this.item.outcomes[data.feedbackOutcome]||null,feedbackRule.feedbackThen=this.item.modalFeedbacks[data.feedbackThen]||null,feedbackRule.feedbackElse=this.item.modalFeedbacks[data.feedbackElse]||null;var response=feedbackRule.comparedOutcome;return feedbackRule.feedbackThen&&feedbackRule.feedbackThen.data("relatedResponse",response),feedbackRule.feedbackElse&&feedbackRule.feedbackElse.data("relatedResponse",response),feedbackRule},buildOutcome:function(data){var outcome=this.buildElement(data);return outcome.defaultValue=data.defaultValue||null,outcome},buildResponseProcessing:function(data){var rp=this.buildElement(data);return data&&data.processingType&&("custom"===data.processingType?(rp.xml=data.data,
rp.processingType="custom"):rp.processingType="templateDriven"),rp},loadContainer:function(bodyObject,bodyData){if(!Element.isA(bodyObject,"_container"))throw"bodyObject must be a QTI Container";if(!bodyData||"string"!=typeof bodyData.body||"array"!=typeof bodyData.elements&&"object"!=typeof bodyData.elements)throw"wrong bodydata format";for(var serial in bodyData.elements){var eltData=bodyData.elements[serial],element=this.buildElement(eltData);element&&bodyObject.setElement(element,bodyData.body)}bodyObject.body(bodyData.body)},buildElement:function(elementData){var elt=null;if(!(elementData&&elementData.qtiClass&&elementData.serial))throw"wrong elementData format";
var className=elementData.qtiClass;if(!this.qti[className])throw"the qti element class does not exist: "+className;return elt=new this.qti[className](elementData.serial),this.loadElementData(elt,elementData),elt},loadElementData:function(element,data){var attributes=_.defaults(data.attributes||{},element.attributes||{});return element.setAttributes(attributes),element.body&&data.body&&element.bdy&&this.loadContainer(element.getBody(),data.body),element.object&&data.object&&element.object&&this.loadObjectData(element.object,data.object),Element.isA(element,"interaction")?this.loadInteractionData(element,data):Element.isA(element,"choice")?this.loadChoiceData(element,data):Element.isA(element,"math")?this.loadMathData(element,data):Element.isA(element,"infoControl")&&this.loadPicData(element,data),
element},loadInteractionData:function(interaction,data){Element.isA(interaction,"blockInteraction")&&data.prompt&&this.loadContainer(interaction.prompt.getBody(),data.prompt),this.buildInteractionChoices(interaction,data),Element.isA(interaction,"customInteraction")&&this.loadPciData(interaction,data)},buildInteractionChoices:function(interaction,data){if(data.choices){if(Element.isA(interaction,"matchInteraction"))for(var set=0;2>set;set++){if(!data.choices[set])throw"missing match set #"+set;var matchSet=data.choices[set];for(var serial in matchSet){var choice=this.buildElement(matchSet[serial]);choice&&interaction.addChoice(choice,set)}}else for(var serial in data.choices){
var choice=this.buildElement(data.choices[serial]);choice&&interaction.addChoice(choice)}if(Element.isA(interaction,"graphicGapMatchInteraction")&&data.gapImgs)for(var serial in data.gapImgs){var gapImg=this.buildElement(data.gapImgs[serial]);gapImg&&interaction.addGapImg(gapImg)}}},loadChoiceData:function(choice,data){Element.isA(choice,"textVariableChoice")?choice.val(data.text):Element.isA(choice,"gapImg")||Element.isA(choice,"containerChoice")},loadObjectData:function(object,data){object.setAttributes(data.attributes),data._alt&&("object"===data._alt.qtiClass?object._alt=Loader.buildElement(data._alt):object._alt=data._alt)},loadMathData:function(math,data){
math.ns=data.ns||{},math.setMathML(data.mathML||""),_.forIn(data.annotations||{},function(value,encoding){math.setAnnotation(encoding,value)})},loadPciData:function(pci,data){loadPortableCustomElementData(pci,data)},loadPicData:function(pic,data){loadPortableCustomElementData(pic,data)}});return Loader}),define("taoQtiItem/qtiItem/helper/interactionHelper",["lodash","taoQtiItem/qtiItem/core/Element"],function(_,Element){return{convertChoices:function(choices,outputType){var ret=[],_this=this;return _.each(choices,function(c){if(Element.isA(c,"choice"))switch(outputType){case"serial":ret.push(c.getSerial());break;case"identifier":ret.push(c.id());break;default:
ret.push(c)}else _.isArray(c)&&ret.push(_this.convertChoices(c,outputType))}),ret},findChoices:function(interaction,choices,inputType){var ret=[],_this=this;return _.each(choices,function(c){var choice;_.isString(c)?"serial"===inputType?(choice=interaction.getChoice(c),choice&&ret.push(choice)):"identifier"===inputType?(choice=interaction.getChoiceByIdentifier(c),choice&&ret.push(choice)):ret.push(c):_.isArray(c)?ret.push(_this.findChoices(interaction,c,inputType)):ret.push(c)}),ret},shuffleChoices:function(choices){var r=[],f={},j=0;for(var i in choices){if(!Element.isA(choices[i],"choice"))throw"invalid element in array: is not a qti choice";var choice=choices[i];
choice.attr("fixed")&&(f[j]=choice),r.push(choice),j++}for(var n=0;n<r.length-1;n++)if(!f[n]){var k=-1;do k=n+Math.floor(Math.random()*(r.length-n));while(f[k]);var tmp=r[k];r[k]=r[n],r[n]=tmp}return r},serialToIdentifier:function(interaction,choiceSerial){var choice=interaction.getChoice(choiceSerial);return choice?choice.id():""}}}),define("taoQtiItem/qtiRunner/core/Renderer",["lodash","jquery","handlebars","core/promise","taoQtiItem/qtiItem/core/Element","taoQtiItem/qtiItem/helper/interactionHelper","ui/themeLoader"],function(_,$,Handlebars,Promise,Element,interactionHelper,themeLoader){"use strict";function getDocumentBaseUrl(){return window.location.protocol+"//"+window.location.host+window.location.pathname.replace(/([^\/]*)$/,"");
}var _isValidRenderer=function(renderer){var valid=!0;if("object"!=typeof renderer)return!1;var classCorrect=!1;if(renderer.qtiClass)if(_.indexOf(_renderableClasses,renderer.qtiClass)>=0)classCorrect=!0;else{var pos=renderer.qtiClass.indexOf(".");if(pos>0){var qtiClass=renderer.qtiClass.slice(0,pos),subClass=renderer.qtiClass.slice(pos+1);_renderableSubclasses[qtiClass]&&_.indexOf(_renderableSubclasses[qtiClass],subClass)>=0&&(classCorrect=!0)}}if(!classCorrect)throw valid=!1,new Error("invalid qti class name in renderer declaration : "+renderer.qtiClass);if(!renderer.template)throw valid=!1,new Error("missing template in renderer declaration : "+renderer.qtiClass);
return valid},_renderableClasses=["_container","assessmentItem","stylesheet","responseDeclaration","outcomeDeclaration","responseProcessing","_simpleFeedbackRule","img","math","object","modalFeedback","rubricBlock","associateInteraction","choiceInteraction","extendedTextInteraction","gapMatchInteraction","graphicAssociateInteraction","graphicGapMatchInteraction","graphicOrderInteraction","hotspotInteraction","hottextInteraction","inlineChoiceInteraction","matchInteraction","mediaInteraction","orderInteraction","selectPointInteraction","sliderInteraction","textEntryInteraction","uploadInteraction","endAttemptInteraction","customInteraction","prompt","associableHotspot","gap","gapImg","gapText","hotspotChoice","hottext","inlineChoice","simpleAssociableChoice","simpleChoice","infoControl","include"],_dependencies={
assessmentItem:["stylesheet","_container","prompt","modalFeedback"],rubricBlock:["_container"],associateInteraction:["simpleAssociableChoice"],choiceInteraction:["simpleChoice"],gapMatchInteraction:["gap","gapText"],graphicAssociateInteraction:["associableHotspot"],graphicGapMatchInteraction:["associableHotspot","gapImg"],graphicOrderInteraction:["hotspotChoice"],hotspotInteraction:["hotspotChoice"],hottextInteraction:["hottext"],inlineChoiceInteraction:["inlineChoice"],matchInteraction:["simpleAssociableChoice"],orderInteraction:["simpleChoice"]},_renderableSubclasses={simpleAssociableChoice:["associateInteraction","matchInteraction"],simpleChoice:["choiceInteraction","orderInteraction"]
},_defaults={shuffleChoices:!0},Renderer=function(options){var _locations={},_renderers={};options=_.defaults(options||{},_defaults),this.isRenderer=!0,this.name="",this.shuffledChoices=[];var _getClassRenderer=function(qtiClass){var ret=null;if(_renderers[qtiClass])ret=_renderers[qtiClass];else{var pos=qtiClass.indexOf(".");pos>0&&(qtiClass=qtiClass.slice(0,pos),_renderers[qtiClass]&&(ret=_renderers[qtiClass]))}return ret};this.setOption=function(key,value){return"string"==typeof key&&(options[key]=value),this},this.setOptions=function(opts){return options=_.extend(options,opts),this},this.getOption=function(key){return"string"==typeof key&&options[key]?options[key]:null;
},this.getAssetManager=function(){return options.assetManager},this.getThemeLoader=function(){return this.themeLoader},this.renderTpl=function(element,data,qtiSubclass){var res,ret="",qtiClass=qtiSubclass||element.qtiClass,renderer=_getClassRenderer(qtiClass),decorators=this.getOption("decorators");if(!renderer||!_.isFunction(renderer.template))throw new Error("no renderer template loaded under the class name : "+qtiClass);return _.isObject(decorators)&&_.isFunction(decorators.before)&&(res=decorators.before(element,qtiSubclass),_.isString(res)&&(ret+=res)),ret+=renderer.template(data),_.isObject(decorators)&&_.isFunction(decorators.after)&&(res=decorators.after(element,qtiSubclass),
_.isString(res)&&(ret+=res)),ret},this.getData=function(element,data,qtiSubclass){var ret=data,qtiClass=qtiSubclass||element.qtiClass,renderer=_getClassRenderer(qtiClass);return renderer&&"function"==typeof renderer.getData&&(ret=renderer.getData.call(this,element,data)),ret},this.renderDirect=function(tpl,data){return Handlebars.compile(tpl)(data)},this.getContainer=function(qtiElement,$scope,qtiSubclass){var ret=null,qtiClass=qtiSubclass||qtiElement.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer found for the class : "+qtiElement.qtiClass;return ret=renderer.getContainer(qtiElement,$scope)},this.postRender=function(qtiElement,data,qtiSubclass){
var qtiClass=qtiSubclass||qtiElement.qtiClass,renderer=_getClassRenderer(qtiClass);return renderer&&"function"==typeof renderer.render?renderer.render.call(this,qtiElement,data):void 0},this.setResponse=function(qtiInteraction,response,qtiSubclass){var ret=!1,qtiClass=qtiSubclass||qtiInteraction.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer registered under the name : "+qtiClass;if("function"==typeof renderer.setResponse){ret=renderer.setResponse.call(this,qtiInteraction,response);var $container=renderer.getContainer.call(this,qtiInteraction);$container instanceof $&&$container.length&&$container.trigger("responseSet",[qtiInteraction,response]);
}return ret},this.getResponse=function(qtiInteraction,qtiSubclass){var ret=!1,qtiClass=qtiSubclass||qtiInteraction.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer registered under the name : "+qtiClass;return"function"==typeof renderer.getResponse&&(ret=renderer.getResponse.call(this,qtiInteraction)),ret},this.resetResponse=function(qtiInteraction,qtiSubclass){var ret=!1,qtiClass=qtiSubclass||qtiInteraction.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer registered under the name : "+qtiClass;return"function"==typeof renderer.resetResponse&&(ret=renderer.resetResponse.call(this,qtiInteraction)),ret},this.getState=function(qtiInteraction,qtiSubclass){
var ret=!1,qtiClass=qtiSubclass||qtiInteraction.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer registered under the name : "+qtiClass;return ret=_.isFunction(renderer.getState)?renderer.getState.call(this,qtiInteraction):renderer.getResponse.call(this,qtiInteraction)},this.setState=function(qtiInteraction,state,qtiSubclass){var qtiClass=qtiSubclass||qtiInteraction.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer registered under the name : "+qtiClass;_.isFunction(renderer.setState)?renderer.setState.call(this,qtiInteraction,state):(renderer.resetResponse.call(this,qtiInteraction),renderer.setResponse.call(this,qtiInteraction,state));
},this.destroy=function(qtiInteraction,qtiSubclass){var ret=!1,qtiClass=qtiSubclass||qtiInteraction.qtiClass,renderer=_getClassRenderer(qtiClass);if(!renderer)throw"no renderer registered under the name : "+qtiClass;return _.isFunction(renderer.destroy)&&(ret=renderer.destroy.call(this,qtiInteraction)),ret},this.getLoadedRenderers=function(){return _renderers},this.register=function(renderersLocations){_.extend(_locations,renderersLocations)},this.load=function(callback,requiredClasses){var self=this,required=[];if(options.themes&&(options.themes.base=this.resolveUrl(options.themes.base),_.forEach(options.themes.available,function(theme,index){options.themes.available[index].path=self.resolveUrl(theme.path);
}),this.themeLoader=themeLoader(options.themes).load()),requiredClasses){if(!_.isArray(requiredClasses))throw new Error('invalid argument type: expected array for arg "requireClasses"');requiredClasses=_.intersection(requiredClasses,_renderableClasses),_.each(requiredClasses,function(reqClass){var deps=_dependencies[reqClass];deps&&(requiredClasses=_.union(requiredClasses,deps))}),_.forEach(requiredClasses,function(qtiClass){if(_renderableSubclasses[qtiClass]){var requiredSubClasses=_.intersection(requiredClasses,_renderableSubclasses[qtiClass]);_.each(requiredSubClasses,function(subclass){if(_locations[qtiClass+"."+subclass])required.push(_locations[qtiClass+"."+subclass]);else{
if(!_locations[qtiClass])throw new Error(self.name+" : missing qti class location declaration: "+qtiClass+", subclass: "+subclass);required.push(_locations[qtiClass])}})}else if(_locations[qtiClass]===!1)_renderers[qtiClass]=!1;else{if(!_locations[qtiClass])throw new Error(self.name+" : missing qti class location declaration: "+qtiClass);required.push(_locations[qtiClass])}})}else required=_.values(_locations);var _this=this;return require(required,function(){_.each(arguments,function(clazz){_isValidRenderer(clazz)&&(_renderers[clazz.qtiClass]=clazz)}),"function"==typeof callback&&callback.call(_this,_renderers)}),this},this.unload=function(){return this.themeLoader&&themeLoader(options.themes).unload(),
this},this.setShuffledChoices=function(interaction,choices,identificationType){Element.isA(interaction,"interaction")&&(this.shuffledChoices[interaction.getSerial()]=_.pluck(interactionHelper.findChoices(interaction,choices,identificationType),"serial"))},this.getShuffledChoices=function(interaction,reshuffle,returnedType){var serial,i,choices=[];if(Element.isA(interaction,"interaction")){if(serial=interaction.getSerial(),!this.shuffledChoices[serial]||reshuffle)if(Element.isA(interaction,"matchInteraction"))for(this.shuffledChoices[serial]=[],i=0;2>i;i++)choices[i]=interactionHelper.shuffleChoices(interaction.getChoices(i)),this.shuffledChoices[serial][i]=_.pluck(choices[i],"serial");else choices=interactionHelper.shuffleChoices(interaction.getChoices()),
this.shuffledChoices[serial]=_.pluck(choices,"serial");else Element.isA(interaction,"matchInteraction")?_.forEach(choices,function(choice,index){2>index&&_.forEach(this.shuffledChoices[serial][i],function(choiceSerial){choice.push(interaction.getChoice(choiceSerial))})}):_.forEach(this.shuffledChoices[serial],function(choiceSerial){choices.push(interaction.getChoice(choiceSerial))});return"serial"===returnedType||"identifier"===returnedType?interactionHelper.convertChoices(choices,returnedType):_.clone(choices)}return[]},this.getRenderers=function(){return _renderers},this.getLocations=function(){return _locations},this.resolveUrl=function(url){return options.assetManager?"string"==typeof url&&url.length>0?options.assetManager.resolve(url):void 0:url;
},this.getAbsoluteUrl=function(relUrl){if(console.warn("DEPRECATED used getAbsoluteUrl with ",arguments),this.getOption("userRelativeUrl"))return relUrl.replace(/^\.?\//,"");if(/^http(s)?:\/\//i.test(relUrl)||/^data:[^\/]+\/[^;]+(;charset=[\w]+)?;base64,/.test(relUrl))return relUrl;var absUrl="",runtimeLocations=this.getOption("runtimeLocations");if(runtimeLocations&&_.size(runtimeLocations)&&_.forIn(runtimeLocations,function(runtimeLocation,typeIdentifier){return 0===relUrl.indexOf(typeIdentifier)?(absUrl=relUrl.replace(typeIdentifier,runtimeLocation),!1):void 0}),absUrl)return absUrl;var baseUrl=this.getOption("baseUrl")||getDocumentBaseUrl();return baseUrl+relUrl;
}};return{build:function(renderersLocations,name,defaultOptions){var NewRenderer=function(){var options=_.isPlainObject(arguments[0])?arguments[0]:{};Renderer.apply(this),this.register(renderersLocations),this.name=name||"",this.setOptions(_.defaults(options,defaultOptions||{}))};return NewRenderer.prototype=Renderer.prototype,NewRenderer}}}),define("taoItems/assets/strategies",["util/url"],function(urlUtil){"use strict";var strategies={baseUrl:{name:"baseUrl",handle:function(url,data){return"string"==typeof data.baseUrl&&urlUtil.isRelative(url)?data.slashcat===!0?data.baseUrl.replace(/\/$/,"")+"/"+url.directory.replace(/^\.\//,"").replace(/^\//,"")+encodeURIComponent(url.file.replace(/^\.\//,"").replace(/^\//,"")):data.baseUrl+url.directory.replace(/^\.?\//,"")+encodeURIComponent(url.file.replace(/^\.?\//,"")):void 0;
}},external:{name:"external",handle:function(url,data){return urlUtil.isAbsolute(url)?url.toString():void 0}},base64:{name:"base64",handle:function(url){return urlUtil.isBase64(url)?url.toString():void 0}},taomedia:{name:"taomedia",handle:function(url,data){var baseUrl=data.baseUrl||"./";return"object"==typeof url&&"taomedia"===url.protocol||/^taomedia:\/\//.test(url.toString())?baseUrl+url.toString():void 0}}};return strategies}),define("taoQtiItem/qtiCommonRenderer/renderers/config",["lodash","context","ui/themes","taoItems/assets/manager","taoItems/assets/strategies"],function(_,context,themes,assetManagerFactory,assetStrategies){"use strict";var itemThemes=themes.get("items"),portableAssetStrategy={
name:"portableElementLocation",handle:function(url){return url.source===url.relative?window.location.pathname.replace(/([^\/]*)$/,"")+url.toString()+"/":void 0}},assetManager=assetManagerFactory([{name:"theme",handle:function(url){return itemThemes&&url.path&&(url.path===itemThemes.base||_.contains(_.pluck(itemThemes.available,"path"),url.path))?context.root_url+url.toString():void 0}},assetStrategies.taomedia,assetStrategies.external,assetStrategies.base64,assetStrategies.baseUrl,portableAssetStrategy],{baseUrl:""}),locations={assessmentItem:"taoQtiItem/qtiCommonRenderer/renderers/Item",_container:"taoQtiItem/qtiCommonRenderer/renderers/Container",_simpleFeedbackRule:!1,
stylesheet:"taoQtiItem/qtiCommonRenderer/renderers/Stylesheet",outcomeDeclaration:!1,responseDeclaration:!1,responseProcessing:!1,img:"taoQtiItem/qtiCommonRenderer/renderers/Img",math:"taoQtiItem/qtiCommonRenderer/renderers/Math",object:"taoQtiItem/qtiCommonRenderer/renderers/Object",rubricBlock:"taoQtiItem/qtiCommonRenderer/renderers/RubricBlock",modalFeedback:"taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback",prompt:"taoQtiItem/qtiCommonRenderer/renderers/interactions/Prompt",choiceInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction",extendedTextInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction",
orderInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction",associateInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction",matchInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction",textEntryInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction",sliderInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction",inlineChoiceInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction","simpleChoice.choiceInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction",
"simpleChoice.orderInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction",hottext:"taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext",gap:"taoQtiItem/qtiCommonRenderer/renderers/choices/Gap",gapText:"taoQtiItem/qtiCommonRenderer/renderers/choices/GapText","simpleAssociableChoice.matchInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction","simpleAssociableChoice.associateInteraction":"taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction",inlineChoice:"taoQtiItem/qtiCommonRenderer/renderers/choices/InlineChoice",hottextInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction",
hotspotInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction",hotspotChoice:!1,gapMatchInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction",selectPointInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction",graphicOrderInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction",mediaInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction",uploadInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction",graphicGapMatchInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction",
gapImg:"taoQtiItem/qtiCommonRenderer/renderers/choices/GapImg",graphicAssociateInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction",associableHotspot:!1,customInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction",infoControl:"taoQtiItem/qtiCommonRenderer/renderers/PortableInfoControl",include:"taoQtiItem/qtiCommonRenderer/renderers/Include",endAttemptInteraction:"taoQtiItem/qtiCommonRenderer/renderers/interactions/EndAttemptInteraction"};return{name:"commonRenderer",locations:locations,options:{assetManager:assetManager,themes:itemThemes}}}),define("taoQtiItem/qtiCommonRenderer/renderers/Renderer",["taoQtiItem/qtiRunner/core/Renderer","taoQtiItem/qtiCommonRenderer/renderers/config"],function(Renderer,config){
"use strict";return Renderer.build(config.locations,config.name,config.options)}),define("taoQtiItem/runner/provider/manager/picManager",["jquery","lodash","taoQtiItem/qtiItem/core/Element"],function($,_,Element){"use strict";var picManager={init:function(pic,item){return Element.isA(pic,"infoControl")&&(this._pic=pic),Element.isA(item,"assessmentItem")&&(this._item=item),this},getPic:function(){return this._pic},getItem:function(){return this._item},getSerial:function(){return this._pic&&this._pic.serial},getTypeIdentifier:function(){return this._pic&&this._pic.typeIdentifier},getDom:function(){if(!this._dom){var pic,tool,serial=this.getSerial();serial&&(pic=$('[data-serial="'+serial+'"]'),
pic.length&&(tool=$('[data-pic-serial="'+serial+'"]'),tool.length||(tool=pic.children().first()),this._dom={pic:pic,tool:tool,button:tool.find(".sts-button"),broken:pic.is(":empty")}))}return this._dom},enable:function(){var dom=this.getDom();return dom&&(dom.button.removeClass("disabled"),dom.tool.find(".sts-button-disable-mask").remove(),this.disabled=!1,this.trigger("enable")),this},disable:function(){var button,dom=this.getDom();return dom&&(button=dom.button.addClass("disabled"),$('<div class="sts-button-disable-mask" style="position:absolute;z-index:10000000000000"></div>').appendTo(dom.tool).offset(button.offset()).width(button.outerWidth()).height(button.outerHeight()),
dom.tool.find(".sts-container, .sts-menu-container").addClass("sts-hidden-container"),this.disabled=!0,this.trigger("disable")),this},show:function(){var dom=this.getDom();return dom&&(dom.tool.show(),this.trigger("show")),this},hide:function(){var dom=this.getDom();return dom&&(dom.tool.hide(),this.trigger("hide")),this},trigger:function(eventName){var dom=this.getDom(),args=_.rest(arguments,1);return args.unshift(this),dom&&(dom.tool.trigger(eventName,args),dom.broken&&dom.pic.trigger(eventName,args)),this}},picManagerCollection={init:function(item){return Element.isA(item,"assessmentItem")&&(this._item=item),this},getList:function(force){var self=this;return(force||!self._list)&&(self._map={},
self._list=[],self._item&&_.forEach(self._item.getElements(),function(element){var manager;Element.isA(element,"infoControl")&&(manager=managerFactory(element,self._item),self._list.push(manager),self._map[element.serial]=manager,self._map[element.typeIdentifier]=manager)})),this._list},getPic:function(picId){return this.getList(),this._map[picId]},execute:function(picId,action){var pic=this.getPic(picId);return pic&&pic[action]?pic[action].apply(pic,_.rest(arguments,2)):void 0},executeAll:function(action,filter){var cb,args=_.rest(arguments,2);return cb="function"==typeof filter?function(pic){filter.call(pic,pic)&&pic[action]&&pic[action].apply(pic,args)}:function(pic){
pic[action]&&pic[action].apply(pic,args)},this.each(cb)},each:function(cb){return _.forEach(this.getList(),cb),this},enablePic:function(picId){return this.execute(picId,"enable"),this},disablePic:function(picId){return this.execute(picId,"disable"),this},showPic:function(picId){return this.execute(picId,"show"),this},hidePic:function(picId){return this.execute(picId,"hide"),this},enableAll:function(filter){return this.executeAll("enable",filter),this},disableAll:function(filter){return this.executeAll("disable",filter),this},showAll:function(filter){return this.executeAll("show",filter),this},hideAll:function(filter){return this.executeAll("hide",filter),this;
}},managerFactory=function(pic,item){var manager=_.clone(picManager,!0);return manager.init(pic,item)},collectionFactory=function(item){var collection=_.clone(picManagerCollection,!0);return collection.init(item)};return{collection:collectionFactory,manager:managerFactory}}),define("taoQtiItem/runner/provider/qti",["jquery","lodash","context","core/promise","taoQtiItem/qtiItem/core/Loader","taoQtiItem/qtiItem/core/Element","taoQtiItem/qtiCommonRenderer/renderers/Renderer","taoQtiItem/runner/provider/manager/picManager","taoItems/assets/manager"],function($,_,context,Promise,QtiLoader,Element,QtiRenderer,picManager,assetManagerFactory){"use strict";var timeout=1e3*(context.timeout>0?context.timeout+1:30),qtiItemRuntimeProvider={
init:function(itemData,done){var self=this,rendererOptions={assetManager:this.assetManager};this.options.themes&&(rendererOptions.themes=this.options.themes),this._renderer=new QtiRenderer(rendererOptions),(new QtiLoader).loadItemData(itemData,function(item){return item?(self._item=item,void self._renderer.load(function(){self._item.setRenderer(this),done()},this.getLoadedClasses())):self.trigger("error","Unable to load item from the given data.")})},render:function(elt,done){var self=this;if(this._item){try{elt.innerHTML=this._item.render({})}catch(e){self.trigger("error","Error in template rendering : "+e.message)}try{Promise.race([Promise.all(this._item.postRender()),new Promise(function(resolve,reject){
_.delay(reject,timeout,new Error("Post rendering ran out of time."))})]).then(function(){$(elt).off("responseChange").on("responseChange",function(){self.trigger("statechange",self.getState()),self.trigger("responsechange",self.getResponses())}).off("endattempt").on("endattempt",function(e,responseIdentifier){self.trigger("endattempt",responseIdentifier||e.originalEvent.detail)}).off("themechange").on("themechange",function(e,themeName){var themeLoader=self._renderer.getThemeLoader();themeName=themeName||e.originalEvent.detail,themeLoader&&themeLoader.change(themeName)}),self.trigger("listpic",picManager.collection(self._item)),done()})["catch"](function(err){
self.trigger("error","Error in post rendering : "+err.message)})}catch(err){self.trigger("error","Error in post rendering : "+err.message)}}},clear:function(elt,done){this._item&&(_.invoke(this._item.getInteractions(),"clear"),this._item.clear(),$(elt).off("responseChange").off("endattempt").off("themechange").empty(),this._renderer&&this._renderer.unload()),done()},getState:function(){var state={};return this._item&&(_.forEach(this._item.getInteractions(),function(interaction){state[interaction.attr("responseIdentifier")]=interaction.getState()}),_.forEach(this._item.getElements(),function(element){Element.isA(element,"infoControl")&&element.attr("id")&&(state.pic=state.pic||{},
state.pic[element.attr("id")]=element.getState())})),state},setState:function(state){this._item&&state&&(_.forEach(this._item.getInteractions(),function(interaction){var id=interaction.attr("responseIdentifier");id&&state[id]&&interaction.setState(state[id])}),state.pic&&_.forEach(this._item.getElements(),function(element){Element.isA(element,"infoControl")&&state.pic[element.attr("id")]&&element.setState(state.pic[element.attr("id")])}))},getResponses:function(){var responses={};return this._item&&_.reduce(this._item.getInteractions(),function(res,interaction){return responses[interaction.attr("responseIdentifier")]=interaction.getResponse(),responses},responses),
responses}};return qtiItemRuntimeProvider}),define("taoQtiItem/runner/qtiItemRunner",["taoItems/runner/api/itemRunner","taoQtiItem/runner/provider/qti"],function(itemRunner,qtiRuntimeProvider){"use strict";return itemRunner.register("qti",qtiRuntimeProvider),itemRunner}),define("tpl!taoQtiTest/runner/provider/layout",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="";return buffer+='<div class="test-runner-scope">\n    <div class="action-bar content-action-bar horizontal-action-bar top-action-bar">\n\n        <div class="control-box">\n            \n        </div>\n    </div>\n\n    <main>\n\n        <!-- optional left sidebar -->\n        \n\n        <section class="content-wrapper">\n            <div id="qti-content"></div>\n        </section>\n\n\n        \n    </main>\n\n    <nav class="action-bar content-action-bar horizontal-action-bar bottom-action-bar">\n\n        <div class="control-box size-wrapper">\n            <div class="lft tools-box">\n                <ul class="plain tools-box-list"></ul>\n            </div>\n            <div class="rgt navi-box">\n                <ul class="plain navi-box-list">\n\n                \n                </ul>\n            </div>\n        </div>\n    </nav>\n</div>\n';
})}),define("taoQtiTest/runner/provider/qti",["jquery","lodash","core/promise","taoTests/runner/areaBroker","taoTests/runner/proxy","taoQtiItem/runner/qtiItemRunner","taoItems/assets/manager","taoItems/assets/strategies","tpl!taoQtiTest/runner/provider/layout"],function($,_,Promise,areaBroker,proxyFactory,qtiItemRunner,assetManagerFactory,assetStrategies,layoutTpl){"use strict";var states={initial:0,interacting:1,modalFeedback:2,suspended:3,closed:4},assetManager=assetManagerFactory([assetStrategies.external,assetStrategies.base64,assetStrategies.baseUrl],{baseUrl:""}),qtiProvider={name:"qti",loadAreaBroker:function(){var $layout=$(layoutTpl());return areaBroker($layout,{
content:$("#qti-content",$layout),toolbox:$(".tools-box",$layout),navigation:$(".navi-box-list",$layout),control:$(".top-action-bar .control-box",$layout),panel:$(".test-sidebar",$layout),header:$(".title-box",$layout)})},loadProxy:function(){var config=this.getConfig(),proxyConfig=_.pick(config,["testDefinition","testCompilation","serviceCallId","serviceController","serviceExtension"]);return proxyFactory("qtiServiceProxy",proxyConfig)},init:function(){var self=this,computeNext=function(action,params){var context=self.getTestContext();self.on("unloaditem."+action,function(){self.off("."+action),self.getProxy().callItemAction(context.itemUri,action,params).then(function(results){
self.setTestContext(results.testContext),load()})["catch"](function(err){self.trigger("error",err)})}).unloadItem(context.itemUri)},load=function(){var context=self.getTestContext();context.state<=states.interacting?self.loadItem(context.itemUri):context.state===states.closed&&self.finish()};return this.on("ready",function(){load()}).on("move",function(direction,scope,position){computeNext("move",{direction:direction,scope:scope||"item",position:position})}).on("skip",function(scope){computeNext("skip",{scope:scope||"item"})}),this.getProxy().init().then(function(results){self.setTestData(results.testData),self.setTestContext(results.testContext)})},render:function(){
var config=this.getConfig(),broker=this.getAreaBroker();config.renderTo.append(broker.getContainer())},loadItem:function(itemRef){var self=this;return new Promise(function(resolve,reject){Promise.all([self.getProxy().getItemData(itemRef),self.getProxy().getItemState(itemRef)]).then(function(results){resolve({data:results[0].itemData,baseUrl:results[0].baseUrl,state:results[1].itemState||{}})})["catch"](reject)})},renderItem:function(item){var self=this;return new Promise(function(resolve,reject){assetManager.setData("baseUrl",item.baseUrl),self.itemRunner=qtiItemRunner(item.data.type,item.data.data,{assetManager:assetManager}).on("error",reject).on("render",resolve).on("statechange",function(state){
console.log(state)}).on("responsechange",function(responses){console.log(responses)}).init().setState(item.state).render(self.getAreaBroker().getContentArea())})},unloadItem:function(itemRef){var self=this;return new Promise(function(resolve,reject){return self.itemRunner?void self.itemRunner.on("clear",resolve).clear():void resolve()})},finish:function(){return this.getProxy().callTestAction("finish")},destroy:function(){this.itemRunner=null}};return qtiProvider}),define("taoQtiTest/runner/config/qtiServiceConfig",["lodash","helpers"],function(_,helpers){"use strict";function getConfig(config){var storage={};return _.forEach(_entries,function(value,name){if("undefined"!=typeof config[name])storage[name]=config[name];else if(value)throw new Error('The config entry "'+name+'" is required!');
}),_.defaults(storage,_defaults)}function configFactory(config){var storage=getConfig(config);return{getTestDefinition:function(){return storage.testDefinition},getTestCompilation:function(){return storage.testCompilation},getServiceCallId:function(){return storage.serviceCallId},getServiceController:function(){return storage.serviceController},getServiceExtension:function(){return storage.serviceExtension},getTestActionUrl:function(action){return helpers._url(action,this.getServiceController(),this.getServiceExtension(),{testDefinition:this.getTestDefinition(),testCompilation:this.getTestCompilation(),serviceCallId:this.getServiceCallId()})},getItemActionUrl:function(uri,action){
return helpers._url(action,this.getServiceController(),this.getServiceExtension(),{testDefinition:this.getTestDefinition(),testCompilation:this.getTestCompilation(),testServiceCallId:this.getServiceCallId(),itemDefinition:uri})}}}var _defaults={serviceController:"Runner",serviceExtension:"taoQtiTest"},_entries={testDefinition:!0,testCompilation:!0,serviceCallId:!0,serviceController:!1,serviceExtension:!1};return configFactory}),define("taoQtiTest/runner/proxy/qtiServiceProxy",["jquery","lodash","core/promise","helpers","taoQtiTest/runner/config/qtiServiceConfig"],function($,_,Promise,helpers,configFactory){"use strict";function request(url,params){return new Promise(function(resolve,reject){
$.ajax({url:url,type:params?"POST":"GET",cache:!1,data:params,async:!0,dataType:"json"}).done(function(data){data&&data.success?resolve(data):reject(!1)}).fail(function(jqXHR){reject(jqXHR)})})}var qtiServiceProxy={init:function(config){var initConfig=config||{};return this.storage=configFactory(initConfig),request(this.storage.getTestActionUrl("init"))},destroy:function(){var self=this;return new Promise(function(resolve){self.storage=null,resolve()})},getTestData:function(){return request(this.storage.getTestActionUrl("getTestData"))},getTestContext:function(){return request(this.storage.getTestActionUrl("getTestContext"))},getTestMap:function(){return request(this.storage.getTestActionUrl("getTestMap"));
},callTestAction:function(action,params){return request(this.storage.getTestActionUrl(action),params)},getItemData:function(uri){return request(this.storage.getItemActionUrl(uri,"getItemData"))},getItemState:function(uri){return request(this.storage.getItemActionUrl(uri,"getItemState"))},submitItemState:function(uri,state){return request(this.storage.getItemActionUrl(uri,"submitItemState"),state)},storeItemResponse:function(uri,response){return request(this.storage.getItemActionUrl(uri,"storeItemResponse"),response)},callItemAction:function(uri,action,params){return request(this.storage.getItemActionUrl(uri,action),params)}};return qtiServiceProxy}),define("taoTests/runner/plugin",["lodash","core/promise"],function(_,Promise){
"use strict";function pluginFactory(provider,defaults){var pluginName;if(!_.isPlainObject(provider)||!_.isString(provider.name)||_.isEmpty(provider.name)||!_.isFunction(provider.init))throw new TypeError("A plugin should be defined at least by a name property and an init method");return pluginName=provider.name,defaults=defaults||{},function(runner,areaBroker,config){function delegate(fnName){var args=[].slice.call(arguments,1);return new Promise(function(resolve){return _.isFunction(provider[fnName])?resolve(provider[fnName].apply(plugin,args)):resolve()})}var plugin,states={};return config=_.defaults(config||{},defaults),plugin={init:function(){var self=this;
return states={},delegate("init").then(function(){self.setState("init",!0).trigger("init")})},render:function(){var self=this;return delegate("render").then(function(){self.setState("ready",!0).trigger("render").trigger("ready")})},finish:function(){var self=this;return delegate("finish").then(function(){self.setState("finish",!0).trigger("finish")})},destroy:function(){var self=this;return delegate("destroy").then(function(){config={},states={},self.setState("init",!1),self.trigger("destroy")})},trigger:function(name){var args=[].slice.call(arguments,1);return runner.trigger.apply(runner,["plugin-"+name+"."+pluginName,plugin].concat(args)),this},getTestRunner:function(){
return runner},getAreaBroker:function(){return areaBroker},getConfig:function(){return config},setConfig:function(name,value){return _.isPlainObject(name)?config=_.defaults(name,config):config[name]=value,this},getState:function(name){return!!states[name]},setState:function(name,active){if(!_.isString(name)||_.isEmpty(name))throw new TypeError("The state must have a name");return states[name]=!!active,this},show:function(){var self=this;return delegate("show").then(function(){self.setState("visible",!0).trigger("show")})},hide:function(){var self=this;return delegate("hide").then(function(){self.setState("visible",!1).trigger("hide")})},enable:function(){var self=this;
return delegate("enable").then(function(){self.setState("enabled",!0).trigger("enable")})},disable:function(){var self=this;return delegate("disable").then(function(){self.setState("enabled",!1).trigger("disable")})}}}}return pluginFactory}),define("tpl!taoQtiTest/runner/plugins/controls/title/title",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <span data-control="',(helper=helpers.control)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.control,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},
data:data}):helper),buffer+=escapeExpression(stack1)+'" class="qti-controls" title="',(helper=helpers.text)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.text,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',stack1=helpers.unless.call(depth0,null==data||data===!1?data:data.first,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),(helper=helpers.text)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.text,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),
buffer+=escapeExpression(stack1)+"</span>\n    "}function program2(depth0,data){return" - "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="title-box truncate">\n    ',stack1=helpers.each.call(depth0,depth0&&depth0.titles,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</div>\n"})}),define("taoQtiTest/runner/plugins/controls/title/title",["jquery","i18n","taoTests/runner/plugin","tpl!taoQtiTest/runner/plugins/controls/title/title"],function($,__,pluginFactory,titleTpl){
"use strict";return pluginFactory({name:"title",init:function(){var self=this,testRunner=this.getTestRunner(),testData=testRunner.getTestData(),createElement=function(){var context=testRunner.getTestContext(),titles=(!!context.isDeepestSectionVisible,[{control:"qti-test-title",text:testData.title}]);return context.isDeepestSectionVisible&&titles.push({control:"qti-test-position",text:context.sectionTitle}),$(titleTpl({titles:titles}))};this.$element=createElement(),testRunner.after("move",function(){self.$element=self.$element.replaceWith(createElement())})},render:function(){var $container=this.getAreaBroker().getControlArea();$container.append(this.$element);
}})}),define("taoQtiTest/testRunner/progressUpdater",["jquery","lodash","i18n","ui/progressbar"],function($,_,__){"use strict";var progressUpdaters={init:function(progressBar,progressLabel){return this.progressBar=$(progressBar).progressbar(),this.progressLabel=$(progressLabel),this},write:function(label,ratio){return this.progressLabel.text(label),this.progressBar.progressbar("value",ratio),this},update:function(testContext){var progressIndicator=testContext.progressIndicator||"percentage",progressIndicatorMethod=progressIndicator+"Progression",getProgression=this[progressIndicatorMethod]||this.percentageProgression,progression=getProgression&&getProgression(testContext)||{};
return this.write(progression.label,progression.ratio),progression},percentageProgression:function(testContext){var total=Math.max(1,testContext.numberItems),ratio=Math.floor(testContext.numberCompleted/total*100);return{ratio:ratio,label:ratio+"%"}},positionProgression:function(testContext){var progressScope=testContext.progressIndicatorScope,progressScopeCounter={test:{total:"numberItems",position:"itemPosition"},testPart:{total:"numberItemsPart",position:"itemPositionPart"},testSection:{total:"numberItemsSection",position:"itemPositionSection"}},counter=progressScopeCounter[progressScope]||progressScopeCounter.test,total=Math.max(1,testContext[counter.total]),position=testContext[counter.position]+1;
return{ratio:Math.floor(position/total*100),label:__("Item %d of %d",position,total)}}},progressUpdaterFactory=function(progressBar,progressLabel){var updater=_.clone(progressUpdaters,!0);return updater.init(progressBar,progressLabel)};return progressUpdaterFactory}),define("tpl!taoQtiTest/runner/plugins/controls/progressbar/progressbar",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="progress-box">\n    <div data-control="progress-bar" class="qti-controls progressbar info"></div>\n    <div data-control="progress-label" class="qti-controls"></div>\n</div>\n';
})}),define("taoQtiTest/runner/plugins/controls/progressbar/progressbar",["jquery","i18n","taoTests/runner/plugin","taoQtiTest/testRunner/progressUpdater","tpl!taoQtiTest/runner/plugins/controls/progressbar/progressbar"],function($,__,pluginFactory,progressUpdater,progressTpl){"use strict";return pluginFactory({name:"progressBar",init:function(){var self=this,testRunner=this.getTestRunner(),update=function(){self.progressUpdater&&self.progressUpdater.update(testRunner.getTestContext())};this.$element=$(progressTpl()),this.progressUpdater=progressUpdater($('[data-control="progress-bar"]',this.$element),$('[data-control="progress-label"]',this.$element)),update(),
testRunner.on("ready",update).on("loaditem",update)},render:function(){var $container=this.getAreaBroker().getControlArea();$container.append(this.$element)}})}),define("tpl!taoQtiTest/runner/plugins/navigation/button",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<li data-control="',(helper=helpers.control)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.control,stack1=typeof helper===functionType?helper.call(depth0,{
hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="small btn-info action" title="',(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    <a class="li-inner" href="#">\n        <span class="icon-',(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"></span>\n        <span class="text">',(helper=helpers.text)?stack1=helper.call(depth0,{
hash:{},data:data}):(helper=depth0&&depth0.text,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n    </a>\n</li>\n"})}),define("taoQtiTest/runner/plugins/navigation/next",["jquery","i18n","taoTests/runner/plugin","tpl!taoQtiTest/runner/plugins/navigation/button"],function($,__,pluginFactory,buttonTpl){"use strict";var buttonData={next:{control:"move-forward",title:__("Submit and go to the next item"),icon:"forward",text:__("Next")},end:{control:"move-end",title:__("Submit and go to the end of the test"),icon:"fast-forward",text:__("End test")}},createElement=function(context){var dataType=context.isLast?"end":"next";
return $(buttonTpl(buttonData[dataType]))},updateElement=function($element,context){var dataType=context.isLast?"end":"next";$element.data("control")!==buttonData[dataType].control&&($element.data("control",buttonData[dataType].control).attr("title",buttonData[dataType].title).find(".text").text(buttonData[dataType].text),"next"===dataType?$element.find(".icon-"+buttonData.end.icon).removeClass("icon-"+buttonData.end.icon).addClass("icon-"+buttonData.next.icon):$element.find(".icon-"+buttonData.next.icon).removeClass("icon-"+buttonData.next.icon).addClass("icon-"+buttonData.end.icon))};return pluginFactory({name:"next",init:function(){var self=this,testRunner=this.getTestRunner();
this.$element=createElement(testRunner.getTestContext()),this.$element.on("click",function(e){e.preventDefault(),self.getState("enabled")!==!1&&(self.disable(),testRunner.next())}),this.disable(),testRunner.on("loaditem",function(){updateElement(self.$element,testRunner.getTestContext())}).on("renderitem",function(){self.enable()}).on("unloaditem",function(){self.disable()})},render:function(){var $container=this.getAreaBroker().getNavigationArea();$container.append(this.$element)},destroy:function(){this.$element.remove()},enable:function(){this.$element.removeProp("disabled").removeClass("disabled")},disable:function(){this.$element.prop("disabled",!0).addClass("disabled");
},show:function(){this.$element.show()},hide:function(){this.$element.hide()}})}),define("taoQtiTest/runner/plugins/navigation/previous",["jquery","i18n","taoTests/runner/plugin","tpl!taoQtiTest/runner/plugins/navigation/button"],function($,__,pluginFactory,buttonTpl){"use strict";return pluginFactory({name:"previous",init:function(){var self=this,testRunner=this.getTestRunner(),toggle=function(){var context=testRunner.getTestContext();1===context.navigationMode&&context.canMoveBackward?self.show():self.hide()};this.$element=$(buttonTpl({control:"move-backward",title:__("Submit and go to the previous item"),icon:"backward",text:__("Previous")})),this.$element.on("click",function(e){
e.preventDefault(),self.getState("enabled")!==!1&&(self.disable(),testRunner.previous())}),toggle(),self.disable(),testRunner.on("loaditem",toggle).on("renderitem",function(){self.enable()}).on("unloaditem",function(){self.disable()})},render:function(){var $container=this.getAreaBroker().getNavigationArea();$container.append(this.$element)},destroy:function(){this.$element.remove()},enable:function(){this.$element.removeProp("disabled").removeClass("disabled")},disable:function(){this.$element.prop("disabled",!0).addClass("disabled")},show:function(){this.$element.show()},hide:function(){this.$element.hide()}})}),define("taoQtiTest/runner/plugins/navigation/nextSection",["jquery","i18n","taoTests/runner/plugin","tpl!taoQtiTest/runner/plugins/navigation/button"],function($,__,pluginFactory,buttonTpl){
"use strict";return pluginFactory({name:"nextsection",init:function(){var self=this,testRunner=this.getTestRunner(),toggle=function(){var context=testRunner.getTestContext();context.nextSection===!0?self.show():self.hide()};this.$element=$(buttonTpl({control:"next-section",title:__("Skip to the next section"),icon:"fast-forward",text:__("Next Section")})),this.$element.on("click",function(e){e.preventDefault(),self.getState("enabled")!==!1&&(self.disable(),testRunner.next("section"))}),toggle(),testRunner.on("ready",function(){self.enable()}).after("move",function(){toggle()})},render:function(){var $container=this.getAreaBroker().getNavigationArea();$container.append(this.$element);
},destroy:function(){this.$element.remove()},enable:function(){this.$element.removeProp("disabled")},disable:function(){this.$element.prop("disabled",!0)},show:function(){this.$element.show()},hide:function(){this.$element.hide()}})}),define("taoQtiTest/runner/plugins/navigation/skip",["jquery","i18n","taoTests/runner/plugin","tpl!taoQtiTest/runner/plugins/navigation/button"],function($,__,pluginFactory,buttonTpl){"use strict";var buttonData={skip:{control:"skip",title:__("Skip  and go to the next item"),icon:"external",text:__("Skip")},end:{control:"skip-end",title:__("Skip and go to the end of the test"),icon:"external",text:__("Skip and end test")}},createElement=function(context){
var dataType=context.isLast?"end":"skip";return $(buttonTpl(buttonData[dataType]))},updateElement=function($element,context){var dataType=context.isLast?"end":"skip";$element.data("control")!==buttonData[dataType].control&&$element.data("control",buttonData[dataType].control).attr("title",buttonData[dataType].title).find(".text").text(buttonData[dataType].title)};return pluginFactory({name:"skip",init:function(){var self=this,testRunner=this.getTestRunner(),toggle=function(){var context=testRunner.getTestContext();return context.allowSkipping===!0?(self.show(),!0):(self.hide(),!1)};this.$element=createElement(testRunner.getTestContext()),this.$element.on("click",function(e){
e.preventDefault(),self.getState("enabled")!==!1&&(self.disable(),testRunner.skip())}),toggle(),self.disable(),testRunner.on("loaditem",function(){toggle()&&updateElement(self.$element,testRunner.getTestContext())}).on("renderitem",function(){self.enable()}).on("unloaditem",function(){self.disable()})},render:function(){var $container=this.getAreaBroker().getNavigationArea();$container.append(this.$element)},destroy:function(){this.$element.remove()},enable:function(){this.$element.removeProp("disabled").removeClass("disabled")},disable:function(){this.$element.prop("disabled",!0).addClass("disabled")},show:function(){this.$element.show()},hide:function(){this.$element.hide();
}})}),define("css!taoQtiTestCss/new-test-runner",[],function(){}),define("taoQtiTest/controller/runner/runner",["jquery","lodash","core/promise","ui/feedback","layout/loading-bar","taoTests/runner/runner","taoQtiTest/runner/provider/qti","taoTests/runner/proxy","taoQtiTest/runner/proxy/qtiServiceProxy","taoQtiTest/runner/plugins/controls/title/title","taoQtiTest/runner/plugins/controls/progressbar/progressbar","taoQtiTest/runner/plugins/navigation/next","taoQtiTest/runner/plugins/navigation/previous","taoQtiTest/runner/plugins/navigation/nextSection","taoQtiTest/runner/plugins/navigation/skip","css!taoQtiTestCss/new-test-runner"],function($,_,Promise,feedback,loadingBar,runner,qtiProvider,proxy,qtiServiceProxy,title,progressbar,next,previous,nextSection,skip){
"use strict";runner.registerProvider("qti",qtiProvider),proxy.registerProxy("qtiServiceProxy",qtiServiceProxy);var plugins={title:title,progress:progressbar,previous:previous,next:next,skip:skip,nextSection:nextSection},runnerController={start:function(options){var config=_.defaults(options||{},{renderTo:$(".runner")});loadingBar.start(),runner("qti",plugins,config).on("error",function(err){loadingBar.stop(),window.console.error(err),feedback().error(err)}).on("ready",function(){_.defer(function(){$(".runner").removeClass("hidden")})}).on("unloaditem",function(){loadingBar.start()}).on("renderitem",function(){loadingBar.stop()}).on("finish",function(){this.destroy();
}).on("destroy",function(){window.location=config.exitUrl}).init()}};return runnerController}),define("taoQtiTest/testRunner/actionBarHook",["jquery","lodash","core/errorHandler","core/promise"],function($,_,errorHandler,Promise){"use strict";function isValidConfig(toolconfig){return!(!_.isObject(toolconfig)||!toolconfig.hook)}function triggerItemLoaded(tool){tool&&tool.itemLoaded&&tool.itemLoaded()}function initQtiTool($toolsContainer,id,toolconfig,testContext,testRunner){return itemIsLoaded=!1,tools[id]=null,_.isString(toolconfig)&&(toolconfig={hook:toolconfig}),new Promise(function(resolve){isValidConfig(toolconfig)?require([toolconfig.hook],function(hook){
var $button,$existingBtn;isValidHook(hook)?(hook.init(id,toolconfig,testContext,testRunner),$existingBtn=$toolsContainer.children('[data-control="'+id+'"]'),$existingBtn.length&&(hook.clear($existingBtn),$existingBtn.remove()),hook.isVisible()&&(tools[id]=hook,$button=hook.render(),_appendInOrder($toolsContainer,$button),$button.trigger("ready"+_ns,[hook]),itemIsLoaded&&triggerItemLoaded(hook)),resolve(hook)):(errorHandler["throw"](_ns,"invalid hook format"),resolve(null))},function(e){errorHandler["throw"](_ns,"the hook amd module cannot be found"),resolve(null)}):(errorHandler["throw"](_ns,"invalid tool config format"),resolve(null))})}function _appendInOrder($container,$button){
var $after,$before,order=$button.data("order");"last"===order?$container.append($button):"first"===order?$container.prepend($button):(order=_.parseInt(order),_.isNaN(order)?$container.append($button):($container.children(".action").each(function(){var $btn=$(this),_order=$btn.data("order");if("last"===_order)$before=$btn,$after=null;else if("first"===_order)$before=null,$after=$btn;else{if(_order=_.parseInt(_order),_.isNaN(_order)||_order>order)return $before=$btn,$after=null,!1;_order===order?$after=$btn:order>_order&&($after=$btn,$before=null)}}),$after?$after.after($button):$before?$before.before($button):$container.append($button)))}function isValidHook(hook){
return _.isObject(hook)&&_(["init","render","clear","isVisible"]).reduce(function(result,method){return result&&_.isFunction(hook[method])},!0)}var _ns=".actionBarHook",$doc=$(document),tools={},itemIsLoaded=!1;return $doc.off(_ns).on("serviceloaded"+_ns,function(){itemIsLoaded=!0,_.forEach(tools,function(tool){triggerItemLoaded(tool)})}),{isValid:isValidConfig,initQtiTool:initQtiTool}}),define("taoQtiTest/testRunner/actionBarTools",["jquery","lodash","core/eventifier","core/promise","taoQtiTest/testRunner/actionBarHook"],function($,_,eventifier,Promise,actionBarHook){"use strict";var registeredQtiTools,qtiTools,actionBarTools={register:function(tools){var registerTools=tools||{};
this.trigger("beforeregister",registerTools,this),registeredQtiTools=registerTools,this.trigger("afterregister",registerTools,this)},getRegisteredTools:function(){return registeredQtiTools||{}},getRegistered:function(id){return registeredQtiTools&&registeredQtiTools[id]},isRegistered:function(id){return!(!registeredQtiTools||!registeredQtiTools[id])},get:function(id){return qtiTools&&qtiTools[id]},list:function(){return _.values(qtiTools||{})},render:function(container,testContext,testRunner,callback){var self=this,$container=$(container),promises=[];this.trigger("beforerender",$container,testContext,testRunner,this),_.forIn(this.getRegisteredTools(),function(toolconfig,id){
promises.push(actionBarHook.initQtiTool($container,id,toolconfig,testContext,testRunner))}),Promise.all(promises).then(function(values){var tools=[];qtiTools={},_.forEach(values,function(tool){tool&&(tools.push(tool),qtiTools[tool.getId()]=tool)}),_.isFunction(callback)&&callback.call(self,tools,$container,testContext,testRunner,self),self.trigger("afterrender",tools,$container,testContext,testRunner,self)})}};return eventifier(actionBarTools)}),define("tpl!taoQtiTest/testRunner/tpl/navigator",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){return" masked"}this.compilerInfo=[4,">= 1.0.0"],
helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='        <aside class="test-sidebar test-sidebar-',(helper=helpers.region)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.region,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" flex-container-navi qti-navigator",stack1=helpers["if"].call(depth0,depth0&&depth0.hidden,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),
buffer+='">\n            <div class="qti-navigator-collapsible">\n                <span class="qti-navigator-collapse icon icon-left" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Collapse the review panel",options):helperMissing.call(depth0,"__","Collapse the review panel",options)))+'"></span>\n                <span class="qti-navigator-expand icon icon-right" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Expand the review panel",options):helperMissing.call(depth0,"__","Expand the review panel",options)))+'"></span>\n            </div>\n\n            <div class="qti-navigator-info collapsible">\n                <span class="qti-navigator-label">\n                    <span class="qti-navigator-text">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Test status",options):helperMissing.call(depth0,"__","Test status",options)))+'</span>\n                    <span class="icon-up"></span>\n                    <span class="icon-down"></span>\n                </span>\n                <ul class="collapsible-panel plain">\n                    <li class="qti-navigator-viewed" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Viewed items",options):helperMissing.call(depth0,"__","Viewed items",options)))+'">\n                        <span class="qti-navigator-label">\n                            <span class="qti-navigator-icon icon-viewed"></span>\n                            <span class="qti-navigator-text">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Viewed",options):helperMissing.call(depth0,"__","Viewed",options)))+'</span>\n                            <span class="qti-navigator-counter">-/-</span>\n                        </span>\n                    </li>\n                    <li class="qti-navigator-answered" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Completed items",options):helperMissing.call(depth0,"__","Completed items",options)))+'">\n                        <span class="qti-navigator-label">\n                            <span class="qti-navigator-icon icon-answered"></span>\n                            <span class="qti-navigator-text">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Answered",options):helperMissing.call(depth0,"__","Answered",options)))+'</span>\n                            <span class="qti-navigator-counter">-/-</span>\n                        </span>\n                    </li>\n                    <li class="qti-navigator-unanswered" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Unanswered items",options):helperMissing.call(depth0,"__","Unanswered items",options)))+'">\n                        <span class="qti-navigator-label">\n                            <span class="qti-navigator-icon icon-unanswered"></span>\n                            <span class="qti-navigator-text">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Unanswered",options):helperMissing.call(depth0,"__","Unanswered",options)))+'</span>\n                            <span class="qti-navigator-counter">-/-</span>\n                        </span>\n                    </li>\n                    <li class="qti-navigator-flagged" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Items marked for later review",options):helperMissing.call(depth0,"__","Items marked for later review",options)))+'">\n                        <span class="qti-navigator-label">\n                            <span class="qti-navigator-icon icon-flagged"></span>\n                            <span class="qti-navigator-text">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Flagged",options):helperMissing.call(depth0,"__","Flagged",options)))+'</span>\n                            <span class="qti-navigator-counter">-/-</span>\n                        </span>\n                    </li>\n                </ul>\n            </div>\n\n            <div class="qti-navigator-filters">\n                <ul class="plain clearfix">\n                    <li class="qti-navigator-filter active" data-mode="all">\n                        <span title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Reset filters",options):helperMissing.call(depth0,"__","Reset filters",options)))+'">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"All",options):helperMissing.call(depth0,"__","All",options)))+'</span>\n                    </li>\n                    <li class="qti-navigator-filter" data-mode="unanswered">\n                        <span class="icon-unanswered" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Only display the unanswered items",options):helperMissing.call(depth0,"__","Only display the unanswered items",options)))+'"></span>\n                    </li>\n                    <li class="qti-navigator-filter" data-mode="flagged">\n                        <span class="icon-flagged" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"Only display the items marked for review",options):helperMissing.call(depth0,"__","Only display the items marked for review",options)))+'"></span>\n                    </li>\n                </ul>\n            </div>\n\n            <nav class="qti-navigator-tree">\n            </nav>\n\n            <div id="qti-navigator-linear" class="qti-navigator-linear">\n                <span class="icon icon-info" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"In this part of the test navigation is not allowed.",options):helperMissing.call(depth0,"__","In this part of the test navigation is not allowed.",options)))+'"></span>\n                <p class="qti-navigator-message">\n                    '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"In this part of the test navigation is not allowed.",options):helperMissing.call(depth0,"__","In this part of the test navigation is not allowed.",options)))+"\n                </p>\n            </div>\n        </aside>\n"})}),define("tpl!taoQtiTest/testRunner/tpl/navigatorTree",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n                    <li class="qti-navigator-part collapsible ',stack1=helpers["if"].call(depth0,depth0&&depth0.active,{hash:{},inverse:self.program(4,program4,data),
fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-id="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                        <span class="qti-navigator-label" title="',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                            <span class="qti-navigator-text">',
(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n                            <span class="icon-up"></span>\n                            <span class="icon-down"></span>\n                        </span>\n                        ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.sections,null==stack1||stack1===!1?stack1:stack1.length),{hash:{},inverse:self.program(29,program29,data),fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </li>\n                    ";
}function program2(depth0,data){return"active"}function program4(depth0,data){return"collapsed"}function program6(depth0,data){var stack1,buffer="";return buffer+='\n                        <ul class="qti-navigator-sections collapsible-panel plain">\n                            ',stack1=helpers.each.call(depth0,depth0&&depth0.sections,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                        </ul>\n                        "}function program7(depth0,data){var stack1,helper,buffer="";return buffer+='\n                            <li class="qti-navigator-section collapsible ',
stack1=helpers["if"].call(depth0,depth0&&depth0.active,{hash:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-id="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                                <span class="qti-navigator-label" title="',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data
}):helper),buffer+=escapeExpression(stack1)+'">\n                                    <span class="qti-navigator-text">',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n                                    <span class="qti-navigator-counter">',(helper=helpers.answered)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.answered,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"/"+escapeExpression((stack1=depth0&&depth0.items,
stack1=null==stack1||stack1===!1?stack1:stack1.length,typeof stack1===functionType?stack1.apply(depth0):stack1))+'</span>\n                                </span>\n                                <ul class="qti-navigator-items collapsible-panel plain">\n                                    ',stack1=helpers.each.call(depth0,depth0&&depth0.items,{hash:{},inverse:self.noop,fn:self.program(8,program8,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                                </ul>\n                            </li>\n                            "}function program8(depth0,data){var stack1,helper,buffer="";return buffer+='\n                                    <li class="qti-navigator-item',
stack1=helpers["if"].call(depth0,depth0&&depth0.active,{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.flagged,{hash:{},inverse:self.noop,fn:self.program(11,program11,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.answered,{hash:{},inverse:self.noop,fn:self.program(13,program13,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.viewed,{hash:{},inverse:self.program(17,program17,data),fn:self.program(15,program15,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),
buffer+='" data-id="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-position="',(helper=helpers.position)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.position,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                                        <span class="qti-navigator-label truncate" title="',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,
stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                                            <span class="qti-navigator-icon icon-',stack1=helpers["if"].call(depth0,depth0&&depth0.flagged,{hash:{},inverse:self.program(21,program21,data),fn:self.program(19,program19,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='"></span>\n                                            ',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n                                        </span>\n                                    </li>\n                                    ";
}function program9(depth0,data){return" active"}function program11(depth0,data){return" flagged"}function program13(depth0,data){return" answered"}function program15(depth0,data){return" viewed"}function program17(depth0,data){return" unseen"}function program19(depth0,data){return"flagged"}function program21(depth0,data){var stack1;return stack1=helpers["if"].call(depth0,depth0&&depth0.answered,{hash:{},inverse:self.program(24,program24,data),fn:self.program(22,program22,data),data:data}),stack1||0===stack1?stack1:""}function program22(depth0,data){return"answered"}function program24(depth0,data){var stack1;return stack1=helpers["if"].call(depth0,depth0&&depth0.viewed,{
hash:{},inverse:self.program(27,program27,data),fn:self.program(25,program25,data),data:data}),stack1||0===stack1?stack1:""}function program25(depth0,data){return"viewed"}function program27(depth0,data){return"unseen"}function program29(depth0,data){var stack1,helper,options,buffer="";return buffer+='\n                        <div class="qti-navigator-linear-part collapsible-panel">\n                            <span class="icon icon-info" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"In this part of the test navigation is not allowed.",options):helperMissing.call(depth0,"__","In this part of the test navigation is not allowed.",options)))+'"></span>\n                            <p class="qti-navigator-message">\n                                '+escapeExpression((helper=helpers.__||depth0&&depth0.__,
options={hash:{},data:data},helper?helper.call(depth0,"In this part of the test navigation is not allowed.",options):helperMissing.call(depth0,"__","In this part of the test navigation is not allowed.",options)))+'\n                            </p>\n                            <p class="qti-navigator-actions">\n                                <button class="btn-info small" data-id="',(helper=helpers.itemId)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.itemId,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-position="',(helper=helpers.position)?stack1=helper.call(depth0,{
hash:{},data:data}):(helper=depth0&&depth0.position,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" title="'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Start Test-part",options):helperMissing.call(depth0,"__","Start Test-part",options)))+'">\n                                    <span class="qti-navigator-text">'+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Start Test-part",options):helperMissing.call(depth0,"__","Start Test-part",options)))+'</span>\n                                    <span class="icon-play r"></span>\n                                </button>\n                            </p>\n                        </div>\n                        ';
}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='                <ul class="qti-navigator-parts plain">\n                    ',stack1=helpers.each.call(depth0,depth0&&depth0.parts,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                </ul>\n"})}),define("taoQtiTest/testRunner/testReview",["jquery","lodash","i18n","tpl!taoQtiTest/testRunner/tpl/navigator","tpl!taoQtiTest/testRunner/tpl/navigatorTree","util/capitalize"],function($,_,__,navigatorTpl,navigatorTreeTpl,capitalize){
"use strict";var _cssCls={active:"active",collapsed:"collapsed",collapsible:"collapsible",masked:"masked",disabled:"disabled",flagged:"flagged",answered:"answered",viewed:"viewed",unseen:"unseen",icon:"qti-navigator-icon",scope:{test:"scope-test",testPart:"scope-test-part",testSection:"scope-test-section"}},_selectors={component:".qti-navigator",filterBar:".qti-navigator-filters",tree:".qti-navigator-tree",collapseHandle:".qti-navigator-collapsible",linearState:".qti-navigator-linear",infoAnswered:".qti-navigator-answered .qti-navigator-counter",infoViewed:".qti-navigator-viewed .qti-navigator-counter",infoUnanswered:".qti-navigator-unanswered .qti-navigator-counter",
infoFlagged:".qti-navigator-flagged .qti-navigator-counter",infoPanel:".qti-navigator-info",infoPanelLabels:".qti-navigator-info > .qti-navigator-label",parts:".qti-navigator-part",partLabels:".qti-navigator-part > .qti-navigator-label",sections:".qti-navigator-section",sectionLabels:".qti-navigator-section > .qti-navigator-label",items:".qti-navigator-item",itemLabels:".qti-navigator-item > .qti-navigator-label",itemIcons:".qti-navigator-item > .qti-navigator-icon",icons:".qti-navigator-icon",linearStart:".qti-navigator-linear-part button",counters:".qti-navigator-counter",actives:".active",collapsible:".collapsible",collapsiblePanels:".collapsible-panel",unseen:".unseen",
answered:".answered",flagged:".flagged",notFlagged:":not(.flagged)",notAnswered:":not(.answered)",masked:".masked"},_filterMap={all:"",unanswered:_selectors.answered,flagged:_selectors.notFlagged,answered:_selectors.notAnswered,filtered:_selectors.masked},_optionsMap={reviewScope:"reviewScope",reviewPreventsUnseen:"preventsUnseen",canCollapse:"canCollapse"},_reviewScopes={test:"test",testPart:"testPart",testSection:"testSection"},testReview={init:function(element,options){var initOptions=_.isObject(options)&&options||{},putOnRight="right"===initOptions.region,insertMethod=putOnRight?"append":"prepend";if(this.options=initOptions,this.disabled=!1,this.hidden=!!initOptions.hidden,
this.currentFilter="all",this.$component&&this.$component.remove(),this.$container=$(element),insertMethod=this.$container[insertMethod],!insertMethod)throw new Error("Unable to inject the component structure into the DOM");return insertMethod.call(this.$container,navigatorTpl({region:putOnRight?"right":"left",hidden:this.hidden})),this._loadDOM(),this._initEvents(),this._updateDisplayOptions(),this},_loadDOM:function(){this.$component=this.$container.find(_selectors.component),this.$infoAnswered=this.$component.find(_selectors.infoAnswered),this.$infoViewed=this.$component.find(_selectors.infoViewed),this.$infoUnanswered=this.$component.find(_selectors.infoUnanswered),
this.$infoFlagged=this.$component.find(_selectors.infoFlagged),this.$filterBar=this.$component.find(_selectors.filterBar),this.$filters=this.$filterBar.find("li"),this.$tree=this.$component.find(_selectors.tree),this.$linearState=this.$component.find(_selectors.linearState)},_initEvents:function(){var self=this;this.$component.on("click"+_selectors.component,_selectors.collapseHandle,function(){self.disabled||(self.$component.toggleClass(_cssCls.collapsed),self.$component.hasClass(_cssCls.collapsed)&&self._openSelected())}),this.$component.on("click"+_selectors.component,_selectors.infoPanelLabels,function(){if(!self.disabled){var $panel=$(this).closest(_selectors.infoPanel);
self._togglePanel($panel,_selectors.infoPanel)}}),this.$tree.on("click"+_selectors.component,_selectors.partLabels,function(){if(!self.disabled){var $panel=$(this).closest(_selectors.parts),open=self._togglePanel($panel,_selectors.parts);open&&($panel.hasClass(_cssCls.active)?self._openSelected():self._openOnly($panel.find(_selectors.sections).first(),$panel))}}),this.$tree.on("click"+_selectors.component,_selectors.sectionLabels,function(){if(!self.disabled){var $panel=$(this).closest(_selectors.sections);self._togglePanel($panel,_selectors.sections)}}),this.$tree.on("click"+_selectors.component,_selectors.itemLabels,function(event){if(!self.disabled){var $target,$item=$(this).closest(_selectors.items);
$item.hasClass(_cssCls.disabled)||($target=$(event.target),$target.is(_selectors.icons)&&!self.$component.hasClass(_cssCls.collapsed)?$item.hasClass(_cssCls.unseen)||self._mark($item):(self._select($item),self._jump($item)))}}),this.$tree.on("click"+_selectors.component,_selectors.linearStart,function(){if(!self.disabled){var $btn=$(this);$btn.hasClass(_cssCls.disabled)||($btn.addClass(_cssCls.disabled),self._jump($btn))}}),this.$filterBar.on("click"+_selectors.component,"li",function(){if(!self.disabled){var $btn=$(this),mode=$btn.data("mode");self.$filters.removeClass(_cssCls.active),self.$component.removeClass(_cssCls.collapsed),$btn.addClass(_cssCls.active),
self._filter(mode)}})},_filter:function(criteria){var $items=this.$tree.find(_selectors.items).removeClass(_cssCls.masked),filter=_filterMap[criteria];filter&&$items.filter(filter).addClass(_cssCls.masked),this._updateSectionCounters(!!filter),this.currentFilter=criteria},_select:function(position,open){var selected=position&&position.jquery?position:this.$tree.find("[data-position="+position+"]"),hierarchy=selected.parentsUntil(this.$tree);return open&&this._openOnly(hierarchy),this.$tree.find(_selectors.actives).removeClass(_cssCls.active),hierarchy.add(selected).addClass(_cssCls.active),selected},_openSelected:function(){var selected=this.$tree.find(_selectors.items+_selectors.actives),hierarchy=selected.parentsUntil(this.$tree);
return this._openOnly(hierarchy),selected},_openOnly:function(opened,root){(root||this.$tree).find(_selectors.collapsible).addClass(_cssCls.collapsed),opened.removeClass(_cssCls.collapsed)},_togglePanel:function(panel,collapseSelector){var collapsed=panel.hasClass(_cssCls.collapsed);return collapseSelector&&this.$tree.find(collapseSelector).addClass(_cssCls.collapsed),collapsed?panel.removeClass(_cssCls.collapsed):panel.addClass(_cssCls.collapsed),collapsed},_setItemIcon:function($item,icon){$item.find(_selectors.icons).attr("class",_cssCls.icon+" icon-"+icon)},_adjustItemIcon:function($item){var icon=null,defaultIcon=_cssCls.unseen,iconCls=[_cssCls.flagged,_cssCls.answered,_cssCls.viewed];
_.forEach(iconCls,function(cls){return $item.hasClass(cls)?(icon=cls,!1):void 0}),this._setItemIcon($item,icon||defaultIcon)},_toggleFlag:function($item,flag){$item.toggleClass(_cssCls.flagged,flag),this._adjustItemIcon($item)},_mark:function($item){var itemId=$item.data("id"),itemPosition=$item.data("position"),flag=!$item.hasClass(_cssCls.flagged);this._toggleFlag($item),this.trigger("mark",[flag,itemPosition,itemId])},_jump:function($item){var itemId=$item.data("id"),itemPosition=$item.data("position");this.trigger("jump",[itemPosition,itemId])},_updateSectionCounters:function(filtered){var self=this,filter=_filterMap[filtered?"filtered":"answered"];this.$tree.find(_selectors.sections).each(function(){
var $section=$(this),$items=$section.find(_selectors.items),$filtered=$items.filter(filter),total=$items.length,nb=total-$filtered.length;self._writeCount($section.find(_selectors.counters),nb,total)})},_updateDisplayOptions:function(){var reviewScope=_reviewScopes[this.options.reviewScope]||"test",scopeClass=_cssCls.scope[reviewScope],$root=this.$component;_.forEach(_cssCls.scope,function(cls){$root.removeClass(cls)}),scopeClass&&$root.addClass(scopeClass),$root.toggleClass(_cssCls.collapsible,this.options.canCollapse)},_updateOptions:function(testContext){var options=this.options;_.forEach(_optionsMap,function(optionKey,contextKey){void 0!==testContext[contextKey]&&(options[optionKey]=testContext[contextKey]);
})},_updateInfos:function(){var progression=this.progression,unanswered=Number(progression.total)-Number(progression.answered);this._writeCount(this.$infoAnswered,progression.answered,progression.total),this._writeCount(this.$infoUnanswered,unanswered,progression.total),this._writeCount(this.$infoViewed,progression.viewed,progression.total),this._writeCount(this.$infoFlagged,progression.flagged,progression.total)},_writeCount:function($place,count,total){$place.text(count+"/"+total)},_getProgressionOfTest:function(testContext){return{total:testContext.numberItems||0,answered:testContext.numberCompleted||0,viewed:testContext.numberPresented||0,flagged:testContext.numberFlagged||0
}},_getProgressionOfTestPart:function(testContext){return{total:testContext.numberItemsPart||0,answered:testContext.numberCompletedPart||0,viewed:testContext.numberPresentedPart||0,flagged:testContext.numberFlaggedPart||0}},_getProgressionOfTestSection:function(testContext){return{total:testContext.numberItemsSection||0,answered:testContext.numberCompletedSection||0,viewed:testContext.numberPresentedSection||0,flagged:testContext.numberFlaggedSection||0}},_updateTree:function(testContext){var navigatorMap=testContext.navigatorMap,reviewScope=this.options.reviewScope,reviewScopePart="testPart"===reviewScope,reviewScopeSection="testSection"===reviewScope,_partsFilter=function(part){
return reviewScopeSection&&part.sections&&(part.sections=_.filter(part.sections,_partsFilter)),part.active};navigatorMap?((reviewScopePart||reviewScopeSection)&&(navigatorMap=_.filter(navigatorMap,_partsFilter)),this.$filterBar.show(),this.$linearState.hide(),this.$tree.html(navigatorTreeTpl({parts:navigatorMap})),this.options.preventsUnseen&&this.$tree.find(_selectors.unseen).addClass(_cssCls.disabled)):(this.$filterBar.hide(),this.$linearState.show(),this.$tree.empty()),this._filter(this.$filters.filter(_selectors.actives).data("mode"))},setItemFlag:function(position,flag){var $item=position&&position.jquery?position:this.$tree.find("[data-position="+position+"]"),progression=this.progression;
this._toggleFlag($item,flag),progression.flagged=this.$tree.find(_selectors.flagged).length,this._writeCount(this.$infoFlagged,progression.flagged,progression.total),this._filter(this.currentFilter)},updateNumberFlagged:function(testContext,position,flag){var fields=["numberFlagged"],currentPosition=testContext.itemPosition,currentFound=!1,currentSection=null,currentPart=null,itemFound=!1,itemSection=null,itemPart=null;testContext.navigatorMap?(_.forEach(testContext.navigatorMap,function(part){return _.forEach(part&&part.sections,function(section){return _.forEach(section&&section.items,function(item){return item&&(item.position===position&&(itemPart=part,itemSection=section,
itemFound=!0),item.position===currentPosition&&(currentPart=part,currentSection=section,currentFound=!0),itemFound&&currentFound)?!1:void 0}),itemFound&&currentFound?!1:void 0}),itemFound&&currentFound?!1:void 0}),itemFound&&currentPart===itemPart&&fields.push("numberFlaggedPart"),itemFound&&currentSection===itemSection&&fields.push("numberFlaggedSection")):(fields.push("numberFlaggedPart"),fields.push("numberFlaggedSection")),_.forEach(fields,function(field){field in testContext&&(testContext[field]+=flag?1:-1)})},getProgression:function getProgression(testContext){var reviewScope=_reviewScopes[this.options.reviewScope]||"test",progressInfoMethod="_getProgressionOf"+capitalize(reviewScope),getProgression=this[progressInfoMethod]||this._getProgressionOfTest,progression=getProgression&&getProgression(testContext)||{};
return progression},update:function(testContext){return this.progression=this.getProgression(testContext),this._updateOptions(testContext),this._updateInfos(testContext),this._updateTree(testContext),this._updateDisplayOptions(testContext),this},disable:function(){return this.disabled=!0,this.$component.addClass(_cssCls.disabled),this},enable:function(){return this.disabled=!1,this.$component.removeClass(_cssCls.disabled),this},hide:function(){return this.disabled=!0,this.hidden=!0,this.$component.addClass(_cssCls.masked),this},show:function(){return this.disabled=!1,this.hidden=!1,this.$component.removeClass(_cssCls.masked),this},toggle:function(show){return void 0===show&&(show=this.hidden),
show?this.show():this.hide(),this},on:function(eventName){var dom=this.$component;return dom&&dom.on.apply(dom,arguments),this},off:function(eventName){var dom=this.$component;return dom&&dom.off.apply(dom,arguments),this},trigger:function(eventName,extraParameters){var dom=this.$component;return void 0===extraParameters&&(extraParameters=[]),_.isArray(extraParameters)||(extraParameters=[extraParameters]),extraParameters.push(this),dom&&dom.trigger(eventName,extraParameters),this}},testReviewFactory=function(element,options){var component=_.clone(testReview,!0);return component.init(element,options)};return testReviewFactory}),define("taoQtiTest/testRunner/testMetaData",["lodash"],function(_){
"use strict";var testMetaDataFactory=function(options){function init(){_testServiceCallId=options.testServiceCallId,testMetaData.setData(getLocalStorageData())}function setLocalStorageData(val){var currentKey=testMetaData.getLocalStorageKey();try{window.localStorage.setItem(currentKey,val)}catch(domException){if("QuotaExceededError"!==domException.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==domException.name)throw domException;for(var key,removed=0,i=window.localStorage.length;i--;)key=localStorage.key(i),/^testMetaData_.*/.test(key)&&key!==currentKey&&(window.localStorage.removeItem(key),removed++);if(!removed)throw domException;setLocalStorageData(val)}}function getLocalStorageData(){
var data=window.localStorage.getItem(testMetaData.getLocalStorageKey()),result=JSON.parse(data)||{};return result}var _testServiceCallId,_storageKeyPrefix="testMetaData_",_data={};if(!options||void 0===options.testServiceCallId)throw new TypeError("testServiceCallId option is required");var testMetaData={SECTION_EXIT_CODE:{COMPLETED_NORMALLY:700,QUIT:701,COMPLETE_TIMEOUT:703,TIMEOUT:704,FORCE_QUIT:705,IN_PROGRESS:706,ERROR:300},TEST_EXIT_CODE:{COMPLETE:"C",TERMINATED:"T",INCOMPLETE:"IC",INCOMPLETE_QUIT:"IQ",INACTIVE:"IA",CANDIDATE_DISAGREED_WITH_NDA:"DA"},getTestServiceCallId:function(){return _testServiceCallId},setTestServiceCallId:function(value){_testServiceCallId=value;
},setData:function(data){_data=data,setLocalStorageData(JSON.stringify(_data))},addData:function(data,overwrite){data=_.clone(data),void 0===overwrite&&(overwrite=!1),overwrite?_.merge(_data,data):_data=_.merge(data,_data),setLocalStorageData(JSON.stringify(_data))},getData:function(){return _.clone(_data)},clearData:function(){_data={},window.localStorage.removeItem(testMetaData.getLocalStorageKey())},getLocalStorageKey:function(){return _storageKeyPrefix+_testServiceCallId}};return init(),testMetaData};return testMetaDataFactory}),define("serviceApi/ServiceApi",["jquery","urlParser"],function($,UrlParser){"use strict";function ServiceApi(baseUrl,parameters,serviceCallId,stateStorage,userService,paused){
this.baseUrl=baseUrl,this.parameters=parameters,this.connected=!1,this.serviceCallId=serviceCallId,this.state=stateStorage,this.userService=userService,this.hasBeenPaused=paused}return ServiceApi.SIG_SUCCESS=0,ServiceApi.SIG_ERROR=1,ServiceApi.prototype.loadInto=function(frame,connected){var self=this,$frame=$(frame),callUrl=this.getCallUrl(),isCORSAllowed=new UrlParser(callUrl).checkCORS();$frame.on("load",function(e){$(document).on("serviceready",function(){self.connect(frame,function(){$(document).off("serviceready"),"function"==typeof connected&&connected()})}),isCORSAllowed===!0&&(frame.contentWindow.__knownParent__=!0)}),$frame.attr("src",callUrl)},ServiceApi.prototype.connect=function(frame,connected){
this.connected===!1&&frame.contentWindow&&"function"==typeof frame.contentWindow.onServiceApiReady&&(frame.contentWindow.onServiceApiReady(this),this.connected=!0,"function"==typeof connected&&connected())},ServiceApi.prototype.getCallUrl=function(){var params=this.parameters||{};return params.serviceCallId=this.serviceCallId,this.baseUrl+"?"+$.param(params)},ServiceApi.prototype.getUserPropertyValues=function(property,callback){this.userService.get(property,callback)},ServiceApi.prototype.getServiceCallId=function(){return this.serviceCallId},ServiceApi.prototype.getState=function(){return this.state.get()},ServiceApi.prototype.setState=function(state,callback){
return this.state.set(state,callback)},ServiceApi.prototype.getHasBeenPaused=function(){return this.hasBeenPaused},ServiceApi.prototype.setHasBeenPaused=function(paused){this.hasBeenPaused=paused},ServiceApi.prototype.getParameter=function(identifier){return"undefined"!=typeof this.parameters[identifier]?this.parameters[identifier]:null},ServiceApi.prototype.onFinish=function(callback){return this.onFinishCallback=callback,this},ServiceApi.prototype.onKill=function(callback){return this.onKillCallback=callback,this},ServiceApi.prototype.onExit=function(callback){return this.onExitCallback=callback,this},ServiceApi.prototype.kill=function(callback){"function"==typeof this.onKillCallback?this.onKillCallback(callback):callback(0);
},ServiceApi.prototype.exit=function(callback){"function"==typeof this.onExitCallback?this.onExitCallback(callback):callback(0)},ServiceApi.prototype.finish=function(valueArray){"function"==typeof this.onFinishCallback&&this.onFinishCallback(valueArray)},ServiceApi}),define("serviceApi/UserInfoService",["jquery"],function($){function UserInfoService(requestUrl,data){this.data=data,this.requestUrl=requestUrl}return UserInfoService.prototype.get=function(property,callback){this.data.hasOwnProperty(property)?"function"==typeof callback&&callback(this.data[property]):$.ajax({url:this.requestUrl,data:{property:property},type:"post",dataType:"json",success:function(service,callback){
return function(r){for(key in r.data)service.data[key]=r.data[key];"function"==typeof callback&&callback(service.data[property])}}(this,callback)})},UserInfoService}),define("serviceApi/StateStorage",["jquery"],function($){"use strict";function StateStorage(state,submitUrl){this.state=state,this.submitUrl=submitUrl}return StateStorage.prototype.get=function(callback){return"function"==typeof callback&&callback(this.state),this.state},StateStorage.prototype.set=function(state,callback){state===this.state?"function"==typeof callback&&callback():(this.state=state,$.ajax({url:this.submitUrl,data:{state:state},type:"post",dataType:"json",success:"function"==typeof callback?callback:null
}))},StateStorage}),define("taoQtiTest/controller/runtime/testRunner",["jquery","lodash","i18n","module","taoQtiTest/testRunner/actionBarTools","taoQtiTest/testRunner/testReview","taoQtiTest/testRunner/progressUpdater","taoQtiTest/testRunner/testMetaData","serviceApi/ServiceApi","serviceApi/UserInfoService","serviceApi/StateStorage","iframeNotifier","mathJax","ui/feedback","ui/deleter","moment","ui/modal","ui/progressbar"],function($,_,__,module,actionBarTools,testReview,progressUpdater,testMetaDataFactory,ServiceApi,UserInfoService,StateStorage,iframeNotifier,MathJax,feedback,deleter,moment,modal){"use strict";var timerIds=[],currentTimes=[],lastDates=[],timeDiffs=[],waitingTime=0,$timers,$controls,timerIndex,testMetaData,sessionStateService,$doc=$(document),optionNextSection="x-tao-option-nextSection",optionNextSectionWarning="x-tao-option-nextSectionWarning",optionReviewScreen="x-tao-option-reviewScreen",TestRunner={
TEST_STATE_INITIAL:0,TEST_STATE_INTERACTING:1,TEST_STATE_MODAL_FEEDBACK:2,TEST_STATE_SUSPENDED:3,TEST_STATE_CLOSED:4,TEST_NAVIGATION_LINEAR:0,TEST_NAVIGATION_NONLINEAR:1,TEST_ITEM_STATE_INTERACTING:1,beforeTransition:function(callback){iframeNotifier.parent("loading"),this.disableGui(),$controls.$itemFrame.hide(),$controls.$rubricBlocks.hide(),$controls.$timerWrapper.hide(),"function"==typeof callback&&setTimeout(callback,waitingTime)},afterTransition:function(){this.enableGui(),iframeNotifier.parent("unloading"),testMetaData.addData({ITEM:{ITEM_START_TIME_CLIENT:Date.now()/1e3}})},jump:function(position){var self=this,action="jump",params={position:position};
this.disableGui(),this.isJumpOutOfSection(position)&&this.isCurrentItemActive()&&this.isTimedSection()?this.exitTimedSection(action,params):this.killItemSession(function(){self.actionCall(action,params)})},keepItemTimed:function(duration){if(duration){var self=this,action="keepItemTimed",params={duration:duration};self.actionCall(action,params)}},markForReview:function(flag,position){var self=this;iframeNotifier.parent("loading"),this.disableGui(),$.ajax({url:self.testContext.markForReviewUrl,cache:!1,async:!0,type:"POST",dataType:"json",data:{flag:flag,position:position},success:function(data){self.testReview&&(self.testReview.setItemFlag(position,flag),self.testReview.updateNumberFlagged(self.testContext,position,flag),
self.testContext.itemPosition===position&&(self.testContext.itemFlagged=flag),self.updateTools(self.testContext)),self.enableGui(),iframeNotifier.parent("unloading")}})},moveForward:function(){var self=this,action="moveForward";this.disableGui(),this.testContext.numberItemsSection-this.testContext.itemPositionSection-1==0&&this.isCurrentItemActive()?this.isTimedSection()&&!this.testContext.isTimeout?this.exitTimedSection(action):this.exitSection(action):this.killItemSession(function(){self.actionCall(action)})},moveBackward:function(){var self=this,action="moveBackward";this.disableGui(),0==this.testContext.itemPositionSection&&this.isCurrentItemActive()&&this.isTimedSection()?this.exitTimedSection(action):this.killItemSession(function(){
self.actionCall(action)})},isJumpOutOfSection:function(jumpPosition){var items=this.getCurrentSectionItems(),isJumpToOtherSection=!0,isValidPosition=jumpPosition>=0&&jumpPosition<this.testContext.numberItems;if(isValidPosition){for(var i in items)if(items.hasOwnProperty(i)&&items[i].position==jumpPosition){isJumpToOtherSection=!1;break}}else isJumpToOtherSection=!1;return isJumpToOtherSection},exitSection:function(action,params,exitCode){var self=this;testMetaData.addData({SECTION:{SECTION_EXIT_CODE:exitCode||testMetaData.SECTION_EXIT_CODE.COMPLETED_NORMALLY}}),self.killItemSession(function(){self.actionCall(action,params)})},exitTimedSection:function(action,params){
var self=this,qtiRunner=this.getQtiRunner();qtiRunner&&qtiRunner.updateItemApi(),this.displayExitMessage(__("After you complete the section it would be impossible to return to this section to make changes. Are you sure you want to end the section?"),function(){self.exitSection(action,params)},"testSection"),this.enableGui()},nextSection:function(){var self=this,qtiRunner=this.getQtiRunner(),doNextSection=function(){self.exitSection("nextSection",null,testMetaData.SECTION_EXIT_CODE.QUIT)};qtiRunner&&qtiRunner.updateItemApi(),this.hasOption(optionNextSectionWarning)?this.displayExitMessage(__("After you complete the section it would be impossible to return to this section to make changes. Are you sure you want to end the section?"),doNextSection,"testSection"):doNextSection(),
this.enableGui()},getProgression:function(scope){var scopeSuffixMap={test:"",testPart:"Part",testSection:"Section"},scopeSuffix=scope&&scopeSuffixMap[scope]||"";return{total:this.testContext["numberItems"+scopeSuffix]||0,answered:this.testContext["numberCompleted"+scopeSuffix]||0,viewed:this.testContext["numberPresented"+scopeSuffix]||0,flagged:this.testContext["numberFlagged"+scopeSuffix]||0}},displayExitMessage:function(message,action,scope){var self=this,$confirmBox=$(".exit-modal-feedback"),progression=this.getProgression(scope),unansweredCount=progression.total-progression.answered,flaggedCount=progression.flagged;return unansweredCount&&this.isCurrentItemAnswered()&&unansweredCount--,
flaggedCount&&unansweredCount?message=__("You have %s unanswered question(s) and have %s item(s) marked for review.",unansweredCount.toString(),flaggedCount.toString())+" "+message:(flaggedCount&&(message=__("You have %s item(s) marked for review.",flaggedCount.toString())+" "+message),unansweredCount&&(message=__("You have %s unanswered question(s).",unansweredCount.toString())+" "+message)),$confirmBox.find(".message").html(message),$confirmBox.modal({width:500}),$confirmBox.find(".js-exit-cancel, .modal-close").off("click").on("click",function(){$confirmBox.modal("close")}),$confirmBox.find(".js-exit-confirm").off("click").on("click",function(){$confirmBox.modal("close"),
_.isFunction(action)&&action.call(self)}),$confirmBox},killItemSession:function(callback){testMetaData.addData({ITEM:{ITEM_END_TIME_CLIENT:Date.now()/1e3,ITEM_TIMEZONE:moment().utcOffset(moment().utcOffset()).format("Z")}}),"function"!=typeof callback&&(callback=_.noop),this.itemServiceApi.kill(callback)},isCurrentItemActive:function(){return 4!=this.testContext.itemSessionState},isCurrentItemAnswered:function(){var answered=!1;return _.each(this.getCurrentItemState(),function(state){return state&&_.isObject(state.response)&&null!==state.response.base?(answered=!0,!1):void 0}),answered},hasOption:function(option){return _.indexOf(this.testContext.categories,option)>=0;
},getQtiRunner:function(){var itemFrame=document.getElementById("qti-item"),itemWindow=itemFrame&&itemFrame.contentWindow,itemContainerFrame=itemWindow&&itemWindow.document.getElementById("item-container"),itemContainerWindow=itemContainerFrame&&itemContainerFrame.contentWindow;return itemContainerWindow&&itemContainerWindow.qtiRunner},isTimedSection:function(){var timeConstraints=this.testContext.timeConstraints,isTimedSection=!1;for(var index in timeConstraints)timeConstraints.hasOwnProperty(index)&&"assessmentSection"===timeConstraints[index].qtiClassName&&(isTimedSection=!0);return isTimedSection},getCurrentSectionItems:function(){var sectionItems,partId=this.testContext.testPartId,navMap=this.testContext.navigatorMap;
for(var partIndex in navMap)if(navMap.hasOwnProperty(partIndex)&&navMap[partIndex].id===partId)for(var sectionIndex in navMap[partIndex].sections)if(navMap[partIndex].sections.hasOwnProperty(sectionIndex)&&navMap[partIndex].sections[sectionIndex].active===!0){sectionItems=navMap[partIndex].sections[sectionIndex].items;break}return sectionItems},skip:function(){this.disableGui(),this.actionCall("skip")},timeout:function(){var self=this;this.disableGui(),this.testContext.isTimeout=!0,this.updateTimer(),this.killItemSession(function(){var confirmBox=$(".timeout-modal-feedback"),testContext=self.testContext,confirmBtn=confirmBox.find(".js-timeout-confirm, .modal-close");
testContext.numberCompletedSection===testContext.numberItemsSection?testMetaData.addData({SECTION:{SECTION_EXIT_CODE:testMetaData.SECTION_EXIT_CODE.COMPLETE_TIMEOUT}}):testMetaData.addData({SECTION:{SECTION_EXIT_CODE:testMetaData.SECTION_EXIT_CODE.TIMEOUT}}),self.enableGui(),confirmBox.modal({width:500}),confirmBtn.off("click").on("click",function(){confirmBox.modal("close"),self.actionCall("timeout")})})},setTestContext:function(testContext){this.testContext=testContext,this.itemServiceApi=eval(testContext.itemServiceApiCall),this.itemServiceApi.setHasBeenPaused(testContext.hasBeenPaused)},initMetadata:function(){testMetaData=testMetaDataFactory({testServiceCallId:this.itemServiceApi.serviceCallId
})},getSessionStateService:function(){return sessionStateService||(sessionStateService=this.testContext.sessionStateService({accuracy:1e3})),sessionStateService},update:function(testContext){var self=this;$controls.$itemFrame.remove();var $runner=$("#runner");$runner.css("height","auto"),this.getSessionStateService().restart(),this.setTestContext(testContext),this.updateContext(),this.updateProgress(),this.updateNavigation(),this.updateTestReview(),this.updateInformation(),this.updateRubrics(),this.updateTools(testContext),this.updateTimer(),this.updateExitButton(),this.resetCurrentItemState(),this.initMetadata(),$controls.$itemFrame=$('<iframe id="qti-item" frameborder="0" scrollbars="no"/>'),
$controls.$itemFrame.appendTo($controls.$contentBox),this.testContext.itemSessionState===this.TEST_ITEM_STATE_INTERACTING&&self.testContext.isTimeout===!1?($doc.off(".testRunner").on("serviceloaded.testRunner",function(){self.afterTransition(),self.adjustFrame(),$controls.$itemFrame.css({visibility:"visible"})}),this.itemServiceApi.loadInto($controls.$itemFrame[0],function(){})):self.afterTransition()},updateInformation:function(){this.testContext.isTimeout===!0?feedback().error(__('Time limit reached for item "%s".',this.testContext.itemIdentifier)):this.testContext.itemSessionState!==this.TEST_ITEM_STATE_INTERACTING&&feedback().error(__('No more attempts allowed for item "%s".',this.testContext.itemIdentifier));
},updateTools:function(testContext){var showSkip=!1,showSkipEnd=!1,showNextSection=!!testContext.nextSection&&(this.hasOption(optionNextSection)||this.hasOption(optionNextSectionWarning));this.testContext.allowSkipping===!0&&(this.testContext.isLast===!1?showSkip=!0:showSkipEnd=!0),$controls.$skip.toggle(showSkip),$controls.$skipEnd.toggle(showSkipEnd),$controls.$nextSection.toggle(showNextSection),actionBarTools.render(".tools-box-list",testContext,TestRunner)},createTimer:function(cst){var $timer=$("<div>",{"class":"qti-timer qti-timer__type-"+cst.qtiClassName}),$label=$("<div>",{"class":"qti-timer_label truncate",text:cst.label}),$time=$("<div>",{"class":"qti-timer_time",
text:this.formatTime(cst.seconds)});return $timer.append($label),$timer.append($time),$timer},updateTimer:function(){var hasTimers,self=this;$controls.$timerWrapper.empty();for(var i=0;i<timerIds.length;i++)clearTimeout(timerIds[i]);if(timerIds=[],currentTimes=[],lastDates=[],timeDiffs=[],self.testContext.isTimeout===!1&&self.testContext.itemSessionState===self.TEST_ITEM_STATE_INTERACTING&&(hasTimers=!!this.testContext.timeConstraints.length,$controls.$topActionBar.toggleClass("has-timers",hasTimers),hasTimers)){for(i=0;i<this.testContext.timeConstraints.length;i++){var cst=this.testContext.timeConstraints[i];cst.allowLateSubmission===!1&&($controls.$timerWrapper.append(self.createTimer(cst)),
currentTimes[i]=cst.seconds,lastDates[i]=new Date,timeDiffs[i]=0,timerIndex=i,cst.warningTime=Number.NEGATIVE_INFINITY,self.testContext.timerWarning&&self.testContext.timerWarning[cst.qtiClassName]&&(cst.warningTime=parseInt(self.testContext.timerWarning[cst.qtiClassName],10)),function(timerIndex,cst){timerIds[timerIndex]=setInterval(function(){if(timeDiffs[timerIndex]+=(new Date).getTime()-lastDates[timerIndex].getTime(),timeDiffs[timerIndex]>=1e3){var seconds=timeDiffs[timerIndex]/1e3;currentTimes[timerIndex]-=seconds,timeDiffs[timerIndex]=0}$timers.eq(timerIndex).html(self.formatTime(Math.round(currentTimes[timerIndex]))),currentTimes[timerIndex]<=0?(currentTimes[timerIndex]=0,
clearInterval(timerIds[timerIndex]),$controls.$itemFrame.hide(),self.timeout()):lastDates[timerIndex]=new Date,_.isFinite(cst.warningTime)&&currentTimes[timerIndex]<=cst.warningTime&&self.timeWarning(cst)},1e3)}(timerIndex,cst))}$timers=$controls.$timerWrapper.find(".qti-timer .qti-timer_time"),$controls.$timerWrapper.show()}},timeWarning:function(cst){var message="";$controls.$timerWrapper.find(".qti-timer__type-"+cst.qtiClassName).addClass("qti-timer__warning"),cst.seconds>cst.warningTime&&(message=moment.duration(cst.warningTime,"seconds").humanize(),feedback().warning(__("Warning  You have %s remaining to complete the test.",message))),cst.warningTime=Number.NEGATIVE_INFINITY;
},updateRubrics:function(){if($controls.$rubricBlocks.remove(),this.testContext.rubrics.length>0){$controls.$rubricBlocks=$('<div id="qti-rubrics"/>');for(var i=0;i<this.testContext.rubrics.length;i++)$controls.$rubricBlocks.append(this.testContext.rubrics[i]);$controls.$rubricBlocks.find("a").bind("click keypress",function(){return window.open(this.href),!1}),$controls.$rubricBlocks.prependTo($controls.$contentBox),MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub],$controls.$rubricBlocks[0])}},updateNavigation:function(){$controls.$exit.show(),this.testContext.isLast===!0?($controls.$moveForward.hide(),$controls.$moveEnd.show()):($controls.$moveForward.show(),
$controls.$moveEnd.hide()),this.testContext.navigationMode===this.TEST_NAVIGATION_LINEAR?$controls.$moveBackward.hide():($controls.$controls.show(),this.testContext.canMoveBackward===!0?$controls.$moveBackward.show():$controls.$moveBackward.hide())},updateTestReview:function(){var considerProgress=this.testContext.considerProgress===!0;this.testReview&&(this.testReview.toggle(considerProgress&&this.hasOption(optionReviewScreen)),this.testReview.update(this.testContext))},updateProgress:function(){var considerProgress=this.testContext.considerProgress===!0;$controls.$progressBox.css("visibility",considerProgress?"visible":"hidden"),considerProgress&&this.progressUpdater.update(this.testContext);
},updateContext:function(){$controls.$title.text(this.testContext.testTitle);var sectionText=this.testContext.isDeepestSectionVisible===!0?" - "+this.testContext.sectionTitle:"";$controls.$position.text(sectionText),$controls.$titleGroup.show()},updateExitButton:function(){$controls.$logout.toggleClass("hidden",!this.testContext.logoutButton),$controls.$exit.toggleClass("hidden",!this.testContext.exitButton)},adjustFrame:function(){var frameContentHeight,rubricHeight=$controls.$rubricBlocks.outerHeight(!0)||0,finalHeight=$(window).innerHeight()-$controls.$topActionBar.outerHeight()-$controls.$bottomActionBar.outerHeight(),itemFrame=$controls.$itemFrame.get(0);
$controls.$contentBox.height(finalHeight),$controls.$sideBars.length&&$controls.$sideBars.each(function(){var $sideBar=$(this);$sideBar.height(finalHeight-$sideBar.outerHeight()+$sideBar.height())}),itemFrame&&itemFrame.contentWindow&&(frameContentHeight=$controls.$itemFrame.contents().outerHeight(!0),finalHeight>frameContentHeight&&(frameContentHeight=rubricHeight?Math.max(frameContentHeight,finalHeight-rubricHeight):finalHeight),itemFrame.contentWindow.$&&itemFrame.contentWindow.$("body").trigger("setheight",[frameContentHeight]),$controls.$itemFrame.height(frameContentHeight))},disableGui:function(){$controls.$naviButtons.addClass("disabled"),this.testReview&&this.testReview.disable();
},enableGui:function(){$controls.$naviButtons.removeClass("disabled"),this.testReview&&this.testReview.enable()},hideGui:function(){$controls.$naviButtons.addClass("hidden"),this.testReview&&this.testReview.hide()},showGui:function(){$controls.$naviButtons.removeClass("hidden"),this.testReview&&this.testReview.show()},formatTime:function(totalSeconds){var sec_num=totalSeconds,hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60),seconds=sec_num-3600*hours-60*minutes;10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes),10>seconds&&(seconds="0"+seconds);var time=hours+":"+minutes+":"+seconds;return time},processError:function(error){
var self=this;this.hideGui(),this.beforeTransition(),iframeNotifier.parent("messagealert",{message:error.message,action:function(){testMetaData&&testMetaData.clearData(),error.state===self.TEST_STATE_CLOSED?self.serviceApi.finish():self.serviceApi.exit()}})},actionCall:function(action,extraParams){var self=this,params={metaData:testMetaData?testMetaData.getData():{}};extraParams&&(params=_.assign(params,extraParams)),this.beforeTransition(function(){$.ajax({url:self.testContext[action+"Url"],cache:!1,data:params,async:!0,dataType:"json",success:function(testContext){testMetaData.clearData(),testContext.success?testContext.state===self.TEST_STATE_CLOSED?self.serviceApi.finish():self.update(testContext):self.processError(testContext);
}})})},exit:function(){var self=this;testMetaData.addData({TEST:{TEST_EXIT_CODE:testMetaData.TEST_EXIT_CODE.INCOMPLETE},SECTION:{SECTION_EXIT_CODE:testMetaData.SECTION_EXIT_CODE.QUIT}}),this.displayExitMessage(__("Are you sure you want to end the test?"),function(){self.killItemSession(function(){self.actionCall("endTestSession"),testMetaData.clearData()})},this.testReview?this.testContext.reviewScope:null)},setCurrentItemState:function(id,state){id&&(this.currentItemState[id]=state)},resetCurrentItemState:function(){this.currentItemState={}},getCurrentItemState:function(){return this.currentItemState}},config=module.config();return config&&actionBarTools.register(config.qtiTools),
{start:function(testContext){$controls={$moveForward:$('[data-control="move-forward"]'),$moveEnd:$('[data-control="move-end"]'),$moveBackward:$('[data-control="move-backward"]'),$nextSection:$('[data-control="next-section"]'),$skip:$('[data-control="skip"]'),$skipEnd:$('[data-control="skip-end"]'),$exit:$(window.parent.document).find('[data-control="exit"]'),$logout:$(window.parent.document).find('[data-control="logout"]'),$naviButtons:$(".bottom-action-bar .action"),$skipButtons:$(".navi-box .skip"),$forwardButtons:$(".navi-box .forward"),$progressBar:$('[data-control="progress-bar"]'),$progressLabel:$('[data-control="progress-label"]'),$progressBox:$(".progress-box"),
$title:$('[data-control="qti-test-title"]'),$position:$('[data-control="qti-test-position"]'),$timerWrapper:$('[data-control="qti-timers"]'),$contentPanel:$(".content-panel"),$controls:$(".qti-controls"),$itemFrame:$("#qti-item"),$rubricBlocks:$("#qti-rubrics"),$contentBox:$("#qti-content"),$sideBars:$(".test-sidebar"),$topActionBar:$(".horizontal-action-bar.top-action-bar"),$bottomActionBar:$(".horizontal-action-bar.bottom-action-bar")},$controls.$titleGroup=$controls.$title.add($controls.$position),$doc.ajaxError(function(event,jqxhr){403===jqxhr.status&&iframeNotifier.parent("serviceforbidden")}),window.onServiceApiReady=function(serviceApi){TestRunner.serviceApi=serviceApi,
testContext.success?testContext.state===TestRunner.TEST_STATE_CLOSED?(serviceApi.finish(),testMetaData.clearData()):TestRunner.getSessionStateService().getDuration()?(TestRunner.setTestContext(testContext),TestRunner.initMetadata(),TestRunner.keepItemTimed(TestRunner.getSessionStateService().getDuration()),TestRunner.getSessionStateService().restart()):TestRunner.update(testContext):TestRunner.processError(testContext)},TestRunner.beforeTransition(),TestRunner.testContext=testContext,$controls.$skipButtons.click(function(){$(this).hasClass("disabled")||TestRunner.skip()}),$controls.$forwardButtons.click(function(){$(this).hasClass("disabled")||TestRunner.moveForward();
}),$controls.$moveBackward.click(function(){$(this).hasClass("disabled")||TestRunner.moveBackward()}),$controls.$nextSection.click(function(){$(this).hasClass("disabled")||TestRunner.nextSection()}),$controls.$exit.click(function(e){e.preventDefault(),TestRunner.exit()}),$(window).on("resize",_.throttle(function(){TestRunner.adjustFrame(),$controls.$titleGroup.show()},250)),$doc.on("loading",function(){iframeNotifier.parent("loading")}),$doc.on("unloading",function(){iframeNotifier.parent("unloading")}),TestRunner.progressUpdater=progressUpdater($controls.$progressBar,$controls.$progressLabel),testContext.reviewScreen&&(TestRunner.testReview=testReview($controls.$contentPanel,{
region:testContext.reviewRegion||"left",hidden:!TestRunner.hasOption(optionReviewScreen),reviewScope:testContext.reviewScope,preventsUnseen:!!testContext.reviewPreventsUnseen,canCollapse:!!testContext.reviewCanCollapse}).on("jump",function(event,position){TestRunner.jump(position)}).on("mark",function(event,flag,position){TestRunner.markForReview(flag,position)}),$controls.$sideBars=$(".test-sidebar")),TestRunner.updateProgress(),TestRunner.updateTestReview(),iframeNotifier.parent("serviceready"),TestRunner.adjustFrame(),$controls.$topActionBar.add($controls.$bottomActionBar).animate({opacity:1},600),deleter($("#feedback-box")),modal($("body")),$(document).on("responsechange",function(e,responseId,response){
responseId&&response&&TestRunner.setCurrentItemState(responseId,{response:response})}).on("stateready",function(e,id,state){id&&state&&TestRunner.setCurrentItemState(id,state)}).on("heightchange",function(e,height){$controls.$itemFrame.height(height)})}}}),function(c){var d=document,a="appendChild",i="styleSheet",s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0][a](s),s[i]?s[i].cssText=c:s[a](d.createTextNode(c))}('@-o-keyframes loadingbar{0%{left:-10%}50%{left:90%}100%{left:-10%}}@-moz-keyframes loadingbar{0%{left:-10%}50%{left:90%}100%{left:-10%}}@-webkit-keyframes loadingbar{0%{left:-10%}50%{left:90%}100%{left:-10%}}@keyframes loadingbar{0%{left:-10%}50%{left:90%}100%{left:-10%}}.loading-bar{height:6px;position:absolute;width:100%;top:0px;display:none;overflow-x:hidden;overflow-y:visible;z-index:10000}.loading-bar.fixed{position:fixed;width:100%}.loading-bar.fixed:before{top:0 !important}.loading-bar.loading{display:block}.loading-bar.loading:before{position:absolute;top:86px;content:\'\';height:6px;width:20%;display:block;background:-webkit-linear-gradient(to right, transparent 0%, #c35a13 20%, #c35a13 80%, transparent 100%);background:-moz-linear-gradient(to right, transparent 0%, #c35a13 20%, #c35a13 80%, transparent 100%);background:-ms-linear-gradient(to right, transparent 0%, #c35a13 20%, #c35a13 80%, transparent 100%);background:-o-linear-gradient(to right, transparent 0%, #c35a13 20%, #c35a13 80%, transparent 100%);background:linear-gradient(to right, transparent 0%, #c35a13 20%, #c35a13 80%, transparent 100%);-webkit-animation:loadingbar 5s linear infinite;-moz-animation:loadingbar 5s linear infinite;-ms-animation:loadingbar 5s linear infinite;-o-animation:loadingbar 5s linear infinite;animation:loadingbar 5s linear infinite}.no-version-warning .loading-bar:before{top:58px}.action-bar{background:#266d9c;padding:3px;overflow:hidden}.action-bar li{float:left}.action-bar li .li-inner{padding-bottom:1px;color:#e6eef4;text-decoration:none !important;outline:0;display:inline-block}.action-bar li .li-inner:hover{color:white}.action-bar li span.glyph{text-shadow:0 0 0 transparent;color:inherit}.action-bar li input{width:100%;font-size:12px;font-size:1.2rem;padding:2px 4px}.action-bar li.active .li-inner{color:white}.action-bar.horizontal-action-bar{padding:5px;height:35px}.action-bar.horizontal-action-bar .search-area{margin:2px 0 0 0;border:none;float:right;display:inline-block;position:relative;padding:0 30px 0 0}.action-bar.horizontal-action-bar .search-area input{padding-right:34px;min-width:250px !important}.action-bar.horizontal-action-bar .search-area button{position:absolute;right:32px;top:-2px;cursor:default;opacity:.5;background:transparent;width:25px;height:25px}.action-bar.horizontal-action-bar .search-area button:before{color:#666}.action-bar.horizontal-action-bar .search-area .icon-help{position:absolute;right:5px;top:-1px;text-shadow:0px 0px transparent;color:white;cursor:pointer;display:block;width:24px;height:24px;line-height:24px;text-align:center}.action-bar.horizontal-action-bar li{margin:0 1px;border:1px transparent solid;text-align:center;float:left}.action-bar.horizontal-action-bar li .glyph{width:14px}.action-bar.horizontal-action-bar li.btn-info{overflow:hidden;background:transparent}.action-bar.horizontal-action-bar li.btn-info:hover,.action-bar.horizontal-action-bar li.btn-info.active{border-color:rgba(255,255,255,0.3);opacity:1}.action-bar.horizontal-action-bar li.disabled{background:none !important;text-shadow:inherit !important;opacity:0.45 !important}.action-bar.horizontal-action-bar li.disabled a{cursor:not-allowed !important}.action-bar.vertical-action-bar li{max-height:60px}.action-bar.vertical-action-bar li .li-inner{height:60px;display:block;overflow:hidden;text-overflow:ellipsis;text-align:center;font-size:12px;font-size:1.2rem;line-height:12px}.action-bar.vertical-action-bar li .glyph{display:block;margin:12px auto 3px;width:20px;height:20px}.action-bar.tree-action-bar{background:#f2f0ee;position:relative;left:-1px;padding:0;margin:0 2.85714% 8px 2.85714%;width:94.64286%;font-size:13px;font-size:1.3rem}.action-bar.tree-action-bar li{background:rgba(255,255,255,0.5);border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;line-height:1.3;padding:0;text-align:center;float:left;width:65px;height:65px;margin:0 1px 1px 0}.action-bar.tree-action-bar li .glyph{display:block;color:#0e5d91;margin:12px auto 1px !important;font-size:17px !important;font-size:1.7rem !important}.action-bar.tree-action-bar li .li-inner{display:block;height:65px;padding:2px;font-size:11px;font-size:1.1rem;color:#222}.action-bar.tree-action-bar li:hover{background:#ddd;color:#666}.action-bar .tree-filters{width:160px;position:relative}.action-bar .tree-filters input{padding-right:24px}.action-bar .tree-filters span{position:absolute;right:3px;color:#555;width:22px;top:2px;line-height:20px;display:inline-block;text-align:center;text-shadow:0 0 0 transparent;border-left:1px solid #ddd;cursor:pointer}.action-bar .tree-filters span.icon-close{display:none}.action-bar .tree-filters span:hover{color:#0e5d91}@media (max-width: 1150px){.action-bar.horizontal-action-bar .search-area{float:none;position:absolute;right:0px}.action-bar.horizontal-action-bar .search-area input{padding-right:30px;min-width:auto !important;width:150px}.action-bar.horizontal-action-bar .search-area input:focus{width:220px}}body.oversized-nav:not(.delivery-scope) .action-bar.horizontal-action-bar .search-area{float:none;position:absolute;right:0px}body.oversized-nav:not(.delivery-scope) .action-bar.horizontal-action-bar .search-area input{padding-right:30px;min-width:auto !important;width:150px}body.oversized-nav:not(.delivery-scope) .action-bar.horizontal-action-bar .search-area input:focus{width:220px}.section-container{top:0 !important}.section-container .flex-container-full{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 100%;-webkit-flex:0 0 100%;flex:0 0 100%}.section-container .flex-container-half{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 50%;-webkit-flex:0 0 50%;flex:0 0 50%}.section-container .flex-container-third{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 33.33333%;-webkit-flex:0 0 33.33333%;flex:0 0 33.33333%}.section-container .flex-container-quarter{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 25%;-webkit-flex:0 0 25%;flex:0 0 25%}.section-container .flex-container-remaining{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:1 1 480px;-webkit-flex:1 1 480px;flex:1 1 480px}.section-container .flex-container-main-form{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 500px;-webkit-flex:0 0 500px;flex:0 0 500px;margin:0 20px 20px 0}.section-container .flex-container-navi{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 280px;-webkit-flex:0 0 280px;flex:0 0 280px}.section-container .section-header{border:none}.section-container .content-panel{width:100%;height:100%;margin:0;padding:0;border:none !important;display:box;display:-ms-flexbox;display:-webkit-flexbox;display:flexbox;display:-ms-flex;display:-webkit-flex;display:flex;-ms-direction:row;-webkit-direction:row;direction:row;-ms-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;flex-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;flex-line-pack:start;-ms-flex-line-pack:start;-webkit-align-content:flex-start;align-content:flex-start;flex-align:stretch;-ms-flex-align:stretch;-webkit-align-items:stretch;align-items:stretch}.section-container .tab-container{border:none;display:none;list-style-type:none;padding:0;margin:0}.section-container .tab-container li{float:left;position:relative;top:0;padding:0;margin:0 1px 0px 0;border-top:1px solid #f2f0ee !important;border-bottom:1px solid #f2f0ee !important;background:#f2f0ee !important}.section-container .tab-container li a{top:0 !important;margin-bottom:0 !important;padding:6px 16px;text-decoration:none;min-height:32px;color:#222;float:left}.section-container .tab-container li.active,.section-container .tab-container li:hover{border-bottom-color:#4a85ac !important;border-top-color:#6e9dbd !important;background:#266d9c !important}.section-container .tab-container li.active a,.section-container .tab-container li:hover a{background:transparent !important;border-color:transparent !important;color:#fff !important;text-shadow:1px 1px 0 rgba(0,0,0,0.2)}.section-container .tab-container li.disabled:hover{background:#f2f0ee !important}.section-container .tab-container li.disabled:hover a{cursor:not-allowed !important;color:#222 !important}.section-container .navi-container{display:none;background:#f2f0ee;-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 280px;-webkit-flex:0 0 280px;flex:0 0 280px;border-right:1px #ddd solid}.section-container .navi-container .block-title{font-size:14px;font-size:1.4rem;padding:2px 8px;margin:0}.section-container .navi-container .tree-action-bar-box{margin:10px 0;opacity:0}.section-container .navi-container .tree-action-bar-box.active{opacity:1;-webkit-opacity:0.25s ease-in-out;-moz-opacity:0.25s ease-in-out;opacity:0.25s ease-in-out}.section-container .content-container{border:none;-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:1 1 auto;-webkit-flex:1 1 auto;flex:1 1 auto;-ms-flex:1 1;-webkit-flex:1 1;flex:1 1}.section-container .content-block{padding:20px;overflow-y:auto;display:box;display:-ms-flexbox;display:-webkit-flexbox;display:flexbox;display:-ms-flex;display:-webkit-flex;display:flex;-ms-direction:row;-webkit-direction:row;direction:row;-ms-flex-wrap:wrap;-webkit-flex-wrap:wrap;flex-wrap:wrap;flex-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;flex-line-pack:start;-ms-flex-line-pack:start;-webkit-align-content:flex-start;align-content:flex-start;flex-align:stretch;-ms-flex-align:stretch;-webkit-align-items:stretch;align-items:stretch}.section-container .content-block>.grid-container{width:100%}.section-container .content-block .data-container-wrapper{padding:0px 20px 0 0}.section-container .content-block .data-container-wrapper:before,.section-container .content-block .data-container-wrapper:after{content:" ";display:table}.section-container .content-block .data-container-wrapper:after{clear:both}.section-container .content-block .data-container-wrapper>section,.section-container .content-block .data-container-wrapper .data-container{width:260px;margin:0 20px 20px 0;float:left;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px}.section-container .content-block .data-container-wrapper>section.double,.section-container .content-block .data-container-wrapper .data-container.double{width:540px}.section-container .content-block .data-container-wrapper>section .emptyContentFooter,.section-container .content-block .data-container-wrapper .data-container .emptyContentFooter{display:none}.section-container .content-block .data-container-wrapper>section .tree,.section-container .content-block .data-container-wrapper .data-container .tree{border:none;max-width:none;max-height:none}.section-container .content-block .data-container-wrapper>section form,.section-container .content-block .data-container-wrapper .data-container form{background:none;border:none;margin:0;padding:0}.section-container .content-block .data-container-wrapper>section>header,.section-container .content-block .data-container-wrapper>section .ui-widget-header,.section-container .content-block .data-container-wrapper .data-container>header,.section-container .content-block .data-container-wrapper .data-container .ui-widget-header{background:#f2f0ee;border-width:0px !important;border-bottom:1px #ddd solid !important}.section-container .content-block .data-container-wrapper>section>header h1,.section-container .content-block .data-container-wrapper>section>header h6,.section-container .content-block .data-container-wrapper>section .ui-widget-header h1,.section-container .content-block .data-container-wrapper>section .ui-widget-header h6,.section-container .content-block .data-container-wrapper .data-container>header h1,.section-container .content-block .data-container-wrapper .data-container>header h6,.section-container .content-block .data-container-wrapper .data-container .ui-widget-header h1,.section-container .content-block .data-container-wrapper .data-container .ui-widget-header h6{padding:4px;margin:0;font-size:14px;font-size:1.4rem}.section-container .content-block .data-container-wrapper>section>div,.section-container .content-block .data-container-wrapper>section .ui-widget-content,.section-container .content-block .data-container-wrapper>section .container-content,.section-container .content-block .data-container-wrapper .data-container>div,.section-container .content-block .data-container-wrapper .data-container .ui-widget-content,.section-container .content-block .data-container-wrapper .data-container .container-content{border-width:0px !important;overflow-y:auto;min-height:250px;padding:5px}.section-container .content-block .data-container-wrapper>section>div .icon-grip,.section-container .content-block .data-container-wrapper>section .ui-widget-content .icon-grip,.section-container .content-block .data-container-wrapper>section .container-content .icon-grip,.section-container .content-block .data-container-wrapper .data-container>div .icon-grip,.section-container .content-block .data-container-wrapper .data-container .ui-widget-content .icon-grip,.section-container .content-block .data-container-wrapper .data-container .container-content .icon-grip{cursor:move}.section-container .content-block .data-container-wrapper>section>footer,.section-container .content-block .data-container-wrapper>section .data-container-footer,.section-container .content-block .data-container-wrapper .data-container>footer,.section-container .content-block .data-container-wrapper .data-container .data-container-footer{background:#f2f0ee;text-align:right !important;padding:4px;border-width:0px !important;border-top:1px #ddd solid !important}.section-container .content-block .data-container-wrapper>section>footer .square,.section-container .content-block .data-container-wrapper>section .data-container-footer .square,.section-container .content-block .data-container-wrapper .data-container>footer .square,.section-container .content-block .data-container-wrapper .data-container .data-container-footer .square{width:28px}.section-container .content-block .data-container-wrapper>section>footer .square span,.section-container .content-block .data-container-wrapper>section .data-container-footer .square span,.section-container .content-block .data-container-wrapper .data-container>footer .square span,.section-container .content-block .data-container-wrapper .data-container .data-container-footer .square span{padding:0;left:0}.section-container .content-block .data-container-wrapper>section ol,.section-container .content-block .data-container-wrapper .data-container ol{margin:0 0 0 15px;padding:10px}.section-container .content-block #form-container.ui-widget-content{border:none !important}.section-container .content-block form:not(.list-container){border:1px #ddd solid;background:#f2f0ee;padding:30px;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px}.section-container .content-block [class^="btn-"],.section-container .content-block [class*=" btn-"]{margin:0 2px}.qti-navigator{padding:0;width:200px;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.qti-navigator span{display:inline-block}.qti-navigator .collapsed .collapsible-panel,.qti-navigator .masked,.qti-navigator.masked{display:none !important}.qti-navigator .collapsed .icon-up{display:none !important}.qti-navigator .collapsed .icon-down{display:inline-block !important}.qti-navigator.collapsed{flex:0 0 40px}.qti-navigator.collapsed ul{padding:0 !important}.qti-navigator.collapsed .qti-navigator-text,.qti-navigator.collapsed .qti-navigator-info>.qti-navigator-label,.qti-navigator.collapsed .qti-navigator-part>.qti-navigator-label,.qti-navigator.collapsed .qti-navigator-section>.qti-navigator-label,.qti-navigator.collapsed .qti-navigator-message{display:none !important}.qti-navigator.collapsed .qti-navigator-label{padding:0 2px !important}.qti-navigator.collapsed .qti-navigator-icon,.qti-navigator.collapsed .icon{width:auto}.qti-navigator.collapsed .qti-navigator-counter{float:none;text-align:center}.qti-navigator.collapsed .qti-navigator-collapsible{text-align:center}.qti-navigator.collapsed .qti-navigator-collapsible .qti-navigator-collapse{display:none}.qti-navigator.collapsed .qti-navigator-collapsible .qti-navigator-expand{display:block}.qti-navigator.collapsed .qti-navigator-info.collapsed .collapsible-panel{display:block !important}.qti-navigator.collapsed .qti-navigator-info .qti-navigator-label span{display:block;text-align:center;width:auto;line-height:30px}.qti-navigator.collapsed .qti-navigator-filter span{display:none}.qti-navigator.collapsed .qti-navigator-filter.active span{display:block;padding:3px 0;border:0 none;width:39px}.qti-navigator.collapsed .qti-navigator-item,.qti-navigator.collapsed .qti-navigator-linear,.qti-navigator.collapsed .qti-navigator-linear-part{padding-left:2px;text-align:center}.qti-navigator.collapsed .qti-navigator-item .qti-navigator-icon,.qti-navigator.collapsed .qti-navigator-item .icon,.qti-navigator.collapsed .qti-navigator-linear .qti-navigator-icon,.qti-navigator.collapsed .qti-navigator-linear .icon,.qti-navigator.collapsed .qti-navigator-linear-part .qti-navigator-icon,.qti-navigator.collapsed .qti-navigator-linear-part .icon{line-height:34px}.qti-navigator.collapsed .qti-navigator-item .qti-navigator-icon{padding-right:100px;padding-left:9px}.qti-navigator.collapsed .qti-navigator-linear,.qti-navigator.collapsed .qti-navigator-linear-part{padding:0 0 8px 0}.qti-navigator.collapsed .qti-navigator-linear .icon,.qti-navigator.collapsed .qti-navigator-linear-part .icon{display:block}.qti-navigator.collapsed .qti-navigator-actions button{padding:0 9px 0 5px}.qti-navigator.scope-test-section .qti-navigator-part>.qti-navigator-label{display:none !important}.qti-navigator .qti-navigator-label{display:block;line-height:30px;padding:0 6px}.qti-navigator .qti-navigator-label .icon-up,.qti-navigator .qti-navigator-label .icon-down{float:right;line-height:30px}.qti-navigator .qti-navigator-label .icon-down{display:none}.qti-navigator .qti-navigator-icon,.qti-navigator .icon{position:relative;top:1px;display:inline-block;width:22px}.qti-navigator .unseen .qti-navigator-icon{cursor:default}.qti-navigator .icon-answered:before{content:"\\e69a"}.qti-navigator .icon-viewed:before{content:"\\e631"}.qti-navigator .icon-flagged:before{content:"\\e64e"}.qti-navigator .icon-unanswered:before,.qti-navigator .icon-unseen:before{content:"\\e6a5"}.qti-navigator .collapsible>.qti-navigator-label,.qti-navigator .qti-navigator-item>.qti-navigator-label{cursor:pointer}.qti-navigator .qti-navigator-counter{text-align:right;float:right;font-size:12px;font-size:1.2rem}.qti-navigator .qti-navigator-actions{text-align:center}.qti-navigator .qti-navigator-collapsible{background-color:#a3a9b1;color:#222;border-top:1px solid #fff;cursor:pointer;padding:0 8px;text-align:right;display:none}.qti-navigator .qti-navigator-collapsible .icon{font-size:20px;font-size:2rem;line-height:30px;width:auto;color:#fff}.qti-navigator .qti-navigator-collapsible .qti-navigator-expand{display:none}.qti-navigator.collapsible .qti-navigator-collapsible{display:block}.qti-navigator .qti-navigator-info>.qti-navigator-label{background-color:#D4D5D7;color:#222;border-top:1px solid #fff;padding:2px 8px}.qti-navigator .qti-navigator-info li{border-bottom:1px solid rgba(255,255,255,0.9)}.qti-navigator .qti-navigator-info ul{padding:4px}.qti-navigator .qti-navigator-filters{margin-top:16px;text-align:center}.qti-navigator .qti-navigator-filters li{display:block;float:left}.qti-navigator .qti-navigator-filter span{border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;border-left:none;background-color:#fff;display:block;line-height:1.8;cursor:pointer;padding:3px 20px}.qti-navigator .qti-navigator-filter span:hover{background-color:#3e7da7;color:#fff}.qti-navigator .qti-navigator-filter.active span{background-color:#a3a9b1;color:#fff}.qti-navigator .qti-navigator-linear,.qti-navigator .qti-navigator-linear-part{padding:8px;background:#fff}.qti-navigator .qti-navigator-linear .icon,.qti-navigator .qti-navigator-linear-part .icon{display:none}.qti-navigator .qti-navigator-linear .qti-navigator-label,.qti-navigator .qti-navigator-linear-part .qti-navigator-label{font-size:14px;font-size:1.4rem}.qti-navigator .qti-navigator-linear .qti-navigator-title,.qti-navigator .qti-navigator-linear-part .qti-navigator-title{font-size:14px;font-size:1.4rem;margin:8px 0}.qti-navigator .qti-navigator-linear .qti-navigator-message,.qti-navigator .qti-navigator-linear-part .qti-navigator-message{font-size:14px;font-size:1.4rem}.qti-navigator .qti-navigator-part>.qti-navigator-label{background-color:#dcdee1;padding:2px 8px}.qti-navigator .qti-navigator-part>.qti-navigator-label:hover{background-color:#c6c9ce}.qti-navigator .qti-navigator-part.active>.qti-navigator-label{background-color:#c0c4c9}.qti-navigator .qti-navigator-part:not(:first-child){margin-top:1px}.qti-navigator .qti-navigator-section>.qti-navigator-label{padding:2px 10px 2px 8px;border-bottom:1px solid rgba(255,255,255,0.9)}.qti-navigator .qti-navigator-section>.qti-navigator-label:hover{background-color:#eae7e4}.qti-navigator .qti-navigator-section.active>.qti-navigator-label{background-color:#ded9d4}.qti-navigator .qti-navigator-item{background:#fff;margin:1px 0;padding-left:10px}.qti-navigator .qti-navigator-item:first-child{margin-top:0}.qti-navigator .qti-navigator-item.active{background:#f4f7f8}.qti-navigator .qti-navigator-item:hover{background:#eef3f5}.qti-navigator .qti-navigator-item.disabled{background-color:#e2ded9 !important}.qti-navigator .qti-navigator-item.disabled>.qti-navigator-label{cursor:not-allowed}.test-runner-scope{display:-ms-flexbox;display:flex;flex-flow:column;min-height:100vh;max-height:100vh;margin-bottom:0}.test-runner-scope main{-ms-flex:1;flex:1;-ms-flex-flow:row;flex-flow:row;overflow-y:auto;display:-ms-flexbox;display:flex}.test-runner-scope main .test-sidebar{min-width:200px;max-width:300px;width:12.5%;overflow:auto;background:#f2f0ee}.test-runner-scope main .test-sidebar-left{border-right:1px #ddd solid}.test-runner-scope main .test-sidebar-right{border-left:1px #ddd solid}.test-runner-scope main .content-wrapper{-ms-flex:1;flex:1;overflow:auto}.test-runner-scope main #qti-content{max-width:1024px;width:100%;margin:auto}.test-runner-scope main #qti-item{width:100%;min-width:100%;height:auto;overflow:visible}.test-runner-scope main .size-wrapper{max-width:1280px;margin:auto;width:100%}.test-runner-scope main #qti-rubrics{margin:auto;max-width:1024px;width:100%;padding:15px}.test-runner-scope main #qti-rubrics .qti-rubricBlock{margin:20px 0}.test-runner-scope main #qti-rubrics .hidden{display:none}.test-runner-scope .action-bar li{margin:0 5px}.test-runner-scope .action-bar li.btn-info{border-color:rgba(255,255,255,0.3)}.test-runner-scope .action-bar li.btn-info.btn-group{border:none !important;overflow:hidden;padding:0}.test-runner-scope .action-bar li.btn-info.btn-group a{float:left;margin:0 2px;padding:0 15px;border:1px solid rgba(255,255,255,0.3);border-radius:0px;display:inline-block;height:inherit}.test-runner-scope .action-bar li.btn-info.btn-group a:first-of-type{border-top-left-radius:3px;border-bottom-left-radius:3px;margin-left:0}.test-runner-scope .action-bar li.btn-info.btn-group a:last-of-type{border-top-right-radius:3px;border-bottom-right-radius:3px;margin-right:0}.test-runner-scope .action-bar li.btn-info.btn-group a:hover,.test-runner-scope .action-bar li.btn-info.btn-group a.active{border-color:rgba(255,255,255,0.8)}.test-runner-scope .action-bar li.btn-info.btn-group a .no-label{padding-right:0}.test-runner-scope .action-bar li.btn-info:hover,.test-runner-scope .action-bar li.btn-info.active{border-color:rgba(255,255,255,0.8)}.test-runner-scope .action-bar.horizontal-action-bar{opacity:1}.test-runner-scope .action-bar.horizontal-action-bar .title-box{padding-top:4px}.test-runner-scope .action-bar.horizontal-action-bar .progress-box,.test-runner-scope .action-bar.horizontal-action-bar .timer-box,.test-runner-scope .action-bar.horizontal-action-bar .item-number-box{padding-top:4px;display:inline-block;white-space:nowrap;-webkit-flex:0 0 auto;flex:0 1 auto}.test-runner-scope .action-bar.horizontal-action-bar .progress-box .qti-controls,.test-runner-scope .action-bar.horizontal-action-bar .timer-box .qti-controls,.test-runner-scope .action-bar.horizontal-action-bar .item-number-box .qti-controls{display:inline-block;margin-left:20px;white-space:nowrap}.test-runner-scope .action-bar.horizontal-action-bar .progressbar{margin-top:5px;min-width:150px;max-width:200px;height:0.6em}.test-runner-scope .action-bar.horizontal-action-bar.top-action-bar>.control-box{display:-webkit-flex;-webkit-justify-content:space-between;-webkit-flex-flow:row nowrap;display:flex;justify-content:space-between;flex-flow:row nowrap}.test-runner-scope .action-bar.horizontal-action-bar>.control-box{color:rgba(255,255,255,0.9);text-shadow:1px 1px 0 black}.test-runner-scope .action-bar.horizontal-action-bar>.control-box .lft,.test-runner-scope .action-bar.horizontal-action-bar>.control-box .rgt{padding-left:20px}.test-runner-scope .action-bar.horizontal-action-bar>.control-box .lft:first-child,.test-runner-scope .action-bar.horizontal-action-bar>.control-box .rgt:first-child{padding-left:0}.test-runner-scope .action-bar.horizontal-action-bar>.control-box .lft:last-child ul,.test-runner-scope .action-bar.horizontal-action-bar>.control-box .rgt:last-child ul{display:inline-block}.test-runner-scope .action-bar.horizontal-action-bar>.control-box [class^="btn-"],.test-runner-scope .action-bar.horizontal-action-bar>.control-box [class*=" btn-"]{white-space:nowrap}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .action{position:relative;overflow:visible}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu{color:#222;background:#f2f0ee;overflow:auto;list-style:none;min-width:150px;margin:0;padding:0;position:absolute;bottom:30px;left:0}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action{display:inline-block;text-align:left;width:100%;white-space:nowrap;overflow:hidden;color:#222;margin:0;-moz-border-radius:0px;-webkit-border-radius:0px;border-radius:0px;height:32px;padding:6px 15px;line-height:1}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action.selected{background-color:#3e7da7;color:#fff}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action.selected .label,.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action.selected .icon{color:#fff}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action:hover{background-color:#0e5d91;color:#fff}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action:hover .label,.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action:hover .icon{color:#fff}.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action .label,.test-runner-scope .action-bar.horizontal-action-bar .tools-box .menu .action .icon{font-size:14px;font-size:1.4rem;text-shadow:none;color:#222}.test-runner-scope .action-bar.horizontal-action-bar.bottom-action-bar{overflow:visible}.test-runner-scope .action-bar.horizontal-action-bar.bottom-action-bar .action{line-height:1.6}.test-runner-scope .action-bar.horizontal-action-bar.has-timers{height:47px}.test-runner-scope .action-bar.horizontal-action-bar.has-timers .progress-box,.test-runner-scope .action-bar.horizontal-action-bar.has-timers .title-box{padding-top:10px}.test-runner-scope .action-bar.horizontal-action-bar .bottom-action-bar .action{display:none}.test-runner-scope #qti-timers{display:none}.test-runner-scope [data-control="exit"]{margin-left:20px}.test-runner-scope [data-control="comment-toggle"]{display:none}.test-runner-scope .qti-timer{display:inline-block;text-align:center;vertical-align:top;line-height:1.2;position:relative;padding:0 20px}.test-runner-scope .qti-timer .qti-timer_label{max-width:130px;font-size:12px;font-size:1.2rem}.test-runner-scope .qti-timer.qti-timer__warning .qti-timer_time{color:#d8ae5b}.test-runner-scope .qti-timer::before{content:\' \';background:rgba(255,255,255,0.3);width:1px;height:20px;position:absolute;left:0;top:5px}.test-runner-scope .qti-timer:first-child::before{content:none}.test-runner-scope.non-lti-context .title-box{display:none}.test-runner-scope [data-control="qti-comment"]{background-color:#f2f0ee;position:absolute;bottom:33px;left:8px;z-index:9999;text-align:right;padding:5px;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;-webkit-box-shadow:0 0 15px 1px rgba(0,0,0,0.2);-moz-box-shadow:0 0 15px 1px rgba(0,0,0,0.2);-ms-box-shadow:0 0 15px 1px rgba(0,0,0,0.2);-o-box-shadow:0 0 15px 1px rgba(0,0,0,0.2);box-shadow:0 0 15px 1px rgba(0,0,0,0.2)}.test-runner-scope [data-control="qti-comment"] textarea{display:block;height:100px;resize:none;width:350px;padding:3px;margin:0  0 10px 0;border:none;font-size:13px;font-size:1.3rem;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px}.test-runner-scope .tools-box{position:relative;overflow:visible}\n/*# sourceMappingURL=new-test-runner.css.map */\n');
//# sourceMappingURL=controllers.min.js.map